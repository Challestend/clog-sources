{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/images/Challestend.png","path":"images/Challestend.png","modified":1,"renderable":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/lib/bookmark/LICENSE","path":"lib/bookmark/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/bookmark/README.md","path":"lib/bookmark/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/bookmark/bookmark.min.js","path":"lib/bookmark/bookmark.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/bookmark/index.js","path":"lib/bookmark/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/bookmark/package.json","path":"lib/bookmark/package.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/LICENSE","path":"lib/fancybox/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/README.md","path":"lib/fancybox/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/LICENSE","path":"lib/pace/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/README.md","path":"lib/pace/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/reading_progress/LICENSE","path":"lib/reading_progress/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/reading_progress/README.md","path":"lib/reading_progress/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/reading_progress/package.json","path":"lib/reading_progress/package.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/reading_progress/reading_progress.js","path":"lib/reading_progress/reading_progress.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/reading_progress/reading_progress.min.js","path":"lib/reading_progress/reading_progress.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.css","path":"lib/fancybox/source/jquery.fancybox.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.js","path":"lib/fancybox/source/jquery.fancybox.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1}],"Cache":[{"_id":"source/404.html","hash":"e91ccc2a50435ccc7ffc974659743c95de3131b1","modified":1545221879692},{"_id":"themes/next/.bowerrc","hash":"334da94ca6f024d60d012cc26ea655681e724ad8","modified":1538027465504},{"_id":"themes/next/.editorconfig","hash":"211d2c92bfdddb3e81ea946f4ca7a539f150f4da","modified":1538027465504},{"_id":"themes/next/.eslintrc.json","hash":"d3c11de434171d55d70daadd3914bc33544b74b8","modified":1538027465504},{"_id":"themes/next/.gitignore","hash":"0378adb9c2dc4855b3198184df4863cb30e4059c","modified":1538027465504},{"_id":"themes/next/.gitattributes","hash":"8454b9313cb1a97b63fb87e2d29daee497ce6249","modified":1538027465504},{"_id":"themes/next/.stylintrc","hash":"3b7f9785e9ad0dab764e1c535b40df02f4ff5fd6","modified":1538027465504},{"_id":"themes/next/README.md","hash":"460ef40953c2eccea4f87bc67043aac2eb87b1a9","modified":1538027465504},{"_id":"themes/next/LICENSE.md","hash":"f0190c7d83a98464549a6b3a51bb206148d88e1b","modified":1538027465504},{"_id":"themes/next/.travis.yml","hash":"fb9ac54e875f6ea16d5c83db497f6bd70ae83198","modified":1538027465504},{"_id":"themes/next/bower.json","hash":"960159e57be380d14aef75360412575cd8cb938f","modified":1538027465504},{"_id":"themes/next/_config.yml","hash":"d6849cd52c17f48ad3e37cff36e9b9e6b3cf1886","modified":1545896751518},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1538027465504},{"_id":"themes/next/gulpfile.coffee","hash":"67eaf2515100971f6195b60eeebbfe5e8de895ab","modified":1538027465521},{"_id":"themes/next/package-lock.json","hash":"de42534e63dc2984e8fc8c71bb7c16d32c934a73","modified":1542156325650},{"_id":"themes/next/package.json","hash":"d74dc584653e0bfab272de5d284d4be8a30c8e48","modified":1542156325619},{"_id":"source/_posts/0000-00-00-announcement.md","hash":"a3bd968efaf8a961f0bef82c60717fd36ab43c93","modified":1545882414444},{"_id":"source/_posts/2018-09-27-hello-world.md","hash":"77bcd1b920dfae75dee60651a19d8a4439c84ecf","modified":1544580167401},{"_id":"source/_posts/2018-09-27-luogu-t47720-solution.md","hash":"a5fc7e79eb453417d7832fc5cb7801354eb1e2ba","modified":1546058269951},{"_id":"source/_posts/2018-09-29-luogu-p3924-solution.md","hash":"5243a5732741c90c9a65a559f59a7e1eb26a82d4","modified":1545220889650},{"_id":"source/_posts/2018-10-04-luogu-p4900-solution.md","hash":"453a42272a08448a011612ad107cee3e04cd3230","modified":1544580277245},{"_id":"source/_posts/2018-10-12-luogu-p2154-solution.md","hash":"2eb72891edf74b01c03041c67afc35d83efe5d9b","modified":1544580409568},{"_id":"source/_posts/2018-10-24-status-compression-learning-notes.md","hash":"0e31ad5badab45a2ad018a667d72481a0c704b30","modified":1545221035791},{"_id":"source/_posts/2018-10-13-chtholly-tree-learning-notes.md","hash":"02a14bd2994d021fefe18215bd0c68403dcaf4ea","modified":1545220980539},{"_id":"source/_posts/2018-11-09-noip-2018-notes.md","hash":"13bd445ef28a2a1bf97b0b47c03dda032df28fee","modified":1545221109580},{"_id":"source/_posts/2018-11-14-poisonous-problems.md","hash":"764072cd44b09217ddbc1180e2fd67efcbd40f2c","modified":1544600967217},{"_id":"source/_posts/2018-11-29-number-theory-learning-notes.md","hash":"a68b2665a765ea9e803df5ffe9dfc2cad0fd3fee","modified":1545221580250},{"_id":"source/_posts/2018-12-08-future-algorithm-ep1.md","hash":"04b218c22c8f347074b7280215e917c791da4751","modified":1545221291478},{"_id":"source/_posts/2018-11-08-luogu-p5009-solution.md","hash":"e75bd168f978260dd123c3eb9f86f49ffe0afa04","modified":1544580304885},{"_id":"source/_posts/2018-12-19-polynomial-learning-notes-pt1.md","hash":"895301840dd0c0045e9cc88ba01700caffbbf7b4","modified":1545699491054},{"_id":"source/_posts/2018-12-20-polynomial-learning-notes-pt2.md","hash":"ea25fa3ffffebf5fc1645d378c7e4a4b77b04609","modified":1545535573483},{"_id":"source/_posts/2018-12-19-sqrt-decomposition-complexity-optimization.md","hash":"757f07de7e7607c5a21f5f4ae2928d70972762d8","modified":1545358830115},{"_id":"source/_posts/2018-12-26-timuzu-solutions.md","hash":"f19f8dbaaa56815f2c2457777e4d9c88efc1a77b","modified":1546058278357},{"_id":"source/about/index.md","hash":"ab8205a9b0391dc468a4a0b9273926dd8ea74b92","modified":1544615425678},{"_id":"source/categories/index.md","hash":"4cad6080ff7e7520395bc14c4774a819f06edbb2","modified":1544615434445},{"_id":"source/log/index.md","hash":"31a8a3f71065b2e2f571e3f8bf60e807c4c612ad","modified":1545963176767},{"_id":"source/tags/index.md","hash":"f2fa43fef7340cc16817d1f4f375ccd7494db7a9","modified":1544615444607},{"_id":"source/_posts/2018-12-24-block-decomposition.md","hash":"3da861b84c8fc77bf67b79195f5dcd6f438c677f","modified":1546063089513},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"40b0fd9fdb8586fab98e23f713940e7a2f80e2f9","modified":1538027465504},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"36201119490a04107c8179b10202548a9d0e5e60","modified":1538027465504},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"1e212fe229bd659726b4a3bcf4b5b14e0310ba3a","modified":1538027465504},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1538027465504},{"_id":"themes/next/.github/stale.yml","hash":"dbd5e6bf89b76ad1f2b081578b239c7ae32755af","modified":1538027465504},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"22f2ccc5522563b67c8663849fc1d6cbae93a8ff","modified":1538027465504},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"1dada3c3404445a00367882b8f97cdf092b7943d","modified":1538027465519},{"_id":"themes/next/docs/AUTHORS.md","hash":"51a0a13da55ff3d596970b2f9ab4531c6b2211f2","modified":1538027465519},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1538027465504},{"_id":"themes/next/docs/DATA-FILES.md","hash":"9a1895c0a0db705c4c48f512e86917f9af1ec3fb","modified":1538027465519},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"f2fd611a84dd6f9ed5395b63e187e29e9effbcd3","modified":1538027465520},{"_id":"themes/next/docs/INSTALLATION.md","hash":"b74ef6fedf76cdb156e2265759ee0a789ddd49cc","modified":1538027465519},{"_id":"themes/next/docs/LICENSE","hash":"5b702310012d480b40529fd10cf1872f687277a0","modified":1538027465520},{"_id":"themes/next/docs/MATH.md","hash":"34a46ca9a05b4570903beaadd4807e6759afb52e","modified":1538027465520},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"c9f2ed8e15c137b1885d9ca8b7197d9f457971e9","modified":1538027465520},{"_id":"themes/next/layout/_layout.swig","hash":"41ab1ee113e1a3ddb2aff0014445fcecb1d59c9c","modified":1541426221025},{"_id":"themes/next/layout/archive.swig","hash":"4b53070008775ecfd03953bd1b4adfcb0fabcaac","modified":1543466184571},{"_id":"themes/next/layout/category.swig","hash":"f0e3338bfa5efb205d2c28e635e9611f1fff3b55","modified":1544593568995},{"_id":"themes/next/layout/page.swig","hash":"9ddf40303f82e3db76d59dc82b6d4eadfed203c6","modified":1543300973205},{"_id":"themes/next/layout/post.swig","hash":"0554f42f90f4a524666c2b520be30b689c1d6a87","modified":1543296440228},{"_id":"themes/next/layout/schedule.swig","hash":"d99b9eff0cff38caf095445f27c08aaf11a5b862","modified":1543300974836},{"_id":"themes/next/layout/tag.swig","hash":"7cda2822e50b9fee9848a6b81e6c2d1aca830aeb","modified":1543300979170},{"_id":"themes/next/languages/de.yml","hash":"641e49587d41bb87e4d5932dc3d975754ded7953","modified":1538027465521},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1538027465521},{"_id":"themes/next/languages/en.yml","hash":"d66b8b48840443a4f9c72c7696a21e292f685a47","modified":1543472212052},{"_id":"themes/next/languages/fr.yml","hash":"ebcd1f188af8c3f5ef1f0923e794c839fbfae2d4","modified":1538027465521},{"_id":"themes/next/languages/id.yml","hash":"9709a4dbacc56a1571a96b139b872128d6959e90","modified":1538027465521},{"_id":"themes/next/languages/it.yml","hash":"4e3adeb10c0fa627935d69ae1783ce0894f5dee5","modified":1538027465521},{"_id":"themes/next/languages/ja.yml","hash":"82afb0a5637ad67065fa5b2624fa56c7c240c3c6","modified":1538027465521},{"_id":"themes/next/languages/ko.yml","hash":"33e065ceb21590b8eb32430a69e76c2f057eb758","modified":1538027465521},{"_id":"themes/next/languages/nl.yml","hash":"060efc260c1c529469d739d97dcee79683e8f411","modified":1538027465521},{"_id":"themes/next/languages/pt-BR.yml","hash":"dc09e290e908744ca28e093dbdd859ca2a20290e","modified":1538027465521},{"_id":"themes/next/languages/ru.yml","hash":"720b92a9ec075b68737d296b1f29ad8e01151c85","modified":1538027465521},{"_id":"themes/next/languages/pt.yml","hash":"53e2a52b9d5dc20c04080acd4f5b954e8699780f","modified":1538027465521},{"_id":"themes/next/languages/tr.yml","hash":"6d2f53d3687a7a46c67c78ab47908accd8812add","modified":1538027465521},{"_id":"themes/next/languages/vi.yml","hash":"e2b3b18359ab41d58c64b2002acfedd60a7505a4","modified":1538027465521},{"_id":"themes/next/languages/zh-CN.yml","hash":"04f9376ba50e23eb08f30d6fbd98ad62dcc04fad","modified":1545790573353},{"_id":"themes/next/languages/zh-HK.yml","hash":"c22113c4a6c748c18093dae56da5a9e8c5b963cd","modified":1538027465521},{"_id":"themes/next/languages/zh-TW.yml","hash":"dbf4dd87716babb2db4f5332fae9ec190a6f636a","modified":1538027465521},{"_id":"themes/next/layout/index.swig","hash":"bdcc9f57adef49706b16b107791cacecbc23c1dc","modified":1543300977401},{"_id":"themes/next/test/.jshintrc","hash":"c9fca43ae0d99718e45a6f5ce736a18ba5fc8fb6","modified":1538027465587},{"_id":"themes/next/scripts/merge-configs.js","hash":"5f96f63e86825fd7028c2522e4111103e261a758","modified":1538027465537},{"_id":"themes/next/test/helpers.js","hash":"f25e7f3265eb5a6e1ccbb5e5012fa9bebf134105","modified":1538027465588},{"_id":"themes/next/scripts/helpers.js","hash":"7849f9b9a86fc82d6e186e32a5e26e1f27c49b47","modified":1538027465537},{"_id":"themes/next/test/intern.js","hash":"db90b1063356727d72be0d77054fdc32fa882a66","modified":1538027465588},{"_id":"themes/next/scripts/merge.js","hash":"39b84b937b2a9608b94e5872349a47200e1800ff","modified":1538027465537},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465571},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"e771c5b745608c6fb5ae2fa1c06c61b3699627ec","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"9b512cb820627fcc45c9f77c7a122aa99e021bd5","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"6ea741f380dc3e90661d12db7e115a94b77643a4","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"baca12cc24be082f1db28c7f283493569666321c","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"7214fcd1b5830e62b3ac0836ad2d1b0fa391ae12","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"4d68054b062b3c8404b146a155d9624d2d25dd9b","modified":1545357528088},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"67f4a987e7db0ab1ce1ea4c311f2961df07b6681","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/README.md","hash":"0e6652be1b6bca87479f2601ff89105def200b4c","modified":1538027465521},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"2095d1214a4e519a1d31b67b41c89080fa3285d3","modified":1538027465521},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"7b2963daac19b0c14f98ebef375d5fbce8fc3f44","modified":1538027465521},{"_id":"themes/next/docs/ru/README.md","hash":"caaad965f9d54f82382c934f44a507d37a863fa3","modified":1538027465521},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"1a4e41adcf5831057f3f7b3025ed4a5ef7c442b4","modified":1538027465521},{"_id":"themes/next/layout/_custom/header.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1538027465521},{"_id":"themes/next/layout/_custom/head.swig","hash":"a223919d2e1bf17ca4d6abb2c86f2efca9883dc1","modified":1538027465521},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1538027465521},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"8c56dd26157cbc580ae41d97ac34b90ab48ced3f","modified":1538027465521},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"a51de08657f5946f4028b11373280ddc04639525","modified":1538027465520},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"8ff97c3f4eb888207bdc50066053c97d890e0202","modified":1538027465521},{"_id":"themes/next/layout/_macro/post-related.swig","hash":"e8dfb86eb62b9c2bc1435d6d1afa95d3b4c7b931","modified":1538027465521},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56733f92352b891b0bb1baca293f68f6c8928b0b","modified":1538027465521},{"_id":"themes/next/layout/_macro/post.swig","hash":"1d2ac8fa186bd412dc3d0ed2d9f6d77aabbc09e1","modified":1544579505873},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"0c8fa20e669ff206b1a405f6897b9c0e527e4d3c","modified":1544702312545},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"7a9b687087793bf5e218cbc345214f927fa5601a","modified":1538027465521},{"_id":"themes/next/layout/_partials/breadcrumb.swig","hash":"4b48fdbfe3bf41ddeda4ff74c1ff17ab9f15c14e","modified":1538027465521},{"_id":"themes/next/layout/_partials/comments.swig","hash":"412d2a0e18a237e490e1b8bce5547558768b9da3","modified":1538027465521},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"206cbd6ac9ca6a219a8516f59beae25b3c770199","modified":1538027465521},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"914155d5d758306cff405beefd4a07973fd8fc77","modified":1538027465521},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"ed62ea83d3f2c9db2ea57bf23a7d765ed82504c2","modified":1538027465537},{"_id":"themes/next/layout/_third-party/copy-code.swig","hash":"c62c37474c8de78cf34e54c6219b503ec28d9815","modified":1538027465537},{"_id":"themes/next/layout/_partials/footer.swig","hash":"76669b1acc77daa5340b22fe1fd4dd3bd6efb0fb","modified":1545963115973},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"53861f78a1fb52e96a43cf6909e1530dcf6cbff8","modified":1538027465537},{"_id":"themes/next/layout/_third-party/github-banner.swig","hash":"736cb278fa09d3b4ed6f305b56353941ea918793","modified":1538027465537},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"debba9b7110f635204a15df148194d4c2fd2668b","modified":1538027465537},{"_id":"themes/next/layout/_third-party/pangu.swig","hash":"ccf0035086e14dcefa24c2907301edf4c37d5448","modified":1538027465537},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"554ec568e9d2c71e4a624a8de3cb5929050811d6","modified":1538027465537},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"db15d7e1552aa2d2386a6b8a33b3b3a40bf9e43d","modified":1538027465537},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"a174d4a0c9188f9c4a2652f49bfa7a60ad0a83e3","modified":1538027465537},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"f544e21883d249d5a341c684c97bd25831008f07","modified":1538027465521},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"27fb1d81151b9b79683e488579df19eee7e654d6","modified":1538027465521},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"f134aeb8d5bee351e5277edb92ac694af314b75f","modified":1538027465537},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"f8c7e729ad6e72b4c705a2c5d5041589c2b4cc52","modified":1538027465521},{"_id":"themes/next/node_modules/hexo-symbols-count-time/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1529948346000},{"_id":"themes/next/node_modules/hexo-symbols-count-time/LICENSE","hash":"f45ee1c765646813b442ca58de72e20a64a7ddba","modified":1515238533000},{"_id":"themes/next/node_modules/hexo-symbols-count-time/index.js","hash":"8cea6bfa58366019ebfd0b42cf737efa1ecab622","modified":1515238533000},{"_id":"themes/next/node_modules/hexo-symbols-count-time/package.json","hash":"6a597ccf45ddb666d2458873381b78b0ce8bedd1","modified":1542156325603},{"_id":"themes/next/source/images/Challestend.png","hash":"f77ecb69e448ec420da9cf8ca5d3f8979d4ea991","modified":1536902567445},{"_id":"themes/next/source/css/main.styl","hash":"2a62e2a11e9cdcc69e538d856d6f9ce228a07c93","modified":1538027465570},{"_id":"themes/next/node_modules/hexo-symbols-count-time/README.md","hash":"2cfab30720b9e9882ca5383c5f2e4ebaacb1ec52","modified":1529985681000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1538027465571},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1538027465571},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1538027465571},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1538027465572},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1538027465572},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1538027465573},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1538027465573},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1538027465573},{"_id":"themes/next/source/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1538027465573},{"_id":"themes/next/source/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1538027465574},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1538027465574},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1538027465574},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1538027465574},{"_id":"themes/next/source/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1538027465574},{"_id":"themes/next/source/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1538027465575},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1538027465575},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1538027465575},{"_id":"themes/next/source/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1538027465575},{"_id":"themes/next/scripts/tags/button.js","hash":"510f3711a9c9d3e2a844250647d90e8359e7d130","modified":1538027465537},{"_id":"themes/next/scripts/tags/exturl.js","hash":"83e48148d2f4f8543f6833effa8a26eb0b60f2f0","modified":1538027465537},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"4519ab8e6898f2ee90d05cde060375462b937a7d","modified":1538027465537},{"_id":"themes/next/scripts/tags/full-image.js","hash":"ef2c2985a3edb9f69740740c5bc42d4b692c86fd","modified":1538027465537},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"aface11629970a5c4ee38aaa15550d2caee59560","modified":1538027465537},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"ab4a82a7246265717556c7a42f897430340b88cf","modified":1538027465537},{"_id":"themes/next/scripts/tags/label.js","hash":"bb502616bfabe85de5de903074ec6afe627f8413","modified":1538027465537},{"_id":"themes/next/scripts/tags/tabs.js","hash":"2d257e26718d4011509fd6f530d2ea37e50e3e66","modified":1538027465537},{"_id":"themes/next/scripts/tags/note.js","hash":"bd3310a5890bded1bda9ba3ad6f98ee44ecb101a","modified":1538027465537},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465521},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465537},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465564},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465564},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465564},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465570},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1538027465569},{"_id":"themes/next/layout/_macro/menu/menu-badge.swig","hash":"4eb8e222dc337211efb0d3bbdb5e29af3e6ecdb8","modified":1538027465521},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"aab518204d3125e948796a9ba6b56b09cade2d92","modified":1538027465521},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"f5e487b0d213ca0bd94aa30bc23b240d65081627","modified":1538027465521},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"0b8349710caf9691741a457aa746add35245048e","modified":1538027465521},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"09109a5c5a301e7cc5e3c7aec32b0164739fc7d4","modified":1538027465521},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"19050627bc23b0b2c2e65e7248c0f88468eb8ea5","modified":1538027465521},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"c909f6e96373c151dea325bcddfdd8c9522421b6","modified":1538027465521},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"f3ae3168801304af3d80ec3b84264e1d4201cb89","modified":1538027465521},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"3f11ae8e9084f39628cd2006931d39a2069b9dd6","modified":1544593644383},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"f6454c452b2e90a8c760321bce7e3dc6119b71fa","modified":1538027465521},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"b2f0d247b213e4cf8de47af6a304d98070cc7256","modified":1538027465521},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"a8c7f9ca7c605d039a1f3bf4e4d3183700a3dd62","modified":1538027465521},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"b25002a83cbd2ca0c4a5df87ad5bff26477c0457","modified":1538027465521},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"9e3d133ac5bcc6cb51702c83b2611a49811abad1","modified":1538027465521},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"d9e2d9282f9be6e04eae105964abb81e512bffed","modified":1538027465521},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"d4fbffd7fa8f2090eb32a871872665d90a885fac","modified":1538027465521},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"ff947f3561b229bc528cb1837d4ca19612219411","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"71397a5823e8ec8aad3b68aace13150623b3e19d","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"1ce5fa218a44cf6e620583e9013e0b674dd6a989","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"753d262911c27baf663fcaf199267133528656af","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"a10b7f19d7b5725527514622899df413a34a89db","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"7d94845f96197d9d84a405fa5d4ede75fb81b225","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"8ab040fccba41675bc835973515530af8a51f8bd","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"cfc932c5db04fef64cc56d3ba0b8ddf3a15a63bd","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"45f3f629c2aacc381095750e1c8649041a71a84b","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"bd8382d4f12df207ed52f75f6e5fb06527970167","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"8a399df90dadba5ad4e781445b58f4765aeb701e","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"5a8027328f060f965b3014060bebec1d7cf149c1","modified":1538027465537},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"f9a1647a8f1866deeb94052d1f87a5df99cb1e70","modified":1538027465537},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"4c501ea0b9c494181eb3c607c5526a5754e7fbd8","modified":1538027465537},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"2440f1e66cb8e39cc2bacfd783fb6fe904a628e9","modified":1538027465537},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"19fd1d4d01193308a0ef530a7fc9abbae5441c34","modified":1544600765905},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"34cc66d4dbada2d561ba6f70fd9a75207c5adbd4","modified":1538027465537},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"c49a3b10b2f2f64a7ac41fa3d436fd2c8d31cca8","modified":1538027465537},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"d05e70a416963023ee1978e4168d58bcfd956ed3","modified":1538027465537},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"30e9e55d9af2ced6e6b156a042026a8b480f0ab0","modified":1538027465537},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"860de4ce6fccc516d2f779a4b600a4214d8c18e2","modified":1538027465537},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"c0c2fd87e71f0beb542aa50c0bc875da5aa5c44b","modified":1538027465537},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"34599633658f3b0ffb487728b7766e1c7b551f5a","modified":1538027465537},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"fe95dd3d166634c466e19aa756e65ad6e8254d3e","modified":1538027465537},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"d8c98938719284fa06492c114d99a1904652a555","modified":1538027465537},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"71c897f9b107dd0de1b7f649633cf583c206a9db","modified":1538027465537},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"580e9d9c4d8783ee6200d845ae16c98979bf1ea3","modified":1538027465521},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"c381f638315a007b1baf5fea879161001fe50cd0","modified":1538027465521},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"c381f638315a007b1baf5fea879161001fe50cd0","modified":1538027465537},{"_id":"themes/next/node_modules/hexo-symbols-count-time/lib/helper.js","hash":"7778e412674a2bda792130b40827d1acbfcd9e76","modified":1529948368000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"3403fdd8efde1a0afd11ae8a5a97673f5903087f","modified":1542161194658},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"07f7da320689f828f6e36a6123807964a45157a0","modified":1538027465564},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"8aa98ae349908736ba43196c42498fd5bdeb780a","modified":1538027465564},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"0882d76333ab409e8d3362c284b91a0f0ae761ae","modified":1538027465564},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"a25408534f8fe6e321db4bbf9dd03335d648fe17","modified":1545288622595},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"8d6cf29f63c90364f4d3c336f7c9bb794b4c46cc","modified":1538027465569},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"72927abd51d3a607a6ba32cf882390792b34e834","modified":1538027465570},{"_id":"themes/next/source/css/_variables/base.styl","hash":"25936d9430c50debfc5617265cafe304516b4b35","modified":1545724975357},{"_id":"themes/next/source/lib/bookmark/.eslintignore","hash":"bbd18f176a313f38aafbce58b55ad002563a689b","modified":1542155414142},{"_id":"themes/next/source/lib/bookmark/.eslintrc.js","hash":"21e561d7708a2c4884ba0d03f148ce46253b08ad","modified":1542155414142},{"_id":"themes/next/source/lib/bookmark/.gitignore","hash":"5410a1bef9807f666cd92a0d2020f700e67e4096","modified":1542155414158},{"_id":"themes/next/source/lib/bookmark/LICENSE","hash":"c3036598ab8f45797460e48880c9e859268d574a","modified":1542155414158},{"_id":"themes/next/source/lib/bookmark/README.md","hash":"aef0ed533378c45cadb548e4b26b375e2501fe07","modified":1542155414158},{"_id":"themes/next/source/lib/bookmark/bookmark.min.js","hash":"9e525329553335c2484f6faf9e933a6bbee9ab6d","modified":1542155414158},{"_id":"themes/next/source/lib/bookmark/index.js","hash":"1364ef511550daf991177d151a5fabc6539fced4","modified":1542155414158},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"9c0e38750e26eb9e83e2b5ab9e069b66f0965ce4","modified":1544439790916},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"672d3b5767e0eacd83bb41b188c913f2cf754793","modified":1544439790916},{"_id":"themes/next/source/lib/bookmark/package.json","hash":"e3eedf4ba6fa086743553176f9526e1bf0b44439","modified":1542155414158},{"_id":"themes/next/source/lib/fancybox/LICENSE","hash":"7713a1753ce88f2c7e6b054ecc8e4c786df76300","modified":1544439790916},{"_id":"themes/next/source/lib/fancybox/README.md","hash":"10e4cb3bb98f6b9806bedbb8dbbc00151bad4c70","modified":1544439790916},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"b4aefc910578d76b267e86dfffdd5121c8db9aec","modified":1538027465578},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"03ddbf76c1dd1afb93eed0b670d2eee747472ef1","modified":1538027465578},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"c31ff06a740955e44edd4403902e653ccabfd4db","modified":1538027465579},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1538027465579},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"71e7183634dc1b9449f590f15ebd7201add22ca7","modified":1538027465579},{"_id":"themes/next/source/lib/pace/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1544440052001},{"_id":"themes/next/source/lib/pace/README.md","hash":"ddcd2834d847f37b8ee77858bd03d31f70f55fb7","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"4b32bc29e02a0c714978f014b74a102695e65bce","modified":1544697360434},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1544440052001},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1544440052001},{"_id":"themes/next/source/lib/reading_progress/.editorconfig","hash":"b1fd3a1cdad8120ed818833be00ea9b9cab2845a","modified":1542025122448},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1544440052001},{"_id":"themes/next/source/lib/reading_progress/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1542025122464},{"_id":"themes/next/source/lib/reading_progress/.gitignore","hash":"09cde1060b4213a7eee528b54560777d2d3756e8","modified":1542025122464},{"_id":"themes/next/source/lib/reading_progress/README.md","hash":"892aa722541608d334f009f8236babde866c2a9d","modified":1542025122464},{"_id":"themes/next/source/lib/reading_progress/package.json","hash":"193693c3d0de991041175777543650def85be391","modified":1542025122464},{"_id":"themes/next/source/lib/reading_progress/reading_progress.js","hash":"afe7024841712455762d9993f92c63582dd44969","modified":1542025122464},{"_id":"themes/next/source/lib/reading_progress/reading_progress.min.js","hash":"98af8d99819882904f9b1a9254bebf40602e1843","modified":1542025122464},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"8aaa675f577d5501f5f22d5ccb07c2b76310b690","modified":1544440052001},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"dbbfb50f6502f6b81dcc9fee7b31f1e812da3464","modified":1538027465587},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"bf172816a9c57f9040e3d19c24e181a142daf92b","modified":1538027465586},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"dde584994ac13dc601836e86f4cf490e418d9723","modified":1538027465587},{"_id":"themes/next/source/js/src/affix.js","hash":"ad343aa406fd8181b5f310434817ce98fc2219e3","modified":1538027465575},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"84906eeae57bd06744dd20160b93eacf658f97e2","modified":1538027465576},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"c7e2a588b679d46379124141bb2f30bc2f3210e2","modified":1538027465576},{"_id":"themes/next/source/js/src/exturl.js","hash":"c48aa4b3c0e578a807fd3661e6cd4f3890777437","modified":1538027465576},{"_id":"themes/next/source/js/src/post-details.js","hash":"7d309b771e86c7e22ce11cc25625481ef7d5985c","modified":1544593943254},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"1512c751d219577d338ac0780fb2bbd9075d5298","modified":1538027465576},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"c4867626afab749404daf321367f9b6b8e223f69","modified":1538027465577},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"68d3690152c89e7adb08bb35ec28dbda2bd93686","modified":1538027465577},{"_id":"themes/next/source/js/src/utils.js","hash":"fa3aab0ba7bc5138c6f8fac436efe5b8dcb97567","modified":1538027465578},{"_id":"themes/next/source/js/src/motion.js","hash":"4c7f94e499743f4cc958f6cd1260a93d765d3051","modified":1544593947272},{"_id":"themes/next/source/lib/jquery/index.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1538027465584},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"6e076b5e183eedf425a445e99851f938789c3194","modified":1538027465537},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"2530de0f3125a912756f6c0e9090cd012134a4c5","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"8f86f694c0749a18ab3ad6f6df75466ca137a4bc","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"237d185ac62ec9877e300947fa0109c44fb8db19","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"8b32928686c327151e13d3ab100157f9a03cd59f","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"ff4489cd582f518bba6909a301ac1292a38b4e96","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"7ad4081466b397e2a6204141bb7768b7c01bd93c","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"4f2801fc4cf3f31bf2069f41db8c6ce0e3da9e39","modified":1538027465553},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"6eb4bcc3056bd279d000607e8b4dad50d368ca69","modified":1538027465559},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"fbb6be577529c750ef7c872fe7abdc7ab0faf0f8","modified":1538027465562},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"4b89f955bb92ff953fa3337546a26322de5caa01","modified":1538027465562},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"1da5c800d025345f212a3bf1be035060f4e5e6ed","modified":1538027465562},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"ab775f23ad475efb25376b5aad752ae8b56cfd8c","modified":1538027465563},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a17e2b871a335f290afb392a08f94fd35f59c715","modified":1538027465563},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"3f40e8a9fe8e7bd5cfc4cf4cbbbcb9539462e973","modified":1538027465563},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"52bc8ba71b91d954530b35dfc63b402a02b1321d","modified":1538027465563},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"7e4e499964c2112d47e6f9d2b6e87c31ec8269e2","modified":1538027465565},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"bce344d3a665b4c55230d2a91eac2ad16d6f32fd","modified":1538027465568},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"ccf5a4761cb0ce451b5e994cfabf8769248a45c1","modified":1538027465568},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"cc961108b12ab97d9216606ceb1cd1cd31ab20f0","modified":1538027465568},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"df16dc995eb9ad498df2edcfc3e20528fc9aa133","modified":1538027465569},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"1f6e2ce674735269599acc6d77b3ea18d31967fc","modified":1538027465568},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"be72740313a9a0477b8a22f62e4c8ffa6d23a2e5","modified":1538027465569},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"a558803ca81cceae2bdc22c18ef638fcc023681b","modified":1538027465569},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"d0e9065b0dbbc01811259f0597d1790268b4881b","modified":1538027465565},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"b1025c421406d2c24cc92a02ae28c1915b01e240","modified":1538027465565},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"d0bfd1bef988c76f7d7dd72d88af6f0908a8b0db","modified":1538027465565},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fa6c00fdaf8f0ca3b690a5a556671745fb67e2c9","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"f3aa863adf972569b72f2df6bc6a914e7daace99","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"09c965022c13b84ed8a661fee8ac2a6d550495ae","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"2ccb9bdc309b7c1ef183a3dbb0a4621bec54a328","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"31127dcbf4c7b4ada53ffbf1638b5fe325b7cbc0","modified":1538027465567},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"3cc7646583218d16925ced7b70865e63a901d4a7","modified":1538027465567},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"09c965022c13b84ed8a661fee8ac2a6d550495ae","modified":1538027465567},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"748dbfbf9c08e719ddc775958003c64b00d39dab","modified":1538027465567},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"b26f8a3394d8357a5bfd24d9f8bf62d7b4063ebb","modified":1538027465567},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.css","hash":"84adea69673c392c1d34a5a316e8e5960aa348b5","modified":1544439790918},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"3655f1fdf1e584c4d8e8d39026093ca306a5a341","modified":1538027465579},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1538027465580},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"88af80502c44cd52ca81ffe7dc7276b7eccb06cf","modified":1538027465580},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"6b37727883ab6f2a7211300d93289a337944838b","modified":1538027465577},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"41ea797c68dbcff2f6fb3aba1d1043a22e7cc0f6","modified":1538027465584},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"a817b6c158cbc5bab3582713de9fe18a18a80552","modified":1538027465585},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"f7b9796b5b50c2c267eae284fefb6456ba83d656","modified":1544439790917},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.js","hash":"b9a1185936351c902a3dfa179a3fde1d81d0ae68","modified":1544439790919},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1538027465583},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1538027465583},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"4237c6e9d59da349639de20e559e87c2c0218cfd","modified":1538027465586},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7dd247c8869fdefb5a007045d00f3ef8ceecf300","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"3f3d2a43d1a326bad25b633c8ec9ddd87867224c","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d63e0cacc53dd375fcc113465a4328c59ff5f2c1","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"34f5ac3c1ed2dd31e9297cc4c0733e71bc2e252f","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"1a0d059799a298fe17c49a44298d32cebde93785","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"1727702eac5d326b5c81a667944a245016668231","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"0656e753f182c9f47fef7304c847b7587a85ef0d","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"835c1340571bd6c4ec263c482cf13283fb047e49","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"167986d0f649516671ddf7193eebba7b421cd115","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"62fbbd32cf5a99ae550c45c763a2c4813a138d01","modified":1538027465553},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"caf263d1928496688c0e1419801eafd7e6919ce5","modified":1538027465554},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"875cbe88d5c7f6248990e2beb97c9828920e7e24","modified":1538027465554},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"a200c0a1c5a895ac9dc41e0641a5dfcd766be99b","modified":1538027465554},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"317c9ceda655e9dc373ce8e7b71d20b794fce9a4","modified":1538027465555},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"7fe4d4d656e86276c17cb4e48a560cb6a4def703","modified":1538027465537},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"cd9e214e502697f2f2db84eb721bac57a49b0fce","modified":1538027465555},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"330c8884efb5612e7eb03986d87d29e8b0651974","modified":1538027465555},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"27deb3d3a243d30022055dac7dad851024099a8b","modified":1538027465555},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"ff50a32ae6fea5fcdf2939dc9b01e1eb76cc73f0","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"82bc7fa5d38d98e98cc25f9a73189024fda25e63","modified":1538027465555},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"b2495ae5e04dcca610aacadc47881d9e716cd440","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"5a982d8ef3b3623ea5f59e63728990f5623c1b57","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"adfd6d2d3b34adc4b476a0ea91e19020456a3b1a","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5c3141d58970a0614896b6a62fd7a8a8caf4e401","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"01567edaea6978628aa5521a122a85434c418bfd","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"c4168c95d73b05b610d917778ad5b262cbfd424b","modified":1538027465556},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"fa57ec9a6f1943c0558856dfba2d6b8faca0cd4d","modified":1538027465557},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"00a504620c454287111dc0ace64c989e1ff97f54","modified":1538027465557},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"8dd9a1c6f4f6baa00c2cf01837e7617120cf9660","modified":1538027465557},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"61f8cea3c01acd600e90e1bc2a07def405503748","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"11c22f0fb3f6beb13e5a425ec064a4ff974c13b7","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"1153bb71edf253765145559674390e16dd67c633","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"9e05a2232faabb41bcebb51d545d897a76f077da","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"a1521d48bb06d8d703753f52a198baa197af7da2","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"94d76e6da600a36d80e2470326ebb6b3be447ccb","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"e71652d3216e289c8548b1ea2357822c1476a425","modified":1538027465558},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"630be616447a982413030e561bbd3a80ac14b120","modified":1538027465552},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"b6f3a06a94a6ee5470c956663164d58eda818a64","modified":1538027465552},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"7fb593f90d74a99c21840679933b9ef6fdc16a61","modified":1538027465552},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"ad4cae23c8e383f4fabc9a2a95bca6055020d22e","modified":1538027465553},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"4e3838d7ac81d9ad133960f0f7ed58a44a015285","modified":1538027465553},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"8cf318644acc8b4978537c263290363e21c7f5af","modified":1538027465553},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"2fe76476432b31993338cb45cdb3b29a518b6379","modified":1538027465559},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"2d58ad90f148e845bc7023751a7a13260600f8d6","modified":1538027465559},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"2ad1a2a9bbf6742d1b0762c4c623b68113d1e0fe","modified":1538027465559},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"2ab1322fe52ab5aafd49e68f5bd890e8380ee927","modified":1538027465559},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"b7076e58d647265ee0ad2b461fe8ce72c9373bc5","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"9a409b798decdefdaf7a23f0b11004a8c27e82f3","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"f1640253cbbf71d0c04c34c25bd61045894f98bc","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"f4d8144c22544bdb89787c14ab9d39578dae4b7c","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"a6e7d698702c2e383dde3fde2abde27951679084","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"874278147115601d2abf15987f5f7a84ada1ac6b","modified":1538027465561},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"10599e16414a8b7a76c4e79e6617b5fe3d4d1adf","modified":1538027465561},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"16087276945fa038f199692e3eabb1c52b8ea633","modified":1538027465561},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"154a87a32d2fead480d5e909c37f6c476671c5e6","modified":1538027465560},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"28825ae15fa20ae3942cdaa7bcc1f3523ce59acc","modified":1538027465561},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"acfdd76b1c90d2e384affb3d0006a39b524609d2","modified":1538027465561},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"c31fbaec7e6373ecfb8588500b972d451695a6ad","modified":1538027465561},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"a07aa12cc36ac5c819670c2a3c17d07ed7a08986","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1538027465566},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1538027465568},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"e72794707ef26fbdf5995532d91d95766173ecd4","modified":1544439790918},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"e72794707ef26fbdf5995532d91d95766173ecd4","modified":1544439790920},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1538027465582},{"_id":"public/404.html","hash":"280c1b64c61ef6bb187d7820b4527d7d494753e8","modified":1546063104882},{"_id":"public/atom.xml","hash":"796b2e7ed5595238e1fb5c72d2c91a0069e5cb64","modified":1546063104891},{"_id":"public/search.xml","hash":"01dbc43043e2107032faa125ca31ee004ea2210c","modified":1546063104891},{"_id":"public/content.json","hash":"2f953519238292d6eb40a4249ddf3585db1d7618","modified":1546063104904},{"_id":"public/about/index.html","hash":"46320d01565549a06876aadf8379c705e3252e2a","modified":1546063104908},{"_id":"public/categories/index.html","hash":"266e4dcd49c247c43c0b5c8fff6743d4d0c7a624","modified":1546063104908},{"_id":"public/log/index.html","hash":"ca3ecd2dde17971840b06e16ce3888f8f4e5f1ac","modified":1546063104908},{"_id":"public/tags/index.html","hash":"985f03788390e4a0c014d13f15ef82535f60d2f4","modified":1546063104908},{"_id":"public/timuzu-solutions/index.html","hash":"088d683498b90a7afe39d4dbe051e629e25baf32","modified":1546063104908},{"_id":"public/block-decomposition/index.html","hash":"bf16be259d66b77ff5baf4e31645831c3fb9076e","modified":1546063104908},{"_id":"public/polynomial-learning-notes-pt2/index.html","hash":"58e901eba96445c1d4e4eac97e6fd1ba815b9583","modified":1546063104908},{"_id":"public/polynomial-learning-notes-pt1/index.html","hash":"baf72d78306626fc87c37d3e487b3693cfe0d26b","modified":1546063104908},{"_id":"public/sqrt-decomposition-complexity-optimization/index.html","hash":"2de781f301cafe45a87eb472e5ac72a3d87ff71f","modified":1546063104908},{"_id":"public/future-algorithm-ep1/index.html","hash":"99233b3f2c1efcfb62561222116acd2c9d84b628","modified":1546063104909},{"_id":"public/number-theory-learning-notes/index.html","hash":"04997002db6eb4117219285f6b6c84cb91e1b235","modified":1546063104909},{"_id":"public/poisonous-problems/index.html","hash":"30f924691c7178f6a90378f68431472a390bc7ad","modified":1546063104909},{"_id":"public/noip-2018-notes/index.html","hash":"f905994cc1c35a6218876921067883ea2542ee1d","modified":1546063104909},{"_id":"public/luogu-p5009-solution/index.html","hash":"f378ee9e85dfd075a690397a7042f2b4dbc792d3","modified":1546063104909},{"_id":"public/status-compression-learning-notes/index.html","hash":"d34056d84c8b24c86b61118dd2643617fc7caacb","modified":1546063104909},{"_id":"public/chtholly-tree-learning-notes/index.html","hash":"7668f5a98df3fe20101641ca22fa4fe679980bd1","modified":1546063104909},{"_id":"public/luogu-p2154-solution/index.html","hash":"aab733c7a2d6008095efb18b373b7c34f53e07e3","modified":1546063104909},{"_id":"public/luogu-p4900-solution/index.html","hash":"88c953c80f34734844519ccc430d6a372387737a","modified":1546063104909},{"_id":"public/luogu-p3924-solution/index.html","hash":"61f65f490f43f91d9f4ac29ce4424a1079563482","modified":1546063104909},{"_id":"public/luogu-t47720-solution/index.html","hash":"1c3e33f492bcfde451cb73e69f1fbd473a486f13","modified":1546063104909},{"_id":"public/hello-world/index.html","hash":"51f79a0bb4a6308682345e99b386750d92282349","modified":1546063104909},{"_id":"public/announcement/index.html","hash":"2b05c42943d9b2006baac9b877e3c1a391e53b39","modified":1546063104909},{"_id":"public/archives/index.html","hash":"61ce2db0f4e86d253ff6ca4e7d5247e8bd938620","modified":1546063104909},{"_id":"public/archives/page/2/index.html","hash":"3badcbfb2178ac3fc9f68db1f905c1d72adebbf2","modified":1546063104909},{"_id":"public/archives/1899/index.html","hash":"6aee285680014946ed4f9d23da15947ec39c20e8","modified":1546063104910},{"_id":"public/archives/1899/11/index.html","hash":"055dea660061459e70094dc3c0cf9d09623f17ff","modified":1546063104910},{"_id":"public/archives/2018/index.html","hash":"82837747321b51f2847e0ac3494d7f2d73578b2d","modified":1546063104910},{"_id":"public/archives/2018/page/2/index.html","hash":"abc436c1c64bff0283c19f81e704fcfcc18a5101","modified":1546063104910},{"_id":"public/archives/2018/09/index.html","hash":"56ef34a38bf62403d18e34d2a5b670ca954854d7","modified":1546063104910},{"_id":"public/archives/2018/10/index.html","hash":"3c4e43056ef7294762684abea71ce314f2ed8b61","modified":1546063104910},{"_id":"public/archives/2018/11/index.html","hash":"a057ea3c0901770a788fdd592f04eb899ce03602","modified":1546063104910},{"_id":"public/archives/2018/12/index.html","hash":"667b90387242e5fd4d68ffde4e86d79133d580c5","modified":1546063104910},{"_id":"public/index.html","hash":"e58c925c6bfb27fc5839454d75d1056fb7871f71","modified":1546063104910},{"_id":"public/page/2/index.html","hash":"18aec02ccb2c24e60fb9ba59b37497f4da49fccc","modified":1546063104910},{"_id":"public/categories//index.html","hash":"1cc7f295c4c5c9d98fe2348248aa508158628a00","modified":1546063104910},{"_id":"public/categories//index.html","hash":"b682c7bba8a0ce605c21007164e524f02809caf5","modified":1546063104910},{"_id":"public/categories//index.html","hash":"8ccd6ef7a28a40ea6711bbf06a79ee520711cea2","modified":1546063104910},{"_id":"public/categories//index.html","hash":"2dd225a8f6a54c04a9a4c78cf5e3b8642bf9af1c","modified":1546063104910},{"_id":"public/categories//index.html","hash":"50fbcca701ffd8d6054f518179dcb533c6eee66a","modified":1546063104910},{"_id":"public/categories//index.html","hash":"ba2b425937c2da54a8300ad29a2ec0471d0bb4a1","modified":1546063104911},{"_id":"public/tags//index.html","hash":"63f011fab6de143c38adecb7921aa8c6ad114877","modified":1546063104911},{"_id":"public/tags//index.html","hash":"1a093a6384ae7f861c53071f38af1b762c6c1e35","modified":1546063104911},{"_id":"public/tags//index.html","hash":"5761021de1259b7ec5d7e7cbee6b1af0143ea649","modified":1546063104911},{"_id":"public/tags//index.html","hash":"bcd0a1efecc2f35b7550a92c5c2b4458f725a8dd","modified":1546063104911},{"_id":"public/tags//index.html","hash":"71d7f3441416db32bb49583020ee97585b7d31ad","modified":1546063104911},{"_id":"public/tags/SDOI/index.html","hash":"233b3b609e6557695aa53e7b22bd82906948f1de","modified":1546063104911},{"_id":"public/tags/2009/index.html","hash":"393e633ff6e753f9a6a4d7c8343b783eb6e093be","modified":1546063104911},{"_id":"public/tags//index.html","hash":"e3e27654d0b6c91a5b9a29b57985ccce656d251c","modified":1546063104911},{"_id":"public/tags//index.html","hash":"34bd02bf7bc153dc94cfedcbea2faf2356acd93b","modified":1546063104911},{"_id":"public/tags//index.html","hash":"ae4aa4abd075ac6487f1e8abcb58a0993b8192c7","modified":1546063104911},{"_id":"public/tags//index.html","hash":"f9684eccd415b857084dd3db9d6dba584993113f","modified":1546063104911},{"_id":"public/tags//index.html","hash":"8472542162fb1db5ffac893ae9a341a0ed7073a7","modified":1546063104911},{"_id":"public/tags//index.html","hash":"00b563d1a112035cb6acc9bf89a864786182915d","modified":1546063104911},{"_id":"public/tags/NOIp/index.html","hash":"bbfce7b4eec8febc9d2a7eb8e8255338811cb7aa","modified":1546063104911},{"_id":"public/tags/2018/index.html","hash":"343cb6b97621d505b6f64b86996a1b4d5b8bd408","modified":1546063104912},{"_id":"public/tags//index.html","hash":"c017d6297ad522a693d4848dd9e454a15c8c1dd0","modified":1546063104912},{"_id":"public/tags//index.html","hash":"8af0d3fbcb34dc9b368c7502a52b78e71d011be0","modified":1546063104912},{"_id":"public/tags//index.html","hash":"5cdb7c410f804fe946551c8f71164edba34bd0ba","modified":1546063104912},{"_id":"public/tags//index.html","hash":"131b964b3e37f829223cda2e57ca1d92547183b9","modified":1546063104912},{"_id":"public/tags//index.html","hash":"b662fdf12866dc92ddc9a542d9afdcdb54eea361","modified":1546063104912},{"_id":"public/tags/FFT/index.html","hash":"2461f40d6d0f864c5c0629ba2a78ba59458c7fe6","modified":1546063104912},{"_id":"public/tags/NTT/index.html","hash":"252f33f3662d14408ed55cd3dc5d76c63e040964","modified":1546063104912},{"_id":"public/tags//index.html","hash":"f36c1175cf4f64c9d56e0092f0b5ba8564aed6e2","modified":1546063104912},{"_id":"public/tags//index.html","hash":"e0f9ef4a8fe7f518cc7af9057d865751224b1456","modified":1546063104912},{"_id":"public/images/Challestend.png","hash":"f77ecb69e448ec420da9cf8ca5d3f8979d4ea991","modified":1546063104921},{"_id":"public/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1546063104921},{"_id":"public/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1546063104922},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1546063104922},{"_id":"public/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1546063104922},{"_id":"public/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1546063104922},{"_id":"public/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1546063104922},{"_id":"public/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1546063104922},{"_id":"public/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1546063104922},{"_id":"public/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1546063104922},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1546063104922},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1546063104922},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1546063104922},{"_id":"public/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1546063104922},{"_id":"public/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1546063104922},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1546063104922},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1546063104922},{"_id":"public/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1546063104922},{"_id":"public/lib/bookmark/LICENSE","hash":"c3036598ab8f45797460e48880c9e859268d574a","modified":1546063104922},{"_id":"public/lib/fancybox/LICENSE","hash":"7713a1753ce88f2c7e6b054ecc8e4c786df76300","modified":1546063104922},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1546063104922},{"_id":"public/lib/pace/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1546063104922},{"_id":"public/lib/reading_progress/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1546063104923},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1546063104923},{"_id":"public/lib/blog-encrypt.js","hash":"ebf4ce2a0389fe8184668508ba9c730cd2c38f97","modified":1546063104923},{"_id":"public/css/blog-encrypt.css","hash":"262922c3f49cb8cca7b3ea982c49b57de2af53d6","modified":1546063104923},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1546063105345},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1546063105457},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1546063105458},{"_id":"public/lib/bookmark/index.js","hash":"5e5cba645a1a4531ccbb4782df2f7a075626393f","modified":1546063105466},{"_id":"public/lib/bookmark/package.json","hash":"9f06f3432c12b68a2c2fe3f318455b35a965a1da","modified":1546063105487},{"_id":"public/lib/bookmark/bookmark.min.js","hash":"9e525329553335c2484f6faf9e933a6bbee9ab6d","modified":1546063105487},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1546063105487},{"_id":"public/lib/reading_progress/package.json","hash":"e404a0bdf26df62eb89173c6fe5f5824345801c5","modified":1546063105488},{"_id":"public/lib/reading_progress/reading_progress.js","hash":"174678a8e2a24763e3fe8b9c25496fdf6ee0220b","modified":1546063105488},{"_id":"public/lib/reading_progress/reading_progress.min.js","hash":"98af8d99819882904f9b1a9254bebf40602e1843","modified":1546063105488},{"_id":"public/js/src/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1546063105488},{"_id":"public/js/src/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1546063105488},{"_id":"public/js/src/bootstrap.js","hash":"1c41508b83cb0c4512e64b4d63afa1be954ce8ef","modified":1546063105488},{"_id":"public/js/src/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1546063105488},{"_id":"public/js/src/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1546063105488},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1546063105488},{"_id":"public/js/src/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1546063105488},{"_id":"public/js/src/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1546063105488},{"_id":"public/js/src/schemes/pisces.js","hash":"58f87062210200c778eb92e20a9453bb6a5a03fa","modified":1546063105488},{"_id":"public/lib/bookmark/README.html","hash":"7f7eafeda0668e53fc3b99e6974f611b35829270","modified":1546063105488},{"_id":"public/lib/fancybox/README.html","hash":"32a70d79d6a3590a40e742a90a34000694ad3980","modified":1546063105488},{"_id":"public/lib/pace/README.html","hash":"0739df73902c11eb9a95d2c0845e2d596977a4e7","modified":1546063105488},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"a041cd993024acbe40dc269281919d0dbee3065d","modified":1546063105488},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"32ea5710b36d34e140900dcab855d629585da538","modified":1546063105488},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"a876e260ede8d61e8420cabad17f3c9ac80afb2e","modified":1546063105488},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"1baff04ce15f4ae4d7bbb05be5bdc1218790956c","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"1f51a66e963d37868a9409639ee07a8d29837026","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"1f4e1eb52f4c997d86cba9321bf3fd08b0a54d4b","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"6198442d0496c8ebf7b35b8f75cfebe0a081d274","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"74800b416a3f3398e9b43dd4e975e3a27bda22ae","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"5d7b8df3c789cd2393721fc894922d2bb4a4a584","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"cefee3b03b33b7684b83e8ad9ca3bf31be0e1115","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"b5e16bb5b2136fa26c936557ba4585b0675c0a76","modified":1546063105489},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"84a0fce9c57befd47d5128b23a6aa9cff18dcfd8","modified":1546063105489},{"_id":"public/lib/reading_progress/README.html","hash":"ac0209e94caf41ca02955ec49b0989ec58cbab50","modified":1546063105489},{"_id":"public/css/main.css","hash":"2f332a74a5b1fe2613fe080d08fc1432dc38111e","modified":1546063105489},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1546063105489},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1546063105492},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1546063105501},{"_id":"public/js/src/utils.js","hash":"e437eff1d3781c4a1aec9ff2060565524a37c983","modified":1546063105501},{"_id":"public/js/src/motion.js","hash":"b45d2c0d48f2c8e6a0621b8063845f76b89476cc","modified":1546063105502},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1546063105502},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1546063105502},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"bb2b2f29ee5f3ab6b40683ed25b9313fe11b3784","modified":1546063105502},{"_id":"public/lib/fancybox/source/jquery.fancybox.min.css","hash":"2e7b98987216b2313b9c635102f75e29af68f59b","modified":1546063105502},{"_id":"public/lib/crypto-js.js","hash":"3dd73b6f13dc818a3a9c5c7424c1c4a9649b00a2","modified":1546063105502},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"0a7d30a27885c937db8c681ff70f4c9dae1bf4df","modified":1546063105522},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"c5eeba363293d381fb56858142c323c13b2dfd1d","modified":1546063105566},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1546063105631},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1546063105631},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"f8445aa243e881560b5e5b69fdf18bbc105bd143","modified":1546063105631},{"_id":"public/lib/fancybox/source/jquery.fancybox.min.js","hash":"b85b75426ff7569d54a1f69689895315e80ed85d","modified":1546063105650},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1546063105658},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"fec45d19179030b8f43ebd0eabc5467892c14136","modified":1546063105663},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"fec45d19179030b8f43ebd0eabc5467892c14136","modified":1546063105664},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1546063105669}],"Category":[{"name":"","_id":"cjq921vzj0005gwgu8jb7vn3j"},{"name":"","_id":"cjq921vzv000hgwgufwwx59zp"},{"name":"","_id":"cjq921w030010gwguf1n37tnh"},{"name":"","_id":"cjq921w040016gwgufymhytcw"},{"name":"","_id":"cjq921w05001agwguofnu3w2o"},{"name":"","_id":"cjq921w3f002dgwguwmhgk9jl"}],"Data":[],"Page":[{"layout":"false","comments":0,"_content":"<body>\n\t<div>\n\t\t<p style=\"text-align: center;\"><img src=\"https://i.loli.net/2018/10/27/5bd4705dd844f.jpg\"></p>\n\t\t<p style=\"text-align: center;\"><strong></strong></p>\n\t\t<p style=\"text-align: center;\"><a href=\"https://challestend.github.io\" target=\"_self\"><strong></strong></a></p>\n\t</div>\n</html>\n","source":"404.html","raw":"---\nlayout: false\ncomments: false\n---\n<body>\n\t<div>\n\t\t<p style=\"text-align: center;\"><img src=\"https://i.loli.net/2018/10/27/5bd4705dd844f.jpg\"></p>\n\t\t<p style=\"text-align: center;\"><strong></strong></p>\n\t\t<p style=\"text-align: center;\"><a href=\"https://challestend.github.io\" target=\"_self\"><strong></strong></a></p>\n\t</div>\n</html>\n","date":"2018-12-19T12:17:59.692Z","updated":"2018-12-19T12:17:59.692Z","path":"404.html","title":"","_id":"cjq921vwm0000gwgu0o6mu7rk","content":"<body>\n\t<div>\n\t\t<p style=\"text-align: center;\"><img src=\"https://i.loli.net/2018/10/27/5bd4705dd844f.jpg\"></p>\n\t\t<p style=\"text-align: center;\"><strong></strong></p>\n\t\t<p style=\"text-align: center;\"><a href=\"https://challestend.github.io\" target=\"_self\"><strong></strong></a></p>\n\t</div>\n\n</body>","site":{"data":{}},"excerpt":"","more":"<body>\n\t<div>\n\t\t<p style=\"text-align: center;\"><img src=\"https://i.loli.net/2018/10/27/5bd4705dd844f.jpg\"></p>\n\t\t<p style=\"text-align: center;\"><strong></strong></p>\n\t\t<p style=\"text-align: center;\"><a href=\"https://challestend.github.io\" target=\"_self\"><strong></strong></a></p>\n\t</div>\n\n</body>"},{"title":"","date":"2018-12-12T11:50:25.678Z","comments":0,"_content":"A juruo OIer from SD province.\n\nStudying in SLYZ.\n\nFind me on\n\n- [Luogu](https://www.luogu.org/space/show?uid=63352)\n- [LibreOJ](https://loj.ac/user/6666)\n- [NowCoder](https://www.nowcoder.com/profile/514705863)\n- [CodeForces](http://codeforces.com/profile/CLT)\n- [GitHub](https://github.com/Challestend)\n","source":"about/index.md","raw":"---\ntitle: \ndate: Undefined\ncomments: false\n---\nA juruo OIer from SD province.\n\nStudying in SLYZ.\n\nFind me on\n\n- [Luogu](https://www.luogu.org/space/show?uid=63352)\n- [LibreOJ](https://loj.ac/user/6666)\n- [NowCoder](https://www.nowcoder.com/profile/514705863)\n- [CodeForces](http://codeforces.com/profile/CLT)\n- [GitHub](https://github.com/Challestend)\n","updated":"2018-12-12T11:50:25.678Z","path":"about/index.html","layout":"page","_id":"cjq921vzg0002gwguraolu86s","content":"<p>A juruo OIer from SD province.</p>\n<p>Studying in SLYZ.</p>\n<p>Find me on</p>\n<ul>\n<li><a href=\"https://www.luogu.org/space/show?uid=63352\" target=\"_blank\" rel=\"noopener\">Luogu</a></li>\n<li><a href=\"https://loj.ac/user/6666\" target=\"_blank\" rel=\"noopener\">LibreOJ</a></li>\n<li><a href=\"https://www.nowcoder.com/profile/514705863\" target=\"_blank\" rel=\"noopener\">NowCoder</a></li>\n<li><a href=\"http://codeforces.com/profile/CLT\" target=\"_blank\" rel=\"noopener\">CodeForces</a></li>\n<li><a href=\"https://github.com/Challestend\">GitHub</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>A juruo OIer from SD province.</p>\n<p>Studying in SLYZ.</p>\n<p>Find me on</p>\n<ul>\n<li><a href=\"https://www.luogu.org/space/show?uid=63352\" target=\"_blank\" rel=\"noopener\">Luogu</a></li>\n<li><a href=\"https://loj.ac/user/6666\" target=\"_blank\" rel=\"noopener\">LibreOJ</a></li>\n<li><a href=\"https://www.nowcoder.com/profile/514705863\" target=\"_blank\" rel=\"noopener\">NowCoder</a></li>\n<li><a href=\"http://codeforces.com/profile/CLT\" target=\"_blank\" rel=\"noopener\">CodeForces</a></li>\n<li><a href=\"https://github.com/Challestend\">GitHub</a></li>\n</ul>\n"},{"title":"","date":"2018-10-11T00:14:04.000Z","type":"categories","comments":0,"_content":"\n","source":"categories/index.md","raw":"---\ntitle: \ndate: 2018-10-11 08:14:04\ntype: \"categories\"\ncomments: false\n---\n\n","updated":"2018-12-12T11:50:34.445Z","path":"categories/index.html","layout":"page","_id":"cjq921vzi0004gwgux4byh2k3","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"","date":"2018-12-12T11:47:51.000Z","mathjax":true,"_content":"blog\n\n9\n\n- 2018-09-27\n  - \n- \n- 2018-12-13\n  - `theme-next-pace`\n  - `hexo-symbols-count-time`\n  - \n- 2018-12-14\n  - 404\n- 2018-12-19\n  - Arima Madurai\n- 2018-12-28\n  - \n- To Be Continued\n\ndalaoblog\n\ndalaoblog\n","source":"log/index.md","raw":"---\ntitle: \ndate: 2018-12-12 19:47:51\nmathjax: true\n---\nblog\n\n9\n\n- 2018-09-27\n  - \n- \n- 2018-12-13\n  - `theme-next-pace`\n  - `hexo-symbols-count-time`\n  - \n- 2018-12-14\n  - 404\n- 2018-12-19\n  - Arima Madurai\n- 2018-12-28\n  - \n- To Be Continued\n\ndalaoblog\n\ndalaoblog\n","updated":"2018-12-28T02:12:56.767Z","path":"log/index.html","comments":1,"layout":"page","_id":"cjq921vzl0008gwgujianerjw","content":"<p>blog</p>\n<p>9</p>\n<ul>\n<li>2018-09-27<ul>\n<li></li>\n</ul>\n</li>\n<li></li>\n<li>2018-12-13<ul>\n<li><code>theme-next-pace</code></li>\n<li><code>hexo-symbols-count-time</code></li>\n<li></li>\n</ul>\n</li>\n<li>2018-12-14<ul>\n<li>404</li>\n</ul>\n</li>\n<li>2018-12-19<ul>\n<li>Arima Madurai</li>\n</ul>\n</li>\n<li>2018-12-28<ul>\n<li></li>\n</ul>\n</li>\n<li>To Be Continued</li>\n</ul>\n<p>dalaoblog</p>\n<p>dalaoblog</p>\n","site":{"data":{}},"excerpt":"","more":"<p>blog</p>\n<p>9</p>\n<ul>\n<li>2018-09-27<ul>\n<li></li>\n</ul>\n</li>\n<li></li>\n<li>2018-12-13<ul>\n<li><code>theme-next-pace</code></li>\n<li><code>hexo-symbols-count-time</code></li>\n<li></li>\n</ul>\n</li>\n<li>2018-12-14<ul>\n<li>404</li>\n</ul>\n</li>\n<li>2018-12-19<ul>\n<li>Arima Madurai</li>\n</ul>\n</li>\n<li>2018-12-28<ul>\n<li></li>\n</ul>\n</li>\n<li>To Be Continued</li>\n</ul>\n<p>dalaoblog</p>\n<p>dalaoblog</p>\n"},{"title":"","date":"2018-10-09T01:57:40.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: \ndate: 2018-10-09 09:57:40\ntype: \"tags\"\ncomments: false\n---\n","updated":"2018-12-12T11:50:44.607Z","path":"tags/index.html","layout":"page","_id":"cjq921vzn000agwguw2cbssk9","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"mathjax":true,"date":"1899-11-29T16:00:00.000Z","title":"","top":2147483647,"_content":"blog\n\n<!-- more -->\n\n1. [](/poisonous-problems/)\n2. GravatarGravatar~~G~~__`?*@?*.com``?*``/``.`__\n","source":"_posts/0000-00-00-announcement.md","raw":"---\nmathjax: true\ndate: 0000-00-00 00:00:00\ntitle: \ntags:\n  - \ncategories:\n  - \ntop: 2147483647\n---\nblog\n\n<!-- more -->\n\n1. [](/poisonous-problems/)\n2. GravatarGravatar~~G~~__`?*@?*.com``?*``/``.`__\n","slug":"announcement","published":1,"updated":"2018-12-27T03:46:54.444Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vz90001gwgumwo5zs1h","content":"<p>blog</p>\n<a id=\"more\"></a>\n<ol>\n<li><a href=\"/poisonous-problems/\"></a></li>\n<li>GravatarGravatar<del>G</del><strong><code>?*@?*.com</code><code>?*</code><code>/</code><code>.</code></strong></li>\n</ol>\n","site":{"data":{}},"excerpt":"<p>blog</p>","more":"<ol>\n<li><a href=\"/poisonous-problems/\"></a></li>\n<li>GravatarGravatar<del>G</del><strong><code>?*@?*.com</code><code>?*</code><code>/</code><code>.</code></strong></li>\n</ol>"},{"title":"Hello World","date":"2018-09-27T05:41:19.000Z","mathjax":true,"_content":"blog\n","source":"_posts/2018-09-27-hello-world.md","raw":"---\ntitle: Hello World\ndate: 2018-09-27 13:41:19\ntags:\n  - \ncategories:\n  - \nmathjax: true\n---\nblog\n","slug":"hello-world","published":1,"updated":"2018-12-12T02:02:47.401Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzg0003gwgu1m1t5lra","content":"<p>blog</p>\n","site":{"data":{}},"excerpt":"","more":"<p>blog</p>\n"},{"title":"Luogu-T47720","date":"2018-09-27T06:29:56.000Z","mathjax":true,"_content":"[](https://www.luogu.org/problemnew/show/T47720)\n\n<!-- more -->\n\n~~~~\n\n$i(1<i<n)$$i-1\\notin B$$i+1\\notin B$$n-3$$i$$n-3$$m-1$$B$$C_{n-3}^{m-1}$$1$$n$$1$$C_{n-2}^{m-1}$\n\n$$\\frac{\\sum_{i=2}^{n-1}iC_{n-3}^{m-1}+(n+1)C_{n-2}^{m-1}}{C_{n}^{m}}$$\n\n\n\n$$\\frac{m(n+1)(n-m)(n-m-1)}{2n(n-1)}+\\frac{m(n+1)(n-m)}{n(n-1)}$$\n\n> Updated on 2018-10-10\n>\n> $m$\n>\n> \n>\n> $$\\frac{m(n+1)(n-m)(n-m+1)}{2n(n-1)}$$\n>\n> ~~`#ifdef`~~\n>\n> > Updated on 2018-10-16\n> >\n> > `#ifdef`\n>\n> ~~~~$1861\\text{ms}$$300\\text{ms}$$\\text{dalao}$$400\\text{ms}$~~$500\\text{ms}$~~\n\n$O(n)$$O(1)$\n\n$10^{7}$$10^{6}$\n","source":"_posts/2018-09-27-luogu-t47720-solution.md","raw":"---\ntitle: Luogu-T47720\ndate: 2018-09-27 14:29:56\ntags:\n  - \n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n[](https://www.luogu.org/problemnew/show/T47720)\n\n<!-- more -->\n\n~~~~\n\n$i(1<i<n)$$i-1\\notin B$$i+1\\notin B$$n-3$$i$$n-3$$m-1$$B$$C_{n-3}^{m-1}$$1$$n$$1$$C_{n-2}^{m-1}$\n\n$$\\frac{\\sum_{i=2}^{n-1}iC_{n-3}^{m-1}+(n+1)C_{n-2}^{m-1}}{C_{n}^{m}}$$\n\n\n\n$$\\frac{m(n+1)(n-m)(n-m-1)}{2n(n-1)}+\\frac{m(n+1)(n-m)}{n(n-1)}$$\n\n> Updated on 2018-10-10\n>\n> $m$\n>\n> \n>\n> $$\\frac{m(n+1)(n-m)(n-m+1)}{2n(n-1)}$$\n>\n> ~~`#ifdef`~~\n>\n> > Updated on 2018-10-16\n> >\n> > `#ifdef`\n>\n> ~~~~$1861\\text{ms}$$300\\text{ms}$$\\text{dalao}$$400\\text{ms}$~~$500\\text{ms}$~~\n\n$O(n)$$O(1)$\n\n$10^{7}$$10^{6}$\n","slug":"luogu-t47720-solution","published":1,"updated":"2018-12-29T04:37:49.951Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzk0007gwgucs61zclf","content":"<p><a href=\"https://www.luogu.org/problemnew/show/T47720\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<p><del></del></p>\n<p>$i(1&lt;i&lt;n)$$i-1\\notin B$$i+1\\notin B$$n-3$$i$$n-3$$m-1$$B$$C_{n-3}^{m-1}$$1$$n$$1$$C_{n-2}^{m-1}$</p>\n<script type=\"math/tex; mode=display\">\\frac{\\sum_{i=2}^{n-1}iC_{n-3}^{m-1}+(n+1)C_{n-2}^{m-1}}{C_{n}^{m}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\frac{m(n+1)(n-m)(n-m-1)}{2n(n-1)}+\\frac{m(n+1)(n-m)}{n(n-1)}</script><blockquote>\n<p>Updated on 2018-10-10</p>\n<p>$m$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\frac{m(n+1)(n-m)(n-m+1)}{2n(n-1)}</script><p><del><code>#ifdef</code></del></p>\n<blockquote>\n<p>Updated on 2018-10-16</p>\n<p><code>#ifdef</code></p>\n</blockquote>\n<p><del></del>$1861\\text{ms}$$300\\text{ms}$$\\text{dalao}$$400\\text{ms}$<del>$500\\text{ms}$</del></p>\n</blockquote>\n<p>$O(n)$$O(1)$</p>\n<p>$10^{7}$$10^{6}$</p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/problemnew/show/T47720\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<p><del></del></p>\n<p>$i(1&lt;i&lt;n)$$i-1\\notin B$$i+1\\notin B$$n-3$$i$$n-3$$m-1$$B$$C_{n-3}^{m-1}$$1$$n$$1$$C_{n-2}^{m-1}$</p>\n<script type=\"math/tex; mode=display\">\\frac{\\sum_{i=2}^{n-1}iC_{n-3}^{m-1}+(n+1)C_{n-2}^{m-1}}{C_{n}^{m}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\frac{m(n+1)(n-m)(n-m-1)}{2n(n-1)}+\\frac{m(n+1)(n-m)}{n(n-1)}</script><blockquote>\n<p>Updated on 2018-10-10</p>\n<p>$m$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\frac{m(n+1)(n-m)(n-m+1)}{2n(n-1)}</script><p><del><code>#ifdef</code></del></p>\n<blockquote>\n<p>Updated on 2018-10-16</p>\n<p><code>#ifdef</code></p>\n</blockquote>\n<p><del></del>$1861\\text{ms}$$300\\text{ms}$$\\text{dalao}$$400\\text{ms}$<del>$500\\text{ms}$</del></p>\n</blockquote>\n<p>$O(n)$$O(1)$</p>\n<p>$10^{7}$$10^{6}$</p>"},{"title":"Luogu-P4900","date":"2018-10-04T04:11:18.000Z","mathjax":true,"_content":"[](https://www.luogu.org/problemnew/show/P4900)\n\n<!-- more -->\n\n~~~~\n\n\n\n$$\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\pmod{998244353}$$\n\n$\\lbrace x\\rbrace$$x$\n\n\n\n$$\\begin{aligned}\n&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\\\\n\\equiv&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\\\\n\\equiv&\\sum\\limits_{i=1}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}-\\sum\\limits_{i=1}^{A-1}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\n\\pmod{998244353}\n\\end{aligned}$$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\pmod{998244353}$$\n\n[](https://www.luogu.org/problemnew/show/P3708)\n\n\n\n$$f(x)=\\sum\\limits_{i=1}^{n}x\\%i$$\n\n$x\\%i=0$\n\n$$x\\%i=(x-1)\\%i+1$$\n\n$$f(x)=f(x-1)+n$$\n\n$x\\%i=0$$f(x)$$i$$i$$x$\n\n$$f(x)=f(x-1)+n-\\sigma(x)$$\n\n\n\n$$g(x)=\\sum\\limits_{i=1}^{n}x\\%i\\times i^{-1}\\pmod{998244353}$$\n\n$$h(x)=\\sum\\limits_{i\\mid x}i\\times i^{-1}\\equiv\\sum\\limits_{i\\mid x}1\\equiv d(x)\\pmod{998244353}$$\n\n\n\n$$g(x)\\equiv g(x-1)+\\sum\\limits_{i=1}^{n}i^{-1}-d(x)\\pmod{998244353}$$\n\n\n\n$$\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}$$\n\n\n\n$$ans(x)=\\sum\\limits_{i=1}^{x}x\\%i\\times i^{-1}\\pmod{998244353}$$\n\n$i<j$$i\\%j=i$\n\n$$\\begin{aligned}\n&g(x)-ans(x)\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\%i\\times i^{-1}\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\times i^{-1}\n\\pmod{998244353}\n\\end{aligned}$$\n\n\n\n$$ans(x)\\equiv g(x)-x\\sum\\limits_{i=x+1}^{n}i^{-1}$$\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\equiv\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}$$\n\n$O(1)$","source":"_posts/2018-10-04-luogu-p4900-solution.md","raw":"---\ntitle: Luogu-P4900\ndate: 2018-10-04 12:11:18\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n[](https://www.luogu.org/problemnew/show/P4900)\n\n<!-- more -->\n\n~~~~\n\n\n\n$$\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\pmod{998244353}$$\n\n$\\lbrace x\\rbrace$$x$\n\n\n\n$$\\begin{aligned}\n&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\\\\n\\equiv&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\\\\n\\equiv&\\sum\\limits_{i=1}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}-\\sum\\limits_{i=1}^{A-1}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\n\\pmod{998244353}\n\\end{aligned}$$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\pmod{998244353}$$\n\n[](https://www.luogu.org/problemnew/show/P3708)\n\n\n\n$$f(x)=\\sum\\limits_{i=1}^{n}x\\%i$$\n\n$x\\%i=0$\n\n$$x\\%i=(x-1)\\%i+1$$\n\n$$f(x)=f(x-1)+n$$\n\n$x\\%i=0$$f(x)$$i$$i$$x$\n\n$$f(x)=f(x-1)+n-\\sigma(x)$$\n\n\n\n$$g(x)=\\sum\\limits_{i=1}^{n}x\\%i\\times i^{-1}\\pmod{998244353}$$\n\n$$h(x)=\\sum\\limits_{i\\mid x}i\\times i^{-1}\\equiv\\sum\\limits_{i\\mid x}1\\equiv d(x)\\pmod{998244353}$$\n\n\n\n$$g(x)\\equiv g(x-1)+\\sum\\limits_{i=1}^{n}i^{-1}-d(x)\\pmod{998244353}$$\n\n\n\n$$\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}$$\n\n\n\n$$ans(x)=\\sum\\limits_{i=1}^{x}x\\%i\\times i^{-1}\\pmod{998244353}$$\n\n$i<j$$i\\%j=i$\n\n$$\\begin{aligned}\n&g(x)-ans(x)\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\%i\\times i^{-1}\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\times i^{-1}\n\\pmod{998244353}\n\\end{aligned}$$\n\n\n\n$$ans(x)\\equiv g(x)-x\\sum\\limits_{i=x+1}^{n}i^{-1}$$\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\equiv\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}$$\n\n$O(1)$","slug":"luogu-p4900-solution","published":1,"updated":"2018-12-12T02:04:37.245Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzm0009gwgur9peacbf","content":"<p><a href=\"https://www.luogu.org/problemnew/show/P4900\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\pmod{998244353}</script><p>$\\lbrace x\\rbrace$$x$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\\\\n\\equiv&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\\\\n\\equiv&\\sum\\limits_{i=1}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}-\\sum\\limits_{i=1}^{A-1}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\n\\pmod{998244353}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\pmod{998244353}</script><p><a href=\"https://www.luogu.org/problemnew/show/P3708\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<script type=\"math/tex; mode=display\">f(x)=\\sum\\limits_{i=1}^{n}x\\%i</script><p>$x\\%i=0$</p>\n<script type=\"math/tex; mode=display\">x\\%i=(x-1)\\%i+1</script><script type=\"math/tex; mode=display\">f(x)=f(x-1)+n</script><p>$x\\%i=0$$f(x)$$i$$i$$x$</p>\n<script type=\"math/tex; mode=display\">f(x)=f(x-1)+n-\\sigma(x)</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=1}^{n}x\\%i\\times i^{-1}\\pmod{998244353}</script><script type=\"math/tex; mode=display\">h(x)=\\sum\\limits_{i\\mid x}i\\times i^{-1}\\equiv\\sum\\limits_{i\\mid x}1\\equiv d(x)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)\\equiv g(x-1)+\\sum\\limits_{i=1}^{n}i^{-1}-d(x)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">ans(x)=\\sum\\limits_{i=1}^{x}x\\%i\\times i^{-1}\\pmod{998244353}</script><p>$i&lt;j$$i\\%j=i$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n&g(x)-ans(x)\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\%i\\times i^{-1}\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\times i^{-1}\n\\pmod{998244353}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">ans(x)\\equiv g(x)-x\\sum\\limits_{i=x+1}^{n}i^{-1}</script><script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\equiv\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}</script><p>$O(1)$</p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/problemnew/show/P4900\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\pmod{998244353}</script><p>$\\lbrace x\\rbrace$$x$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}\\lbrace\\frac{i}{j}\\rbrace\\\\\n\\equiv&\\sum\\limits_{i=A}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\\\\n\\equiv&\\sum\\limits_{i=1}^{B}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}-\\sum\\limits_{i=1}^{A-1}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\n\\pmod{998244353}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\pmod{998244353}</script><p><a href=\"https://www.luogu.org/problemnew/show/P3708\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<script type=\"math/tex; mode=display\">f(x)=\\sum\\limits_{i=1}^{n}x\\%i</script><p>$x\\%i=0$</p>\n<script type=\"math/tex; mode=display\">x\\%i=(x-1)\\%i+1</script><script type=\"math/tex; mode=display\">f(x)=f(x-1)+n</script><p>$x\\%i=0$$f(x)$$i$$i$$x$</p>\n<script type=\"math/tex; mode=display\">f(x)=f(x-1)+n-\\sigma(x)</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=1}^{n}x\\%i\\times i^{-1}\\pmod{998244353}</script><script type=\"math/tex; mode=display\">h(x)=\\sum\\limits_{i\\mid x}i\\times i^{-1}\\equiv\\sum\\limits_{i\\mid x}1\\equiv d(x)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)\\equiv g(x-1)+\\sum\\limits_{i=1}^{n}i^{-1}-d(x)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}</script><p></p>\n<script type=\"math/tex; mode=display\">ans(x)=\\sum\\limits_{i=1}^{x}x\\%i\\times i^{-1}\\pmod{998244353}</script><p>$i&lt;j$$i\\%j=i$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n&g(x)-ans(x)\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\%i\\times i^{-1}\\\\\n\\equiv&\\sum\\limits_{i=x+1}^{n}x\\times i^{-1}\n\\pmod{998244353}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">ans(x)\\equiv g(x)-x\\sum\\limits_{i=x+1}^{n}i^{-1}</script><script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{i}i\\%j\\times j^{-1}\\equiv\\sum\\limits_{i=1}^{n}ans(i)\\pmod{998244353}</script><p>$O(1)$</p>"},{"title":"SDOI2009","date":"2018-10-12T03:28:50.000Z","mathjax":true,"_content":"[](https://www.luogu.org/problemnew/show/P2154)\n\n<!-- more -->\n\n~~~~~~~~\n\n$x$$L$$R$$U$$D$\n\n$$C_{L}^{k}C_{R}^{k}C_{U}^{k}C_{D}^{k}$$\n\n$k\\geqslant 1$$x$$y$$sumx[x]$$sumy[y]$$x$$y$$i$$cntx[x]$$i-1$$x$$cnty[y]$$i-1$$y$$(x[i],y[i])$$x[i]=x[i-1]$$i$$i-1$\n\n$$C_{cntx[x[i]]}^{k}C_{sumx[x[i]]-cntx[x[i]]}^{k}(\\sum\\limits_{i=y[i-1]+1}^{y[i]-1}C_{cnty[i]}^{k}C_{sumy[i]-cnty[i]}^{k})$$\n\n$\\Sigma$~~~~\n\n\n\n```cpp\n#include<cstdio>\n\nstruct NOIp{\n    unsigned long long RP,score;\n};\nNOIp NOIp2018;\n\nint main(){\n    for(;;){\n        NOIp2018.RP++;\n        NOIp2018.score++;\n    }\n    return 0;\n}\n```\n\nNOIp~~~~qaq","source":"_posts/2018-10-12-luogu-p2154-solution.md","raw":"---\ntitle: SDOI2009\ndate: 2018-10-12 11:28:50\ntags:\n  - SDOI\n  - 2009\n  - \n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n[](https://www.luogu.org/problemnew/show/P2154)\n\n<!-- more -->\n\n~~~~~~~~\n\n$x$$L$$R$$U$$D$\n\n$$C_{L}^{k}C_{R}^{k}C_{U}^{k}C_{D}^{k}$$\n\n$k\\geqslant 1$$x$$y$$sumx[x]$$sumy[y]$$x$$y$$i$$cntx[x]$$i-1$$x$$cnty[y]$$i-1$$y$$(x[i],y[i])$$x[i]=x[i-1]$$i$$i-1$\n\n$$C_{cntx[x[i]]}^{k}C_{sumx[x[i]]-cntx[x[i]]}^{k}(\\sum\\limits_{i=y[i-1]+1}^{y[i]-1}C_{cnty[i]}^{k}C_{sumy[i]-cnty[i]}^{k})$$\n\n$\\Sigma$~~~~\n\n\n\n```cpp\n#include<cstdio>\n\nstruct NOIp{\n    unsigned long long RP,score;\n};\nNOIp NOIp2018;\n\nint main(){\n    for(;;){\n        NOIp2018.RP++;\n        NOIp2018.score++;\n    }\n    return 0;\n}\n```\n\nNOIp~~~~qaq","slug":"luogu-p2154-solution","published":1,"updated":"2018-12-12T02:06:49.568Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzo000bgwgu7z6logkw","content":"<p><a href=\"https://www.luogu.org/problemnew/show/P2154\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<p><del></del><del></del></p>\n<p>$x$$L$$R$$U$$D$</p>\n<script type=\"math/tex; mode=display\">C_{L}^{k}C_{R}^{k}C_{U}^{k}C_{D}^{k}</script><p>$k\\geqslant 1$$x$$y$$sumx[x]$$sumy[y]$$x$$y$$i$$cntx[x]$$i-1$$x$$cnty[y]$$i-1$$y$$(x[i],y[i])$$x[i]=x[i-1]$$i$$i-1$</p>\n<script type=\"math/tex; mode=display\">C_{cntx[x[i]]}^{k}C_{sumx[x[i]]-cntx[x[i]]}^{k}(\\sum\\limits_{i=y[i-1]+1}^{y[i]-1}C_{cnty[i]}^{k}C_{sumy[i]-cnty[i]}^{k})</script><p>$\\Sigma$<del></del></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">NOIp</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> RP,score;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">NOIp NOIp2018;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;;)&#123;</span><br><span class=\"line\">        NOIp2018.RP++;</span><br><span class=\"line\">        NOIp2018.score++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>NOIp<del></del>qaq</p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/problemnew/show/P2154\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<p><del></del><del></del></p>\n<p>$x$$L$$R$$U$$D$</p>\n<script type=\"math/tex; mode=display\">C_{L}^{k}C_{R}^{k}C_{U}^{k}C_{D}^{k}</script><p>$k\\geqslant 1$$x$$y$$sumx[x]$$sumy[y]$$x$$y$$i$$cntx[x]$$i-1$$x$$cnty[y]$$i-1$$y$$(x[i],y[i])$$x[i]=x[i-1]$$i$$i-1$</p>\n<script type=\"math/tex; mode=display\">C_{cntx[x[i]]}^{k}C_{sumx[x[i]]-cntx[x[i]]}^{k}(\\sum\\limits_{i=y[i-1]+1}^{y[i]-1}C_{cnty[i]}^{k}C_{sumy[i]-cnty[i]}^{k})</script><p>$\\Sigma$<del></del></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">NOIp</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> RP,score;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">NOIp NOIp2018;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;;)&#123;</span><br><span class=\"line\">        NOIp2018.RP++;</span><br><span class=\"line\">        NOIp2018.score++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>NOIp<del></del>qaq</p>"},{"title":"Luogu-P3924","date":"2018-09-29T08:20:16.000Z","mathjax":true,"_content":"[](https://www.luogu.org/problemnew/show/P3924)\n\n<!-- more -->\n\n\n\n> $70\\%$$1\\leqslant n,m\\leqslant 10^{5}$\n> \n> $100\\%$$1\\leqslant n,m\\leqslant 10^{6}$\n\n~~____$70$$70$~~\n\n> Updated on 2018-10-09\n> \n> \n> \n> \n\n\n\n$E_i$$[i,i]$$c_i$$c_ia_i=E_i$$c_i$$\\prod_{i=1}^{n}c_ia_i$$c_i$$c_i$\n\n$0$$x$$2^{-dep[x]}$$dep[x]$$x$$x$$[i,i]$$c_i+=2^{-dep[x]}$DPDFSDFS$c$DFS$c$\n\n\n\n","source":"_posts/2018-09-29-luogu-p3924-solution.md","raw":"---\ntitle: Luogu-P3924\ndate: 2018-09-29 16:20:16\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n[](https://www.luogu.org/problemnew/show/P3924)\n\n<!-- more -->\n\n\n\n> $70\\%$$1\\leqslant n,m\\leqslant 10^{5}$\n> \n> $100\\%$$1\\leqslant n,m\\leqslant 10^{6}$\n\n~~____$70$$70$~~\n\n> Updated on 2018-10-09\n> \n> \n> \n> \n\n\n\n$E_i$$[i,i]$$c_i$$c_ia_i=E_i$$c_i$$\\prod_{i=1}^{n}c_ia_i$$c_i$$c_i$\n\n$0$$x$$2^{-dep[x]}$$dep[x]$$x$$x$$[i,i]$$c_i+=2^{-dep[x]}$DPDFSDFS$c$DFS$c$\n\n\n\n","slug":"luogu-p3924-solution","published":1,"updated":"2018-12-19T12:01:29.650Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzr000fgwgurbbjeq31","content":"<p><a href=\"https://www.luogu.org/problemnew/show/P3924\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<p></p>\n<blockquote>\n<p>$70\\%$$1\\leqslant n,m\\leqslant 10^{5}$</p>\n<p>$100\\%$$1\\leqslant n,m\\leqslant 10^{6}$</p>\n</blockquote>\n<p><del><strong></strong>$70$$70$</del></p>\n<blockquote>\n<p>Updated on 2018-10-09</p>\n<p></p>\n<p></p>\n</blockquote>\n<p></p>\n<p>$E_i$$[i,i]$$c_i$$c_ia_i=E_i$$c_i$$\\prod_{i=1}^{n}c_ia_i$$c_i$$c_i$</p>\n<p>$0$$x$$2^{-dep[x]}$$dep[x]$$x$$x$$[i,i]$$c_i+=2^{-dep[x]}$DPDFSDFS$c$DFS$c$</p>\n<p></p>\n<p></p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/problemnew/show/P3924\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<p></p>\n<blockquote>\n<p>$70\\%$$1\\leqslant n,m\\leqslant 10^{5}$</p>\n<p>$100\\%$$1\\leqslant n,m\\leqslant 10^{6}$</p>\n</blockquote>\n<p><del><strong></strong>$70$$70$</del></p>\n<blockquote>\n<p>Updated on 2018-10-09</p>\n<p></p>\n<p></p>\n</blockquote>\n<p></p>\n<p>$E_i$$[i,i]$$c_i$$c_ia_i=E_i$$c_i$$\\prod_{i=1}^{n}c_ia_i$$c_i$$c_i$</p>\n<p>$0$$x$$2^{-dep[x]}$$dep[x]$$x$$x$$[i,i]$$c_i+=2^{-dep[x]}$DPDFSDFS$c$DFS$c$</p>\n<p></p>\n<p></p>"},{"title":"","date":"2018-10-24T13:24:05.000Z","mathjax":true,"_content":"~~~~\n\n~~~~\n\n~~blog~~\n\n<!-- more -->\n\n[USACO06NOVCorn Fields](https://www.luogu.org/problemnew/show/P1879)\n\n`f[i][...]`$i$blablabla$i$`f[i][0/1]...(10[0/1])...[0/1]`$12$$j+1$$i$$j$\n\n$13$\n\n![](https://i.loli.net/2018/10/24/5bd07656b885a.jpg)\n\n$12$$0$$1$$12$$2$$i$$i$$1$$0$$12$$2$\n\n`f[i][S]`$i$$i$$S$`a[i]`$i$$1$$0$`valid[S]`$S$$1$`a[i]``valid[S]`\n\n```cpp\nfor(re int i=1;i<(1<<m);++i)\n    valid[i]=valid[i>>1]&(~(i&(i>>1)&1));\n```\n\n`[S]=[S>>1]&[SS>>11]`\n\n`(S|a[i])==a[i]&&valid[S]&&(S&S')==0`\n\n```cpp\nfor(re int i=0;i<(1<<m);++i)\n    if((i|a[1])==a[1]&&valid[i])\n        f[1][i]=1;\nfor(re int i=2;i<=n;++i)\n    for(re int j=0;j<(1<<m);++j)\n        if((j|a[i])==a[i]&&valid[j])\n            for(re int k=0;k<(1<<m);++k)\n                if((k|a[i-1])==a[i-1]&&valid[k]&&(k&j)==0)\n                    (f[i][j]+=f[i-1][k])%=mod;\n```\n\n$O(n4^m)$$12\\times 4^{12}=201326592$`if`\n\n[NOI2001](https://www.luogu.org/problemnew/show/P2704)\n\n`f[i][S1][S2]`$i$$i-1$$S1$$i$$S2$`a[i]``valid[S]``valid[s]`\n\n```cpp\nfor(re int i=1;i<(1<<m);++i){\n    valid[i]=(i&1)?valid[i>>3]&((~i)>>2)&((~i)>>1):valid[i>>1];\n```\n\n![](https://i.loli.net/2018/10/25/5bd124f4cdbb9.jpg)\n\n~~~~~~~~\n\n\n\n\n\n$S$$1$`[S]=[S>>3]&[S230]``[S]=[S>>1]`\n\n$S$$1$\n\n```cpp\nfor(re int i=1;i<(1<<m);++i)\n    cnt[i]=cnt[i>>1]+(i&1);\n```\n\n\n\n```cpp\nfor(re int i=0;i<(1<<m);++i)\n    if((i|a[1])==a[1]&&valid[i])\n        for(re int j=0;j<(1<<m);++j)\n            if((j|a[2])==a[2]&&valid[j]&&(i&j)==0)\n                    f[2][i][j]=cnt[i]+cnt[j];\nfor(re int i=3;i<=n;++i)\n    for(re int j=0;j<(1<<m);++j)\n        if((j|a[i-2])==a[i-2]&&valid[j])\n            for(re int k=0;k<(1<<m);++k)\n                if((k|a[i-1])==a[i-1]&&valid[k]&&(j&k)==0)\n                    for(re int l=0;l<(1<<m);++l)\n                        if((l|a[i])==a[i]&&valid[l]&&(l&j)==0&&(l&k)==0)\n                            f[i][k][l]=max(f[i][k][l],f[i-1][j][k]+cnt[l]);\n```\n\n$O(n8^m)$$100\\times 8^{10}=107374182400$$O(\\text{won't TLE})$\n\n[SP3953MMINPAID - Paid Roads](https://www.spoj.com/problems/MMINPAID/)~~~~[](https://www.luogu.org/problemnew/show/SP3953)\n\n$2$`dis[u][S]`$S$$1$$u$$u$$v$`dis[v][S|(1<<(v-1))]=min(dis[v][S|(1<<(v-1))],dis[u][S]+cost)`$cost$$u$$v$\n\nDijkstra\n\n~~impossibleImpossibleWA~~\n\n$n\\leqslant 20$~~~~$O(2^n)$$O(n2^n)$$O(n^22^n)$\n\n![](https://i.loli.net/2018/10/25/5bd13984b8601.jpg)\n\n","source":"_posts/2018-10-24-status-compression-learning-notes.md","raw":"---\ntitle: \ndate: 2018-10-24 21:24:05\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n~~~~\n\n~~~~\n\n~~blog~~\n\n<!-- more -->\n\n[USACO06NOVCorn Fields](https://www.luogu.org/problemnew/show/P1879)\n\n`f[i][...]`$i$blablabla$i$`f[i][0/1]...(10[0/1])...[0/1]`$12$$j+1$$i$$j$\n\n$13$\n\n![](https://i.loli.net/2018/10/24/5bd07656b885a.jpg)\n\n$12$$0$$1$$12$$2$$i$$i$$1$$0$$12$$2$\n\n`f[i][S]`$i$$i$$S$`a[i]`$i$$1$$0$`valid[S]`$S$$1$`a[i]``valid[S]`\n\n```cpp\nfor(re int i=1;i<(1<<m);++i)\n    valid[i]=valid[i>>1]&(~(i&(i>>1)&1));\n```\n\n`[S]=[S>>1]&[SS>>11]`\n\n`(S|a[i])==a[i]&&valid[S]&&(S&S')==0`\n\n```cpp\nfor(re int i=0;i<(1<<m);++i)\n    if((i|a[1])==a[1]&&valid[i])\n        f[1][i]=1;\nfor(re int i=2;i<=n;++i)\n    for(re int j=0;j<(1<<m);++j)\n        if((j|a[i])==a[i]&&valid[j])\n            for(re int k=0;k<(1<<m);++k)\n                if((k|a[i-1])==a[i-1]&&valid[k]&&(k&j)==0)\n                    (f[i][j]+=f[i-1][k])%=mod;\n```\n\n$O(n4^m)$$12\\times 4^{12}=201326592$`if`\n\n[NOI2001](https://www.luogu.org/problemnew/show/P2704)\n\n`f[i][S1][S2]`$i$$i-1$$S1$$i$$S2$`a[i]``valid[S]``valid[s]`\n\n```cpp\nfor(re int i=1;i<(1<<m);++i){\n    valid[i]=(i&1)?valid[i>>3]&((~i)>>2)&((~i)>>1):valid[i>>1];\n```\n\n![](https://i.loli.net/2018/10/25/5bd124f4cdbb9.jpg)\n\n~~~~~~~~\n\n\n\n\n\n$S$$1$`[S]=[S>>3]&[S230]``[S]=[S>>1]`\n\n$S$$1$\n\n```cpp\nfor(re int i=1;i<(1<<m);++i)\n    cnt[i]=cnt[i>>1]+(i&1);\n```\n\n\n\n```cpp\nfor(re int i=0;i<(1<<m);++i)\n    if((i|a[1])==a[1]&&valid[i])\n        for(re int j=0;j<(1<<m);++j)\n            if((j|a[2])==a[2]&&valid[j]&&(i&j)==0)\n                    f[2][i][j]=cnt[i]+cnt[j];\nfor(re int i=3;i<=n;++i)\n    for(re int j=0;j<(1<<m);++j)\n        if((j|a[i-2])==a[i-2]&&valid[j])\n            for(re int k=0;k<(1<<m);++k)\n                if((k|a[i-1])==a[i-1]&&valid[k]&&(j&k)==0)\n                    for(re int l=0;l<(1<<m);++l)\n                        if((l|a[i])==a[i]&&valid[l]&&(l&j)==0&&(l&k)==0)\n                            f[i][k][l]=max(f[i][k][l],f[i-1][j][k]+cnt[l]);\n```\n\n$O(n8^m)$$100\\times 8^{10}=107374182400$$O(\\text{won't TLE})$\n\n[SP3953MMINPAID - Paid Roads](https://www.spoj.com/problems/MMINPAID/)~~~~[](https://www.luogu.org/problemnew/show/SP3953)\n\n$2$`dis[u][S]`$S$$1$$u$$u$$v$`dis[v][S|(1<<(v-1))]=min(dis[v][S|(1<<(v-1))],dis[u][S]+cost)`$cost$$u$$v$\n\nDijkstra\n\n~~impossibleImpossibleWA~~\n\n$n\\leqslant 20$~~~~$O(2^n)$$O(n2^n)$$O(n^22^n)$\n\n![](https://i.loli.net/2018/10/25/5bd13984b8601.jpg)\n\n","slug":"status-compression-learning-notes","published":1,"updated":"2018-12-19T12:03:55.791Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzu000ggwgum42cxicx","content":"<p><del></del></p>\n<p><del></del></p>\n<p><del>blog</del></p>\n<a id=\"more\"></a>\n<p><a href=\"https://www.luogu.org/problemnew/show/P1879\" target=\"_blank\" rel=\"noopener\">USACO06NOVCorn Fields</a></p>\n<p><code>f[i][...]</code>$i$blablabla$i$<code>f[i][0/1]...(10[0/1])...[0/1]</code>$12$$j+1$$i$$j$</p>\n<p>$13$</p>\n<p><img src=\"https://i.loli.net/2018/10/24/5bd07656b885a.jpg\" alt=\"\"></p>\n<p>$12$$0$$1$$12$$2$$i$$i$$1$$0$$12$$2$</p>\n<p><code>f[i][S]</code>$i$$i$$S$<code>a[i]</code>$i$$1$$0$<code>valid[S]</code>$S$$1$<code>a[i]</code><code>valid[S]</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    valid[i]=valid[i&gt;&gt;<span class=\"number\">1</span>]&amp;(~(i&amp;(i&gt;&gt;<span class=\"number\">1</span>)&amp;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n<p><code>[S]=[S&gt;&gt;1]&amp;[SS&gt;&gt;11]</code></p>\n<p><code>(S|a[i])==a[i]&amp;&amp;valid[S]&amp;&amp;(S&amp;S&#39;)==0</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((i|a[<span class=\"number\">1</span>])==a[<span class=\"number\">1</span>]&amp;&amp;valid[i])</span><br><span class=\"line\">        f[<span class=\"number\">1</span>][i]=<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;++i)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((j|a[i])==a[i]&amp;&amp;valid[j])</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(<span class=\"number\">1</span>&lt;&lt;m);++k)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>((k|a[i<span class=\"number\">-1</span>])==a[i<span class=\"number\">-1</span>]&amp;&amp;valid[k]&amp;&amp;(k&amp;j)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    (f[i][j]+=f[i<span class=\"number\">-1</span>][k])%=mod;</span><br></pre></td></tr></table></figure>\n<p>$O(n4^m)$$12\\times 4^{12}=201326592$<code>if</code></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P2704\" target=\"_blank\" rel=\"noopener\">NOI2001</a></p>\n<p><code>f[i][S1][S2]</code>$i$$i-1$$S1$$i$$S2$<code>a[i]</code><code>valid[S]</code><code>valid[s]</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)&#123;</span><br><span class=\"line\">    valid[i]=(i&amp;<span class=\"number\">1</span>)?valid[i&gt;&gt;<span class=\"number\">3</span>]&amp;((~i)&gt;&gt;<span class=\"number\">2</span>)&amp;((~i)&gt;&gt;<span class=\"number\">1</span>):valid[i&gt;&gt;<span class=\"number\">1</span>];</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://i.loli.net/2018/10/25/5bd124f4cdbb9.jpg\" alt=\"\"></p>\n<p><del></del><del></del></p>\n<p></p>\n<p></p>\n<p>$S$$1$<code>[S]=[S&gt;&gt;3]&amp;[S230]</code><code>[S]=[S&gt;&gt;1]</code></p>\n<p>$S$$1$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    cnt[i]=cnt[i&gt;&gt;<span class=\"number\">1</span>]+(i&amp;<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((i|a[<span class=\"number\">1</span>])==a[<span class=\"number\">1</span>]&amp;&amp;valid[i])</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((j|a[<span class=\"number\">2</span>])==a[<span class=\"number\">2</span>]&amp;&amp;valid[j]&amp;&amp;(i&amp;j)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    f[<span class=\"number\">2</span>][i][j]=cnt[i]+cnt[j];</span><br><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">3</span>;i&lt;=n;++i)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((j|a[i<span class=\"number\">-2</span>])==a[i<span class=\"number\">-2</span>]&amp;&amp;valid[j])</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(<span class=\"number\">1</span>&lt;&lt;m);++k)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>((k|a[i<span class=\"number\">-1</span>])==a[i<span class=\"number\">-1</span>]&amp;&amp;valid[k]&amp;&amp;(j&amp;k)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">0</span>;l&lt;(<span class=\"number\">1</span>&lt;&lt;m);++l)</span><br><span class=\"line\">                        <span class=\"keyword\">if</span>((l|a[i])==a[i]&amp;&amp;valid[l]&amp;&amp;(l&amp;j)==<span class=\"number\">0</span>&amp;&amp;(l&amp;k)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                            f[i][k][l]=max(f[i][k][l],f[i<span class=\"number\">-1</span>][j][k]+cnt[l]);</span><br></pre></td></tr></table></figure>\n<p>$O(n8^m)$$100\\times 8^{10}=107374182400$$O(\\text{wont TLE})$</p>\n<p><a href=\"https://www.spoj.com/problems/MMINPAID/\" target=\"_blank\" rel=\"noopener\">SP3953MMINPAID - Paid Roads</a><del></del><a href=\"https://www.luogu.org/problemnew/show/SP3953\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>$2$<code>dis[u][S]</code>$S$$1$$u$$u$$v$<code>dis[v][S|(1&lt;&lt;(v-1))]=min(dis[v][S|(1&lt;&lt;(v-1))],dis[u][S]+cost)</code>$cost$$u$$v$</p>\n<p>Dijkstra</p>\n<p><del>impossibleImpossibleWA</del></p>\n<p>$n\\leqslant 20$<del></del>$O(2^n)$$O(n2^n)$$O(n^22^n)$</p>\n<p><img src=\"https://i.loli.net/2018/10/25/5bd13984b8601.jpg\" alt=\"\"></p>\n<p></p>\n","site":{"data":{}},"excerpt":"<p><del></del></p>\n<p><del></del></p>\n<p><del>blog</del></p>","more":"<p><a href=\"https://www.luogu.org/problemnew/show/P1879\" target=\"_blank\" rel=\"noopener\">USACO06NOVCorn Fields</a></p>\n<p><code>f[i][...]</code>$i$blablabla$i$<code>f[i][0/1]...(10[0/1])...[0/1]</code>$12$$j+1$$i$$j$</p>\n<p>$13$</p>\n<p><img src=\"https://i.loli.net/2018/10/24/5bd07656b885a.jpg\" alt=\"\"></p>\n<p>$12$$0$$1$$12$$2$$i$$i$$1$$0$$12$$2$</p>\n<p><code>f[i][S]</code>$i$$i$$S$<code>a[i]</code>$i$$1$$0$<code>valid[S]</code>$S$$1$<code>a[i]</code><code>valid[S]</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    valid[i]=valid[i&gt;&gt;<span class=\"number\">1</span>]&amp;(~(i&amp;(i&gt;&gt;<span class=\"number\">1</span>)&amp;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n<p><code>[S]=[S&gt;&gt;1]&amp;[SS&gt;&gt;11]</code></p>\n<p><code>(S|a[i])==a[i]&amp;&amp;valid[S]&amp;&amp;(S&amp;S&#39;)==0</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((i|a[<span class=\"number\">1</span>])==a[<span class=\"number\">1</span>]&amp;&amp;valid[i])</span><br><span class=\"line\">        f[<span class=\"number\">1</span>][i]=<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;++i)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((j|a[i])==a[i]&amp;&amp;valid[j])</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(<span class=\"number\">1</span>&lt;&lt;m);++k)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>((k|a[i<span class=\"number\">-1</span>])==a[i<span class=\"number\">-1</span>]&amp;&amp;valid[k]&amp;&amp;(k&amp;j)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    (f[i][j]+=f[i<span class=\"number\">-1</span>][k])%=mod;</span><br></pre></td></tr></table></figure>\n<p>$O(n4^m)$$12\\times 4^{12}=201326592$<code>if</code></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P2704\" target=\"_blank\" rel=\"noopener\">NOI2001</a></p>\n<p><code>f[i][S1][S2]</code>$i$$i-1$$S1$$i$$S2$<code>a[i]</code><code>valid[S]</code><code>valid[s]</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)&#123;</span><br><span class=\"line\">    valid[i]=(i&amp;<span class=\"number\">1</span>)?valid[i&gt;&gt;<span class=\"number\">3</span>]&amp;((~i)&gt;&gt;<span class=\"number\">2</span>)&amp;((~i)&gt;&gt;<span class=\"number\">1</span>):valid[i&gt;&gt;<span class=\"number\">1</span>];</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://i.loli.net/2018/10/25/5bd124f4cdbb9.jpg\" alt=\"\"></p>\n<p><del></del><del></del></p>\n<p></p>\n<p></p>\n<p>$S$$1$<code>[S]=[S&gt;&gt;3]&amp;[S230]</code><code>[S]=[S&gt;&gt;1]</code></p>\n<p>$S$$1$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    cnt[i]=cnt[i&gt;&gt;<span class=\"number\">1</span>]+(i&amp;<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(<span class=\"number\">1</span>&lt;&lt;m);++i)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((i|a[<span class=\"number\">1</span>])==a[<span class=\"number\">1</span>]&amp;&amp;valid[i])</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((j|a[<span class=\"number\">2</span>])==a[<span class=\"number\">2</span>]&amp;&amp;valid[j]&amp;&amp;(i&amp;j)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    f[<span class=\"number\">2</span>][i][j]=cnt[i]+cnt[j];</span><br><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">3</span>;i&lt;=n;++i)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(<span class=\"number\">1</span>&lt;&lt;m);++j)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((j|a[i<span class=\"number\">-2</span>])==a[i<span class=\"number\">-2</span>]&amp;&amp;valid[j])</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(<span class=\"number\">1</span>&lt;&lt;m);++k)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>((k|a[i<span class=\"number\">-1</span>])==a[i<span class=\"number\">-1</span>]&amp;&amp;valid[k]&amp;&amp;(j&amp;k)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">0</span>;l&lt;(<span class=\"number\">1</span>&lt;&lt;m);++l)</span><br><span class=\"line\">                        <span class=\"keyword\">if</span>((l|a[i])==a[i]&amp;&amp;valid[l]&amp;&amp;(l&amp;j)==<span class=\"number\">0</span>&amp;&amp;(l&amp;k)==<span class=\"number\">0</span>)</span><br><span class=\"line\">                            f[i][k][l]=max(f[i][k][l],f[i<span class=\"number\">-1</span>][j][k]+cnt[l]);</span><br></pre></td></tr></table></figure>\n<p>$O(n8^m)$$100\\times 8^{10}=107374182400$$O(\\text{wont TLE})$</p>\n<p><a href=\"https://www.spoj.com/problems/MMINPAID/\" target=\"_blank\" rel=\"noopener\">SP3953MMINPAID - Paid Roads</a><del></del><a href=\"https://www.luogu.org/problemnew/show/SP3953\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>$2$<code>dis[u][S]</code>$S$$1$$u$$u$$v$<code>dis[v][S|(1&lt;&lt;(v-1))]=min(dis[v][S|(1&lt;&lt;(v-1))],dis[u][S]+cost)</code>$cost$$u$$v$</p>\n<p>Dijkstra</p>\n<p><del>impossibleImpossibleWA</del></p>\n<p>$n\\leqslant 20$<del></del>$O(2^n)$$O(n2^n)$$O(n^22^n)$</p>\n<p><img src=\"https://i.loli.net/2018/10/25/5bd13984b8601.jpg\" alt=\"\"></p>\n<p></p>"},{"title":"","date":"2018-11-14T03:02:21.000Z","mathjax":true,"top":1,"_content":"\n\n~~~~\n\n<!-- more -->\n\n# Problem 1\n\n## Description\n\n$\\text{LIS()}$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}$\n\n$$\\forall 1\\leqslant i\\leqslant n\\;\\; f_i=\\begin{cases}&1&(i=1\\vee \\forall 1\\leqslant j<i\\;\\; a_j\\geqslant a_i)\\\\&\\max\\limits_{1\\leqslant j<i\\wedge a_j<a_i}f_j+1&(\\text{Otherwise})\\\\\\end{cases}$$\n\n$n$$\\{ f_n\\}$\n\n$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}\\wedge\\forall 1\\leqslant i\\leqslant n\\;\\; a_i\\in [1,m]\\cap\\mathbb{Z}$$\n\n$\\{ a_n\\}$$998244353$\n\n## Solution\n\n\n\n$$\\forall 1\\leqslant i<j\\leqslant n\\wedge f_i=f_j\\;\\;a_i\\geqslant a_j$$\n\n$$\\forall 1\\leqslant i,j\\leqslant n\\wedge f_i<f_j\\;\\;a_i<a_j$$\n\n$\\{ f_n\\}$$k$$x$$cnt_x$$[1,m]$$k$$[1,x_1],[x_1+1,x_2],\\cdots,[x_{k-1}+1,m]$$i$$cnt_i$\n\n$\\text{nisc}(\\text{Non-Increasing Sequence Count})(n,m)$$n$$m$\n\n$m=1$$f[i][j]$$m=i$$j$\n\n$$\\forall 1\\leqslant i\\leqslant n\\;\\;f[1][i]=1$$\n\n$$\\text{nisc}(n,1)=\\sum\\limits_{i=1}^nf[1][i]=n$$\n\n$m=2$$j$$1,2,\\cdots,j$\n\n$$f[2][j]=\\sum\\limits_{k=1}^jf[1][k]$$\n\n\n\n$$f[i][j]=\\sum\\limits_{k=1}^jf[i-1][k]$$\n\n$$\\text{nisc}(n,m)=\\sum_{i=1}^nf[m][i]=f[m+1][n]$$\n\n$1$$m$$n$\n\n$$\\text{nisc}(n,m)=\\frac1{m!}\\prod\\limits_{i=1}^{m}(n+i-1)$$\n\nnaive$\\text{DP}$$g[i][j]$$[1,i]$$j$$j$$cnt_j$\n\n$$g[n][m]=\\sum\\limits_{i=m-1}^{n-1}g[i][m-1]\\text{nisc}(n-i,cnt_m)$$\n\n\n\n\n\n```plaintext\n3 3\n1 2 1\n```\n\n$4$$5$\n\n$[1,3]$$\\{[1,1],[2,3]\\}$$\\{[1,2],[3,3]\\}$$\\{\\{1,2,1\\},\\{1,3,1\\}\\}$$\\{\\{1,3,1\\},\\{1,3,2\\},\\{2,3,2\\}\\}$$\\{1,3,1\\}$\n","source":"_posts/2018-11-14-poisonous-problems.md","raw":"---\ntitle: \ndate: 2018-11-14 11:02:21\ntags:\n  - \ncategories:\n  - \nmathjax: true\ntop: 1\n---\n\n\n~~~~\n\n<!-- more -->\n\n# Problem 1\n\n## Description\n\n$\\text{LIS()}$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}$\n\n$$\\forall 1\\leqslant i\\leqslant n\\;\\; f_i=\\begin{cases}&1&(i=1\\vee \\forall 1\\leqslant j<i\\;\\; a_j\\geqslant a_i)\\\\&\\max\\limits_{1\\leqslant j<i\\wedge a_j<a_i}f_j+1&(\\text{Otherwise})\\\\\\end{cases}$$\n\n$n$$\\{ f_n\\}$\n\n$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}\\wedge\\forall 1\\leqslant i\\leqslant n\\;\\; a_i\\in [1,m]\\cap\\mathbb{Z}$$\n\n$\\{ a_n\\}$$998244353$\n\n## Solution\n\n\n\n$$\\forall 1\\leqslant i<j\\leqslant n\\wedge f_i=f_j\\;\\;a_i\\geqslant a_j$$\n\n$$\\forall 1\\leqslant i,j\\leqslant n\\wedge f_i<f_j\\;\\;a_i<a_j$$\n\n$\\{ f_n\\}$$k$$x$$cnt_x$$[1,m]$$k$$[1,x_1],[x_1+1,x_2],\\cdots,[x_{k-1}+1,m]$$i$$cnt_i$\n\n$\\text{nisc}(\\text{Non-Increasing Sequence Count})(n,m)$$n$$m$\n\n$m=1$$f[i][j]$$m=i$$j$\n\n$$\\forall 1\\leqslant i\\leqslant n\\;\\;f[1][i]=1$$\n\n$$\\text{nisc}(n,1)=\\sum\\limits_{i=1}^nf[1][i]=n$$\n\n$m=2$$j$$1,2,\\cdots,j$\n\n$$f[2][j]=\\sum\\limits_{k=1}^jf[1][k]$$\n\n\n\n$$f[i][j]=\\sum\\limits_{k=1}^jf[i-1][k]$$\n\n$$\\text{nisc}(n,m)=\\sum_{i=1}^nf[m][i]=f[m+1][n]$$\n\n$1$$m$$n$\n\n$$\\text{nisc}(n,m)=\\frac1{m!}\\prod\\limits_{i=1}^{m}(n+i-1)$$\n\nnaive$\\text{DP}$$g[i][j]$$[1,i]$$j$$j$$cnt_j$\n\n$$g[n][m]=\\sum\\limits_{i=m-1}^{n-1}g[i][m-1]\\text{nisc}(n-i,cnt_m)$$\n\n\n\n\n\n```plaintext\n3 3\n1 2 1\n```\n\n$4$$5$\n\n$[1,3]$$\\{[1,1],[2,3]\\}$$\\{[1,2],[3,3]\\}$$\\{\\{1,2,1\\},\\{1,3,1\\}\\}$$\\{\\{1,3,1\\},\\{1,3,2\\},\\{2,3,2\\}\\}$$\\{1,3,1\\}$\n","slug":"poisonous-problems","published":1,"updated":"2018-12-12T07:49:27.217Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzw000lgwguzdybljqc","content":"<p></p>\n<p><del></del></p>\n<a id=\"more\"></a>\n<h1 id=\"Problem-1\"><a href=\"#Problem-1\" class=\"headerlink\" title=\"Problem 1\"></a>Problem 1</h1><h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>$\\text{LIS()}$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}$</p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i\\leqslant n\\;\\; f_i=\\begin{cases}&1&(i=1\\vee \\forall 1\\leqslant j<i\\;\\; a_j\\geqslant a_i)\\\\&\\max\\limits_{1\\leqslant j<i\\wedge a_j<a_i}f_j+1&(\\text{Otherwise})\\\\\\end{cases}</script><p>$n$$\\{ f_n\\}$</p>\n<script type=\"math/tex; mode=display\">\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}\\wedge\\forall 1\\leqslant i\\leqslant n\\;\\; a_i\\in [1,m]\\cap\\mathbb{Z}</script><p>$\\{ a_n\\}$$998244353$</p>\n<h2 id=\"Solution\"><a href=\"#Solution\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><p></p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i<j\\leqslant n\\wedge f_i=f_j\\;\\;a_i\\geqslant a_j</script><script type=\"math/tex; mode=display\">\\forall 1\\leqslant i,j\\leqslant n\\wedge f_i<f_j\\;\\;a_i<a_j</script><p>$\\{ f_n\\}$$k$$x$$cnt_x$$[1,m]$$k$$[1,x_1],[x_1+1,x_2],\\cdots,[x_{k-1}+1,m]$$i$$cnt_i$</p>\n<p>$\\text{nisc}(\\text{Non-Increasing Sequence Count})(n,m)$$n$$m$</p>\n<p>$m=1$$f[i][j]$$m=i$$j$</p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i\\leqslant n\\;\\;f[1][i]=1</script><script type=\"math/tex; mode=display\">\\text{nisc}(n,1)=\\sum\\limits_{i=1}^nf[1][i]=n</script><p>$m=2$$j$$1,2,\\cdots,j$</p>\n<script type=\"math/tex; mode=display\">f[2][j]=\\sum\\limits_{k=1}^jf[1][k]</script><p></p>\n<script type=\"math/tex; mode=display\">f[i][j]=\\sum\\limits_{k=1}^jf[i-1][k]</script><script type=\"math/tex; mode=display\">\\text{nisc}(n,m)=\\sum_{i=1}^nf[m][i]=f[m+1][n]</script><p>$1$$m$$n$</p>\n<script type=\"math/tex; mode=display\">\\text{nisc}(n,m)=\\frac1{m!}\\prod\\limits_{i=1}^{m}(n+i-1)</script><p>naive$\\text{DP}$$g[i][j]$$[1,i]$$j$$j$$cnt_j$</p>\n<script type=\"math/tex; mode=display\">g[n][m]=\\sum\\limits_{i=m-1}^{n-1}g[i][m-1]\\text{nisc}(n-i,cnt_m)</script><p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3 3</span><br><span class=\"line\">1 2 1</span><br></pre></td></tr></table></figure>\n<p>$4$$5$</p>\n<p>$[1,3]$$\\{[1,1],[2,3]\\}$$\\{[1,2],[3,3]\\}$$\\{\\{1,2,1\\},\\{1,3,1\\}\\}$$\\{\\{1,3,1\\},\\{1,3,2\\},\\{2,3,2\\}\\}$$\\{1,3,1\\}$</p>\n","site":{"data":{}},"excerpt":"<p></p>\n<p><del></del></p>","more":"<h1 id=\"Problem-1\"><a href=\"#Problem-1\" class=\"headerlink\" title=\"Problem 1\"></a>Problem 1</h1><h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>$\\text{LIS()}$$\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}$</p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i\\leqslant n\\;\\; f_i=\\begin{cases}&1&(i=1\\vee \\forall 1\\leqslant j<i\\;\\; a_j\\geqslant a_i)\\\\&\\max\\limits_{1\\leqslant j<i\\wedge a_j<a_i}f_j+1&(\\text{Otherwise})\\\\\\end{cases}</script><p>$n$$\\{ f_n\\}$</p>\n<script type=\"math/tex; mode=display\">\\text{LIS}(\\{ a_n\\})=\\{ f_n\\}\\wedge\\forall 1\\leqslant i\\leqslant n\\;\\; a_i\\in [1,m]\\cap\\mathbb{Z}</script><p>$\\{ a_n\\}$$998244353$</p>\n<h2 id=\"Solution\"><a href=\"#Solution\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><p></p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i<j\\leqslant n\\wedge f_i=f_j\\;\\;a_i\\geqslant a_j</script><script type=\"math/tex; mode=display\">\\forall 1\\leqslant i,j\\leqslant n\\wedge f_i<f_j\\;\\;a_i<a_j</script><p>$\\{ f_n\\}$$k$$x$$cnt_x$$[1,m]$$k$$[1,x_1],[x_1+1,x_2],\\cdots,[x_{k-1}+1,m]$$i$$cnt_i$</p>\n<p>$\\text{nisc}(\\text{Non-Increasing Sequence Count})(n,m)$$n$$m$</p>\n<p>$m=1$$f[i][j]$$m=i$$j$</p>\n<script type=\"math/tex; mode=display\">\\forall 1\\leqslant i\\leqslant n\\;\\;f[1][i]=1</script><script type=\"math/tex; mode=display\">\\text{nisc}(n,1)=\\sum\\limits_{i=1}^nf[1][i]=n</script><p>$m=2$$j$$1,2,\\cdots,j$</p>\n<script type=\"math/tex; mode=display\">f[2][j]=\\sum\\limits_{k=1}^jf[1][k]</script><p></p>\n<script type=\"math/tex; mode=display\">f[i][j]=\\sum\\limits_{k=1}^jf[i-1][k]</script><script type=\"math/tex; mode=display\">\\text{nisc}(n,m)=\\sum_{i=1}^nf[m][i]=f[m+1][n]</script><p>$1$$m$$n$</p>\n<script type=\"math/tex; mode=display\">\\text{nisc}(n,m)=\\frac1{m!}\\prod\\limits_{i=1}^{m}(n+i-1)</script><p>naive$\\text{DP}$$g[i][j]$$[1,i]$$j$$j$$cnt_j$</p>\n<script type=\"math/tex; mode=display\">g[n][m]=\\sum\\limits_{i=m-1}^{n-1}g[i][m-1]\\text{nisc}(n-i,cnt_m)</script><p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3 3</span><br><span class=\"line\">1 2 1</span><br></pre></td></tr></table></figure>\n<p>$4$$5$</p>\n<p>$[1,3]$$\\{[1,1],[2,3]\\}$$\\{[1,2],[3,3]\\}$$\\{\\{1,2,1\\},\\{1,3,1\\}\\}$$\\{\\{1,3,1\\},\\{1,3,2\\},\\{2,3,2\\}\\}$$\\{1,3,1\\}$</p>"},{"title":"NOIp2018","date":"2018-11-09T01:40:45.000Z","mathjax":true,"_content":"~~~~\n\n<!-- more -->\n\n# Day 0\n\n\n\n![](https://i.loli.net/2018/11/09/5be4e6d8c122f.png)\n\nNOIp2018NOIp~~dalao~~yemdalao[NOIp2018~~~~](https://www.cnblogs.com/taduro/p/9933329.html)~~~~\n\n> dalaoblog\n> \n> Updated on 2018-11-12\n> \n> > Updated on 2018-11-14\n> > \n> > dalaoblog\n> > \n> > dalao\n\nCYYZ15\n\n`rp--`\n\nwzxdalaomhr\n\nrp\n\n\n\nWin7XPrp\n\nxjbstE\n\n\n\n10\n\n# Day 1\n\n.jpg\n\nE\n\nDay1\n\n830\n\n## [T1](https://www.luogu.org/problemnew/show/P5019)\n\n`score+=100`\n\n## [T2](https://www.luogu.org/problemnew/show/P5020)\n\n`score+=100`\n\n## [T3](https://www.luogu.org/problemnew/show/P5021)\n\n$m=1$205\n\n100+100+25=225\n\nNOIpCCF\n\nT355\n\n\n\n\n\n\n\n# Day 2\n\n\n\n\n\nDay2\n\n## [T1](https://www.luogu.org/problemnew/show/P5022)\n\nNOIpdfscrydalao$O(n)$\n\n`std::sort`\n\n\n\n## [T2](https://www.luogu.org/problemnew/show/P5023)\n\n$n=2$$n=3$$n=1$\n\n## [T3](https://www.luogu.org/problemnew/show/P5024)\n\nyyddp$O(nm)$44\n\n100+65+44=204\n\n100+100+25+100+65+44=434400\n\n\n\ndalao\n\n\n\n# Extra Notes\n\nNOIp\n\n~~~~\n\n> Updated on 2018-11-26\n> \n> \n> \n> \n> \n> 100+100+20+100+65+36=421\n> \n> ","source":"_posts/2018-11-09-noip-2018-notes.md","raw":"---\ntitle: NOIp2018\ndate: 2018-11-09 09:40:45\ntags:\n  - NOIp\n  - 2018\ncategories:\n  - \nmathjax: true\n---\n~~~~\n\n<!-- more -->\n\n# Day 0\n\n\n\n![](https://i.loli.net/2018/11/09/5be4e6d8c122f.png)\n\nNOIp2018NOIp~~dalao~~yemdalao[NOIp2018~~~~](https://www.cnblogs.com/taduro/p/9933329.html)~~~~\n\n> dalaoblog\n> \n> Updated on 2018-11-12\n> \n> > Updated on 2018-11-14\n> > \n> > dalaoblog\n> > \n> > dalao\n\nCYYZ15\n\n`rp--`\n\nwzxdalaomhr\n\nrp\n\n\n\nWin7XPrp\n\nxjbstE\n\n\n\n10\n\n# Day 1\n\n.jpg\n\nE\n\nDay1\n\n830\n\n## [T1](https://www.luogu.org/problemnew/show/P5019)\n\n`score+=100`\n\n## [T2](https://www.luogu.org/problemnew/show/P5020)\n\n`score+=100`\n\n## [T3](https://www.luogu.org/problemnew/show/P5021)\n\n$m=1$205\n\n100+100+25=225\n\nNOIpCCF\n\nT355\n\n\n\n\n\n\n\n# Day 2\n\n\n\n\n\nDay2\n\n## [T1](https://www.luogu.org/problemnew/show/P5022)\n\nNOIpdfscrydalao$O(n)$\n\n`std::sort`\n\n\n\n## [T2](https://www.luogu.org/problemnew/show/P5023)\n\n$n=2$$n=3$$n=1$\n\n## [T3](https://www.luogu.org/problemnew/show/P5024)\n\nyyddp$O(nm)$44\n\n100+65+44=204\n\n100+100+25+100+65+44=434400\n\n\n\ndalao\n\n\n\n# Extra Notes\n\nNOIp\n\n~~~~\n\n> Updated on 2018-11-26\n> \n> \n> \n> \n> \n> 100+100+20+100+65+36=421\n> \n> ","slug":"noip-2018-notes","published":1,"updated":"2018-12-19T12:05:09.580Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzx000mgwgunzpuh5x5","content":"<p><del></del></p>\n<a id=\"more\"></a>\n<h1 id=\"Day-0\"><a href=\"#Day-0\" class=\"headerlink\" title=\"Day 0\"></a>Day 0</h1><p></p>\n<p><img src=\"https://i.loli.net/2018/11/09/5be4e6d8c122f.png\" alt=\"\"></p>\n<p>NOIp2018NOIp<del>dalao</del>yemdalao<a href=\"https://www.cnblogs.com/taduro/p/9933329.html\" target=\"_blank\" rel=\"noopener\">NOIp2018<del></del></a><del></del></p>\n<blockquote>\n<p>dalaoblog</p>\n<p>Updated on 2018-11-12</p>\n<blockquote>\n<p>Updated on 2018-11-14</p>\n<p>dalaoblog</p>\n<p>dalao</p>\n</blockquote>\n</blockquote>\n<p>CYYZ15</p>\n<p><code>rp--</code></p>\n<p>wzxdalaomhr</p>\n<p>rp</p>\n<p></p>\n<p>Win7XPrp</p>\n<p>xjbstE</p>\n<p></p>\n<p>10</p>\n<h1 id=\"Day-1\"><a href=\"#Day-1\" class=\"headerlink\" title=\"Day 1\"></a>Day 1</h1><p>.jpg</p>\n<p>E</p>\n<p>Day1</p>\n<p>830</p>\n<h2 id=\"T1\"><a href=\"#T1\" class=\"headerlink\" title=\"T1\"></a><a href=\"https://www.luogu.org/problemnew/show/P5019\" target=\"_blank\" rel=\"noopener\">T1</a></h2><p><code>score+=100</code></p>\n<h2 id=\"T2\"><a href=\"#T2\" class=\"headerlink\" title=\"T2\"></a><a href=\"https://www.luogu.org/problemnew/show/P5020\" target=\"_blank\" rel=\"noopener\">T2</a></h2><p><code>score+=100</code></p>\n<h2 id=\"T3\"><a href=\"#T3\" class=\"headerlink\" title=\"T3\"></a><a href=\"https://www.luogu.org/problemnew/show/P5021\" target=\"_blank\" rel=\"noopener\">T3</a></h2><p>$m=1$205</p>\n<p>100+100+25=225</p>\n<p>NOIpCCF</p>\n<p>T355</p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"Day-2\"><a href=\"#Day-2\" class=\"headerlink\" title=\"Day 2\"></a>Day 2</h1><p></p>\n<p></p>\n<p>Day2</p>\n<h2 id=\"T1-1\"><a href=\"#T1-1\" class=\"headerlink\" title=\"T1\"></a><a href=\"https://www.luogu.org/problemnew/show/P5022\" target=\"_blank\" rel=\"noopener\">T1</a></h2><p>NOIpdfscrydalao$O(n)$</p>\n<p><code>std::sort</code></p>\n<p></p>\n<h2 id=\"T2-1\"><a href=\"#T2-1\" class=\"headerlink\" title=\"T2\"></a><a href=\"https://www.luogu.org/problemnew/show/P5023\" target=\"_blank\" rel=\"noopener\">T2</a></h2><p>$n=2$$n=3$$n=1$</p>\n<h2 id=\"T3-1\"><a href=\"#T3-1\" class=\"headerlink\" title=\"T3\"></a><a href=\"https://www.luogu.org/problemnew/show/P5024\" target=\"_blank\" rel=\"noopener\">T3</a></h2><p>yyddp$O(nm)$44</p>\n<p>100+65+44=204</p>\n<p>100+100+25+100+65+44=434400</p>\n<p></p>\n<p>dalao</p>\n<p></p>\n<h1 id=\"Extra-Notes\"><a href=\"#Extra-Notes\" class=\"headerlink\" title=\"Extra Notes\"></a>Extra Notes</h1><p>NOIp</p>\n<p><del></del></p>\n<blockquote>\n<p>Updated on 2018-11-26</p>\n<p></p>\n<p></p>\n<p>100+100+20+100+65+36=421</p>\n<p></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<p><del></del></p>","more":"<h1 id=\"Day-0\"><a href=\"#Day-0\" class=\"headerlink\" title=\"Day 0\"></a>Day 0</h1><p></p>\n<p><img src=\"https://i.loli.net/2018/11/09/5be4e6d8c122f.png\" alt=\"\"></p>\n<p>NOIp2018NOIp<del>dalao</del>yemdalao<a href=\"https://www.cnblogs.com/taduro/p/9933329.html\" target=\"_blank\" rel=\"noopener\">NOIp2018<del></del></a><del></del></p>\n<blockquote>\n<p>dalaoblog</p>\n<p>Updated on 2018-11-12</p>\n<blockquote>\n<p>Updated on 2018-11-14</p>\n<p>dalaoblog</p>\n<p>dalao</p>\n</blockquote>\n</blockquote>\n<p>CYYZ15</p>\n<p><code>rp--</code></p>\n<p>wzxdalaomhr</p>\n<p>rp</p>\n<p></p>\n<p>Win7XPrp</p>\n<p>xjbstE</p>\n<p></p>\n<p>10</p>\n<h1 id=\"Day-1\"><a href=\"#Day-1\" class=\"headerlink\" title=\"Day 1\"></a>Day 1</h1><p>.jpg</p>\n<p>E</p>\n<p>Day1</p>\n<p>830</p>\n<h2 id=\"T1\"><a href=\"#T1\" class=\"headerlink\" title=\"T1\"></a><a href=\"https://www.luogu.org/problemnew/show/P5019\" target=\"_blank\" rel=\"noopener\">T1</a></h2><p><code>score+=100</code></p>\n<h2 id=\"T2\"><a href=\"#T2\" class=\"headerlink\" title=\"T2\"></a><a href=\"https://www.luogu.org/problemnew/show/P5020\" target=\"_blank\" rel=\"noopener\">T2</a></h2><p><code>score+=100</code></p>\n<h2 id=\"T3\"><a href=\"#T3\" class=\"headerlink\" title=\"T3\"></a><a href=\"https://www.luogu.org/problemnew/show/P5021\" target=\"_blank\" rel=\"noopener\">T3</a></h2><p>$m=1$205</p>\n<p>100+100+25=225</p>\n<p>NOIpCCF</p>\n<p>T355</p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"Day-2\"><a href=\"#Day-2\" class=\"headerlink\" title=\"Day 2\"></a>Day 2</h1><p></p>\n<p></p>\n<p>Day2</p>\n<h2 id=\"T1-1\"><a href=\"#T1-1\" class=\"headerlink\" title=\"T1\"></a><a href=\"https://www.luogu.org/problemnew/show/P5022\" target=\"_blank\" rel=\"noopener\">T1</a></h2><p>NOIpdfscrydalao$O(n)$</p>\n<p><code>std::sort</code></p>\n<p></p>\n<h2 id=\"T2-1\"><a href=\"#T2-1\" class=\"headerlink\" title=\"T2\"></a><a href=\"https://www.luogu.org/problemnew/show/P5023\" target=\"_blank\" rel=\"noopener\">T2</a></h2><p>$n=2$$n=3$$n=1$</p>\n<h2 id=\"T3-1\"><a href=\"#T3-1\" class=\"headerlink\" title=\"T3\"></a><a href=\"https://www.luogu.org/problemnew/show/P5024\" target=\"_blank\" rel=\"noopener\">T3</a></h2><p>yyddp$O(nm)$44</p>\n<p>100+65+44=204</p>\n<p>100+100+25+100+65+44=434400</p>\n<p></p>\n<p>dalao</p>\n<p></p>\n<h1 id=\"Extra-Notes\"><a href=\"#Extra-Notes\" class=\"headerlink\" title=\"Extra Notes\"></a>Extra Notes</h1><p>NOIp</p>\n<p><del></del></p>\n<blockquote>\n<p>Updated on 2018-11-26</p>\n<p></p>\n<p></p>\n<p>100+100+20+100+65+36=421</p>\n<p></p>\n</blockquote>"},{"title":"","date":"2018-12-19T12:19:18.000Z","mathjax":true,"_content":"Ynoi\n\n<!-- more -->\n\n$n$$x$$y=\\cfrac{n}{x}$$\\text{A}x+\\text{B}y$\n\n$$\\cfrac{1}{2}(x+y)\\geqslant\\sqrt{xy}$$\n\n\n\n$$\\text{A}x+\\text{B}y\\geqslant2\\sqrt{\\text{AB}n}$$\n\n$x=\\sqrt{\\cfrac{\\text{B}}{\\text{A}}n}$$O(\\sqrt{\\text{AB}n})$\n\n","source":"_posts/2018-12-19-sqrt-decomposition-complexity-optimization.md","raw":"---\ntitle: \ndate: 2018-12-19 20:19:18\ntags:\n  - \ncategories:\n  - \nmathjax: true\n---\nYnoi\n\n<!-- more -->\n\n$n$$x$$y=\\cfrac{n}{x}$$\\text{A}x+\\text{B}y$\n\n$$\\cfrac{1}{2}(x+y)\\geqslant\\sqrt{xy}$$\n\n\n\n$$\\text{A}x+\\text{B}y\\geqslant2\\sqrt{\\text{AB}n}$$\n\n$x=\\sqrt{\\cfrac{\\text{B}}{\\text{A}}n}$$O(\\sqrt{\\text{AB}n})$\n\n","slug":"sqrt-decomposition-complexity-optimization","published":1,"updated":"2018-12-21T02:20:30.115Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzy000qgwguf3oc2uec","content":"<p>Ynoi</p>\n<a id=\"more\"></a>\n<p>$n$$x$$y=\\cfrac{n}{x}$$\\text{A}x+\\text{B}y$</p>\n<script type=\"math/tex; mode=display\">\\cfrac{1}{2}(x+y)\\geqslant\\sqrt{xy}</script><p></p>\n<script type=\"math/tex; mode=display\">\\text{A}x+\\text{B}y\\geqslant2\\sqrt{\\text{AB}n}</script><p>$x=\\sqrt{\\cfrac{\\text{B}}{\\text{A}}n}$$O(\\sqrt{\\text{AB}n})$</p>\n<p></p>\n","site":{"data":{}},"excerpt":"<p>Ynoi</p>","more":"<p>$n$$x$$y=\\cfrac{n}{x}$$\\text{A}x+\\text{B}y$</p>\n<script type=\"math/tex; mode=display\">\\cfrac{1}{2}(x+y)\\geqslant\\sqrt{xy}</script><p></p>\n<script type=\"math/tex; mode=display\">\\text{A}x+\\text{B}y\\geqslant2\\sqrt{\\text{AB}n}</script><p>$x=\\sqrt{\\cfrac{\\text{B}}{\\text{A}}n}$$O(\\sqrt{\\text{AB}n})$</p>\n<p></p>"},{"mathjax":true,"date":"2018-12-24T02:27:06.000Z","title":"","password":"qwijfpw49qg][pl}_,rp","abstract":"","message":"","_content":"\n\nsto __Juan\\_feng__ orz\n\n<!-- more -->\n\n[](https://www.luogu.org/problemnew/show/T64137)\n\n\n\n- \n- 59\n- 3~~~~\n\n\n\n\n\n$\\text{A}$$\\text{B}$\n\n$$O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})$$\n\n\n\n$$x=\\cfrac{n}{\\text{A}}\\;\\;y=\\cfrac{\\text{A}}{\\text{B}}\\;\\;z=\\text{B}$$\n\n$$xyz=n$$\n\n$$\\begin{cases}\n&x+y\\geqslant 2\\sqrt{xy}\\\\\n&y+z\\geqslant 2\\sqrt{yz}\\\\\n&x+z\\geqslant 2\\sqrt{xz}\n\\end{cases}$$\n\n\n\n$$x=y=z=n^{\\frac{1}{3}}$$\n\n\n\n$$\\text{A}=n^{\\frac{2}{3}}\\;\\;\\text{B}=n^{\\frac{1}{3}}$$\n\n$$O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})=O(n^{\\frac{1}{3}})$$\n\n\n\n---\n\n\n\n$O(\\sqrt{n})$$O(n^{\\frac{1}{3}})$$O(\\sqrt[3]{n})$$k$$O(n^{\\frac{1}{k+1}})$$k$$O(1)$\n\n\n\n---\n\n\n","source":"_posts/2018-12-24-block-decomposition.md","raw":"---\nmathjax: true\ndate: 2018-12-24 10:27:06\ntitle: \ntags:\n  - \n  - \ncategories:\n  - \npassword: qwijfpw49qg][pl}_,rp\nabstract: \nmessage: \n---\n\n\nsto __Juan\\_feng__ orz\n\n<!-- more -->\n\n[](https://www.luogu.org/problemnew/show/T64137)\n\n\n\n- \n- 59\n- 3~~~~\n\n\n\n\n\n$\\text{A}$$\\text{B}$\n\n$$O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})$$\n\n\n\n$$x=\\cfrac{n}{\\text{A}}\\;\\;y=\\cfrac{\\text{A}}{\\text{B}}\\;\\;z=\\text{B}$$\n\n$$xyz=n$$\n\n$$\\begin{cases}\n&x+y\\geqslant 2\\sqrt{xy}\\\\\n&y+z\\geqslant 2\\sqrt{yz}\\\\\n&x+z\\geqslant 2\\sqrt{xz}\n\\end{cases}$$\n\n\n\n$$x=y=z=n^{\\frac{1}{3}}$$\n\n\n\n$$\\text{A}=n^{\\frac{2}{3}}\\;\\;\\text{B}=n^{\\frac{1}{3}}$$\n\n$$O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})=O(n^{\\frac{1}{3}})$$\n\n\n\n---\n\n\n\n$O(\\sqrt{n})$$O(n^{\\frac{1}{3}})$$O(\\sqrt[3]{n})$$k$$O(n^{\\frac{1}{k+1}})$$k$$O(1)$\n\n\n\n---\n\n\n","slug":"block-decomposition","published":1,"updated":"2018-12-29T05:58:09.513Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921vzz000rgwguw929txh6","content":"<script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script>\n<div id=\"hbe-security\">\n  <div class=\"hbe-input-container\">\n  <input type=\"password\" class=\"hbe-form-control\" id=\"pass\" placeholder=\"\" />\n    <label for=\"pass\"></label>\n    <div class=\"bottom-line\"></div>\n  </div>\n</div>\n<div id=\"decryptionError\" style=\"display: none;\">Incorrect Password!</div>\n<div id=\"noContentError\" style=\"display: none;\">No content to display!</div>\n<div id=\"encrypt-blog\" style=\"display:none\">\nU2FsdGVkX19FMZcLUHUkTovLTVCkZzUp5bHudXca+1ACZbSzYAwvLUR87pr0IMY/G02JqVth9y6uPCKFeunY3URX1RxKaEBtOwBthBkjwFYD69crbV1foQ/2psiGkzRb211O2wyE6XfGUMmh2XAioz6EhhBpBEM5jZlHBPcTpFU76tIWDjERxQQMRGpb57Ym5g9FCkQwyquci2mZXvotk5Ew4Ohk1qjMqYDKM6/mpFyGSb/nlhrGgFcMlc+dYsFn7qVDfjFOkB6SZKW99ERbd4G4bBNqwIUixDJiq+i6N5TKSMjQK5vmkUeF0UH7yPJlgw9EyVuYVOw2wj1HXxhHhbl2rB4PGbe1VD+Pcxhq5lwLg0L3Hxjl8mPtHYJrmP8l8J7aa63d4eRHnsF3NMzDCu8YzoSKASpMHrUkcOdpGtHubaiuGFoPHl5wYLLizUaosb3FCBsrLKJRxnmmxrQfCkkTcG9nS4ZiN+pPAEefdiIklICQXmJfGTrH4uzRF2GvdOPtTWHS6aMXjltP9MOONvYF2VbQsoP1uTi4AEexHgpr92YpVqkcpMLzgXPIkoqFdJdWuqXXHER7raVOOl5I3rd+eEUdJQFrwkt/byYV22ixIO9y21mdgHv+JP+lbZjnFRO4L24XROKyDEPXMqRJr55DAf6tSsieZ38noaR9HOxmG04qnaGvijAg4q+EZQdzkPYl5bOQeLegtgdZIaMOO9HsXoWYFysQfC7D6bFQHRjcm9OwXOastwSc1rBc7+IFLDRyxeaPxBcDOSZCNBhdSLjGRQaaw8MmpZUMOE2Ug5lZV/FS1Ej6bBRVZRKnd7ItGjlzUwLArHDR22ZdsQs0VPRoJUCikoDpFVwPGn0naMT+0Y8dv6OmEgRE/EwoNqmEY/nt4j1Vss4pYjfT4d0gRDUvczXG+bp39vVA12jWQpcHE1sQFWNRvQG5oEhTQb9tIYQSZ0O/QyVN8rkfyY9q/gaKg0gVSFUskglPZ9xA8AyzXsccLGIb0zhP2wHGNn+FRZ8M6MquaWSCibt+kx69K0zMc6A0wvLovFswFAH5N1fAYmRuTgCrr+wnFXRJ0l6RKO9zt+1ATsruqmOyfgE6VVHm2pRfkZiak60S7UldUcLo+4zLPqiZodrHWPwHwZbVCE5LQh7VCWwVGtytDc8BmYBCT17PT6dEzofiiR0ZCy9SxpmugabErd7F4/aX3tLCn3oGE7nLTi3I03d//RYjLg/FvQDxCptDaTYJy/+ZWBR+iOhJ5bUoiKeBbAThizPiO8hW1RZCl5FPe0I9PaDVjRFfYNue8FbtxLeMhh0YxB5BpQE+fqsKn0BbkGg7rhQUnypkICL9+Sc8CQIfA/EbnSkOQ1v7tHXkX3f3Dg0cQ9Un5HQ0t+MEaIRRImBO+5zJOOJpKDOdzaI63nmUR04FhHj2DKj+SdWZynppW5lI9vP5CkfEPD/WpDKg6JASWaiM7SX6cumUj4PwrKLMaqICmeb30K4ElhIk/awmnxYWQIKW3LfhCJlx8pwWa7yXB0tmzx2oD/aEYgEezo8RAbC5ieqYXaouvT43ui2dKDIFAMl4RFzJDrk3w1TOydbDrPBy26GrsjcKrTtVYcg3m+0HGRcLgyiudCo/afc0txFjr0zhB376M1GDSedHMpyHaqzFhT6lwq+YwXH6MbS/7zgp6DfCGscH66XiB13BJY02E+MsumnqUm+Jq35rg0/ReCiQ/jC3IZlqdHXU3aTrqPsom5dumCaJWNhalKPURkZu9RPAWEJHhtECJJRjsUOvK/p/5UlQLREwMzjkzJpthLcDMKDBXVkNYa+G62gwRJQpCcNWeKTAzqyhQDZH5ReisYWz052osLRrMCFymGZ/ZtowtdBjGTFAfbSuQ8WSe3sdVYJYMHKNe1PPXm7B+LuFi5oalBTPDVtpN1bScoefWLr7TDEPDdZ3bY2q8kuphALRh3MWkyz98OuVFCa2SCUn0WRRgpIxQzPeCLLMWR85LFshe/s8Tq7XwJWKbUZZ3WlEZVObrAAPrN+LdEVfF0NjOmqVC/oyN8ILKcG+qU8iGFVSP6SWuJ8qryiJBTtKdRyAzbCC4UBgWyeE+JHDd4OoM5SkJHFETJYWkVDoGTyCNiXCjnPvCjB8uKsnWqp12uY5i4sAY11sA/ChAMBacCt5/6bQhs8elsX7em1Yuc2+nRDLimFWidLcZeN1Ub15L6o9dp+D9QwkOJSDTk/+7NFAt6/I6k9COR+NWGnesyyIxXyF/TnzpWAh8yl9PnxNGhaz2S1wJDNFbq2bygurObKNJC6PYUzYTgsshiOslh/xDiKnvgFFedoTvKg9ay3ThOcJfIFUty0S/Jm9413jo1gMbNOyIvND/zp+3F63+yKEFkQPtGaWDHZt9AglC7N1yMoBc8loJB82C6gVJdzmYcZQ+iJlh2360JfDTHDB6dhilrWSk8Ve96jngPrdcWl4DeaTaJJS3yNkKmc9T/01l+v3H8OlS+NtaijCeY5xDIHT7m5OcUUzBAlOSGtlO6W60WRHOrXfV2+x+H126BS3BL2bg5ibGj5v4OHNGKRFSLLYGgMm4fPvlEiZvbNnxcJnPw557L60SdVcwftb2F1GF4tCovLfGuZs6ipt6s3iRQVBMKRje80/CQIslEU1VVArr5rX2/D7rZGv81roB1AfOIGeFNh5rgbkjAVdpcMKS8j7KhvpMlO2zSMgD++AoAQyPkG2Pq/nm0jBVx6KW+CX29akGZJ/kyeq0YE4XE7KY6UvOrbwZpISrOUo5kQJITBWYt/rd14D9AE1x4bHB/z6beS5wWnEy4oPIrcvBQp8oo1aJPcjs/xYeWaBh7jgIQw5wD2Cgv7DL0sGT4cRrnc1k0EPVI/xumtdglWjOvWJPpeJwhoAuSMDfSzd/I7tDPrXb4VwQfRB2CIODa2hW8hDukhKGmKO2fow+GpC13bs++rpb5wpRzDcDNrEWw51raCwOb3dkt7B22GwqhtmYSooCLK26QCqbuxMUOnNEdeoQiPWKJBNBM7VBjZkUEzLqAS1nD2OwkjrwGlCSLYv1FsbUkVlKxXzdmDGzZGkT28Yqa0OUm7ruXMxipg7ujL8QWxmV8yHO5nnz4Ut18okHkIaIoUXWOpr+3G+A1128ft+XQjn+u98k9Pm4s/r2G2RSEr940XoFOiCI1WPYgLb5jjd4yKfgcbdM8o0r8rY6cYtB9bMaUJI39B3Bm18oc/nmgCVD0GyPFRpWtoNS1GunfRY7gTYNigPMRu6Yd8f1LKHteJtYcuIx+pN5uC7nD+fMsTQrncyBurHYIM8XLZSwjIeY6HlFgOEq9t0Juo0r3HB9PzsZSnAoyArLj5ZixpR+q/xCf3wr6pfMctynQ/8VKHB/FYZo/AJQkTRbw5l0fhQOUUmWf606tf8Rk4VkZGkXah9HD720Oadr1JfCSCIBQArFp+Uyqd+Ck/uFDsM9JSPAtIx1aj/uJk/zNP/mEp+yTvIjIoQ4J0wYVUqS7i6L+YsnkKYeC79Cln/j4/qAvtNiT4Ei2e2HLldQImeJglCZcvcgM1khrxMDxVmPd/lKn3WFrMncpnpsJrmxMBf0IM7m9ZjbGAnx7T/jMeFiYSLH26neSjSVowDG1f8R00w2T8EvTd/6pUp2bV1zYAGf7LSeDYprMke/18r11fZ74hXRjYkpKw1vSI9LNmiGbxjxH+CQyIuDOAlzUvHe0g27AMnUpZVDHXZGP06BK4qdCAq4HkuU0nDC96ppTIXTwyEqkk4KzqZC82g81k4EpI2MJnSFJXSIGnv4uKpeXHM4aOtvcnr6JvbedRWOmfrl4/mGP1CRFrIGrXRrLhySgqoeIzwlS9PETtXsv9IcuM9exnUWxRQwLCQBbMyU1e6R1qfwVkYVgya9xyI184W6/QuRb02ZRqrSHENqKqVHz/rmNAjvs7rEZvL/qMULYMK6nUZfsJ4ylOi+dj9IrzpGPReQt8sxNGs0XnS2BzBGDYBAW3a4eiiFAIyND2VzAogxCwH5PYTVAA34DVe7fLcyf6zmL1ewprz0/LDd2mn6i9nqf9N5oi/U+9a4uV6aE5z/FWClsuki0CXAt46awA05AXL65MU0oR82reMKw5Cna592YkKkjhcskkxypuMqvl7QtxTm+4rfWwTW0fEUzgQ8qTt5vC1DpJjSmu22bNTe3uKyWtOVwYfB6ZQGOWijQj6Rbwr7AhU3Izg9jsQRvRjTJs2Vdiq5oR1WyP6PQGGJf1v4RDGHWQR4jdBR4RfjMXid236ES0lnEXqC81XdC0tj52vQD7L+4WgkzBOr4bLfIkFB+cVXmLzKUfR1MlFz1jq1TzZxgr0GkBalLovmIWKCIs4wA98fyZHfs9OeNP1dylbigOLO5YXOaSyg2iWRxzAXeEbJ4PwnX3GDnodSeznB/U0lc9QKj/kFuveAgsDcasZZFahpYhsnSCSMiG+k16Zn468ie/hp7AqhU0CK6kJhQaEhtJjUVwttYPxR6hZpFGarGoPTD8Lnk4sGCZQXRKBgGC7TeaenF1dX0j5JP0R2fYzqln1XUmfHSrMSxs2F3D543QAkE2mrKkXnGLfOti/uDr9qvaMLrGxIVt09gOCDldQS3IA3QlX/71AF+TGLzFSVv5iV6A6w4AJF0weP9DrOGvuhcBAag1o/D4mzFI0hRcSBVlrVYPra6cGhX8F99DVRJe3SIVZzgMUn9jHOGqscl+rsijnLQlSnWWJRm8oABTBKZ/pQgkRftetiSgG9OS/KSDThe3sqr/se1CwP8tpC4ft/43aGfMJUuSAeglaJAcqwgTaM1r2zrDXUNvSPcIFIxSf1DrmhlbNXfWpOZUzVIKX9muyjbbQ1rzDMjDjjeMwqHeSAU0EqD6aSBHIyu7kTk59ZfmSK/tutmwp3rmwgQp3LsZrOhtJ/VvGKbTZBgBTToQspmyidixpDZYG/bSzy1F8DxkIuDDiKjCFj8lchUxMtbcUZ8laPM8gSg/DnPK43+oOhbq7oHRyrOUYA7jCfjHT53Ae6cjAS6zJSyVm+UPFAkdbpMJCR70RggIegf1EN1fskWeVQMmkEqSGY3JkPRtq5cH0oWHd33YkFgI+TQOw8W5IQKwbhWJQvxQzFqX7VcM1SVEPpukMzb8tuGKb8bCexyN1dmds8RJquY99XfP7sr7sq72b+ZMcOqv6VzwgwkybDbMXqfwKp8iTcJzrB2fjJYMHFquOBfQsyXs54m5C3zMtn4KnMKEMIb9hKgDANCWnAtFL0wvls/cUhozhc3ZsP/IeHkdOC1epPRP4jlddakbpBUKpDxCWo3Kbw1JqG3vfmUcC6O6lKWWJbiydn5APpNMLHcCrkO8LRVBKhsE6+oh7tLR3aFIbbuiqzUcHMZTgxHPpvKMo2Mp2QA8kkE/CL3U8pUjFzTrEniv60oIh+3XCNRcgYNW85r/9nPdm+Yzx8lsCJSuw50hv2YYoOuuHxm2liI4ibknykJ+9jGuEBD9KcPYT+qzXC7DiuEC1G1RFZSR057VHRQ5TeCHHiFqtgm7aOqnM6PhITyHrku9ctbMoGVqdrxBkkPE8qERipE6rprtYlHrGoD85ZysNsPaz0Rcr4dF0vXGvjgfs0fTBmfMz5kng+QmI6yuM5Zkf2FVbcbYEe2hIR7SLV74QFisaRcIY2CL+H809oK79WC+Y5tcfWVEp3gj4auELkFuHAKUihZVUvNk8uJP7cDpz7TXbn8jmELncxuQIambBmWAFosr+7clr+pl+TgdC/kMadAXss71CpqHZRU9dcP8phWBr8Ud6nP0fbBzmcTFvkN1lVtEl+QyZ6FdSmPAMP0Oxc34KSY40j6hOtL4UQSOoSKrOiylmSLkdMSMCiqrsfKNtnyhdmsAPiQmBNIu5zcnRtAtB5jw/lurOL8B6WGiAAPfNIijKb30ty0kIxj+jn5LjnedG3zZ5H9auUwC3xx9nG3ihiTzqKNYl1WJcsLZesX8dWoT0Z7vXzYNZ+nw8NVAOrzZHQfjmCPVv5Hkl/rGCKQ0CAwrQFl9fd7ReG7O0KkeYzODNRh86wtCsyQb+erMsafcowiYq0Vm6ZizF3mZMrXueDhr1lm7a0AgE6fs5fdzHuhuPsQGpFKUnYl7CrId79nEzheq1B4lgtPn0mbkJkF1AsMWjWJPSV2gr3ZaYaoSydkyFS/aiiSNc9r0WMtxPR1cCnzJ0v1yvhmcpLV3FxdQjx0oD+6SOHegzCT/DtKiBoRSc217eGJhJ6xUqzgfTKdzDxFG9ombFkyJhNIgqZ9lz1ucLtG1ZzU42AuAPcTU1Ec83RGiRTWUMrXhVNzsA+qGbXMo3htxzPhtkGT0Ev2emQ+zEiv0YYqO6T+F101w8Iify0ahBubaknv+aW9A+hz8SsZpqr0vgGWYHe51hHoOt1uq1lmsNc13rViZn5BFjK8FTyyiJ3LHAQWmtTkXDSmeyVwDp8L9JAdbEADL0fNxSxcGb0fh2xNI1IQmSB0f90IVS1aN3jHTWWHGS73R8OtaPNaRPSgNhcQEx4fOLUgbqTJiPJd9LcKxboX0sMYFLXuEAiX/HVpo6unsSBj7g+LOHQ4JvnpW2ROabn9bPRtNc5vRMWwR9WBYAng7YbkL1+c98JPBcxz/+VPkGKg+St+V3DrjhYfieH/NqNcHl6VER212vpTdudlFoWmZ3Hzx+X2WfNJOzsQY30Jhz1F2RsuT/gQaaJJY5VQK5jD0fycLeg3mnWWBojW31bd6XjR6cAflfYRQBn+Tm0YP0STI/N0d0kU3PWaH569Te7JI6ud8q0MaetfMq/MLPAfJ4cs4OXrXdwNUR46gYth1Ml/FhuILdy2NRanQ6Xby1BLhSii2t6jkguRgoAjztLVwJyGQ3EsTIz4ouo1EV4CdwRVzNX6oaX4VMSz4os/Ck7VtnmtCxrVlNzuEcynR3A9ZbpojRXADEXKyBMlxIRRnD0wVWJUf7vmWBltG3+wGuqHR1are4W6BrnxnxFKGq+sGvWcuoDWc4IwNErLu64SH94doKeElp+w6oBtn/py40dobf/us8kAvz5KuzmN8KdM4kWMHG+F3g1Rl4nN7lMQ5dAT74R4/f0mqKEJCgADKskswpMxP4L51NcCJ6v5xCYZ25lX5Z5RG9cIbQ3i0va+WX6h4sXTyiYUyKIymdpHwWuckU9Z4Z+fsgby9pDpTYkzcM8+Q+E0T+2yCApWxaI9GCBAXjft4nzK+sQc/eITWTpv+F5Dfotu8JHHxddD0SdN3NFVKCFnephopgsZeuByQiTiH29qQf6OmOGhr2SGiewEb20pBpi9LfmuiU1qSHLM/c2PEGLyJaBwiRxUb9X1TKIOnw6KuzF9dJZ83WhlYZpiitcGu3YdU1CT+AULgx7dmXi685kmJ4qlZHuLw=\n</div>\n<script src=\"/lib/crypto-js.js\"></script><script src=\"/lib/blog-encrypt.js\"></script><link href=\"/css/blog-encrypt.css\" rel=\"stylesheet\" type=\"text/css\">","site":{"data":{}},"excerpt":"","more":"","origin":"<p></p>\n<p>sto <strong>Juan_feng</strong> orz</p>\n<a id=\"more\"></a>\n<p><a href=\"https://www.luogu.org/problemnew/show/T64137\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<ul>\n<li></li>\n<li>59</li>\n<li>3<del></del></li>\n</ul>\n<p></p>\n<p></p>\n<p>$\\text{A}$$\\text{B}$</p>\n<script type=\"math/tex; mode=display\">O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})</script><p></p>\n<script type=\"math/tex; mode=display\">x=\\cfrac{n}{\\text{A}}\\;\\;y=\\cfrac{\\text{A}}{\\text{B}}\\;\\;z=\\text{B}</script><script type=\"math/tex; mode=display\">xyz=n</script><script type=\"math/tex; mode=display\">\\begin{cases}\n&x+y\\geqslant 2\\sqrt{xy}\\\\\n&y+z\\geqslant 2\\sqrt{yz}\\\\\n&x+z\\geqslant 2\\sqrt{xz}\n\\end{cases}</script><p></p>\n<script type=\"math/tex; mode=display\">x=y=z=n^{\\frac{1}{3}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\text{A}=n^{\\frac{2}{3}}\\;\\;\\text{B}=n^{\\frac{1}{3}}</script><script type=\"math/tex; mode=display\">O(\\cfrac{n}{\\text{A}}+\\cfrac{\\text{A}}{\\text{B}}+\\text{B})=O(n^{\\frac{1}{3}})</script><p></p>\n<hr>\n<p></p>\n<p>$O(\\sqrt{n})$$O(n^{\\frac{1}{3}})$$O(\\sqrt[3]{n})$$k$$O(n^{\\frac{1}{k+1}})$$k$$O(1)$</p>\n<p></p>\n<hr>\n<p></p>\n","encrypt":true,"template":"<script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script>\n<div id=\"hbe-security\">\n  <div class=\"hbe-input-container\">\n  <input type=\"password\" class=\"hbe-form-control\" id=\"pass\" placeholder=\"\" />\n    <label for=\"pass\"></label>\n    <div class=\"bottom-line\"></div>\n  </div>\n</div>\n<div id=\"decryptionError\" style=\"display: none;\">Incorrect Password!</div>\n<div id=\"noContentError\" style=\"display: none;\">No content to display!</div>\n<div id=\"encrypt-blog\" style=\"display:none\">\nU2FsdGVkX19FMZcLUHUkTovLTVCkZzUp5bHudXca+1ACZbSzYAwvLUR87pr0IMY/G02JqVth9y6uPCKFeunY3URX1RxKaEBtOwBthBkjwFYD69crbV1foQ/2psiGkzRb211O2wyE6XfGUMmh2XAioz6EhhBpBEM5jZlHBPcTpFU76tIWDjERxQQMRGpb57Ym5g9FCkQwyquci2mZXvotk5Ew4Ohk1qjMqYDKM6/mpFyGSb/nlhrGgFcMlc+dYsFn7qVDfjFOkB6SZKW99ERbd4G4bBNqwIUixDJiq+i6N5TKSMjQK5vmkUeF0UH7yPJlgw9EyVuYVOw2wj1HXxhHhbl2rB4PGbe1VD+Pcxhq5lwLg0L3Hxjl8mPtHYJrmP8l8J7aa63d4eRHnsF3NMzDCu8YzoSKASpMHrUkcOdpGtHubaiuGFoPHl5wYLLizUaosb3FCBsrLKJRxnmmxrQfCkkTcG9nS4ZiN+pPAEefdiIklICQXmJfGTrH4uzRF2GvdOPtTWHS6aMXjltP9MOONvYF2VbQsoP1uTi4AEexHgpr92YpVqkcpMLzgXPIkoqFdJdWuqXXHER7raVOOl5I3rd+eEUdJQFrwkt/byYV22ixIO9y21mdgHv+JP+lbZjnFRO4L24XROKyDEPXMqRJr55DAf6tSsieZ38noaR9HOxmG04qnaGvijAg4q+EZQdzkPYl5bOQeLegtgdZIaMOO9HsXoWYFysQfC7D6bFQHRjcm9OwXOastwSc1rBc7+IFLDRyxeaPxBcDOSZCNBhdSLjGRQaaw8MmpZUMOE2Ug5lZV/FS1Ej6bBRVZRKnd7ItGjlzUwLArHDR22ZdsQs0VPRoJUCikoDpFVwPGn0naMT+0Y8dv6OmEgRE/EwoNqmEY/nt4j1Vss4pYjfT4d0gRDUvczXG+bp39vVA12jWQpcHE1sQFWNRvQG5oEhTQb9tIYQSZ0O/QyVN8rkfyY9q/gaKg0gVSFUskglPZ9xA8AyzXsccLGIb0zhP2wHGNn+FRZ8M6MquaWSCibt+kx69K0zMc6A0wvLovFswFAH5N1fAYmRuTgCrr+wnFXRJ0l6RKO9zt+1ATsruqmOyfgE6VVHm2pRfkZiak60S7UldUcLo+4zLPqiZodrHWPwHwZbVCE5LQh7VCWwVGtytDc8BmYBCT17PT6dEzofiiR0ZCy9SxpmugabErd7F4/aX3tLCn3oGE7nLTi3I03d//RYjLg/FvQDxCptDaTYJy/+ZWBR+iOhJ5bUoiKeBbAThizPiO8hW1RZCl5FPe0I9PaDVjRFfYNue8FbtxLeMhh0YxB5BpQE+fqsKn0BbkGg7rhQUnypkICL9+Sc8CQIfA/EbnSkOQ1v7tHXkX3f3Dg0cQ9Un5HQ0t+MEaIRRImBO+5zJOOJpKDOdzaI63nmUR04FhHj2DKj+SdWZynppW5lI9vP5CkfEPD/WpDKg6JASWaiM7SX6cumUj4PwrKLMaqICmeb30K4ElhIk/awmnxYWQIKW3LfhCJlx8pwWa7yXB0tmzx2oD/aEYgEezo8RAbC5ieqYXaouvT43ui2dKDIFAMl4RFzJDrk3w1TOydbDrPBy26GrsjcKrTtVYcg3m+0HGRcLgyiudCo/afc0txFjr0zhB376M1GDSedHMpyHaqzFhT6lwq+YwXH6MbS/7zgp6DfCGscH66XiB13BJY02E+MsumnqUm+Jq35rg0/ReCiQ/jC3IZlqdHXU3aTrqPsom5dumCaJWNhalKPURkZu9RPAWEJHhtECJJRjsUOvK/p/5UlQLREwMzjkzJpthLcDMKDBXVkNYa+G62gwRJQpCcNWeKTAzqyhQDZH5ReisYWz052osLRrMCFymGZ/ZtowtdBjGTFAfbSuQ8WSe3sdVYJYMHKNe1PPXm7B+LuFi5oalBTPDVtpN1bScoefWLr7TDEPDdZ3bY2q8kuphALRh3MWkyz98OuVFCa2SCUn0WRRgpIxQzPeCLLMWR85LFshe/s8Tq7XwJWKbUZZ3WlEZVObrAAPrN+LdEVfF0NjOmqVC/oyN8ILKcG+qU8iGFVSP6SWuJ8qryiJBTtKdRyAzbCC4UBgWyeE+JHDd4OoM5SkJHFETJYWkVDoGTyCNiXCjnPvCjB8uKsnWqp12uY5i4sAY11sA/ChAMBacCt5/6bQhs8elsX7em1Yuc2+nRDLimFWidLcZeN1Ub15L6o9dp+D9QwkOJSDTk/+7NFAt6/I6k9COR+NWGnesyyIxXyF/TnzpWAh8yl9PnxNGhaz2S1wJDNFbq2bygurObKNJC6PYUzYTgsshiOslh/xDiKnvgFFedoTvKg9ay3ThOcJfIFUty0S/Jm9413jo1gMbNOyIvND/zp+3F63+yKEFkQPtGaWDHZt9AglC7N1yMoBc8loJB82C6gVJdzmYcZQ+iJlh2360JfDTHDB6dhilrWSk8Ve96jngPrdcWl4DeaTaJJS3yNkKmc9T/01l+v3H8OlS+NtaijCeY5xDIHT7m5OcUUzBAlOSGtlO6W60WRHOrXfV2+x+H126BS3BL2bg5ibGj5v4OHNGKRFSLLYGgMm4fPvlEiZvbNnxcJnPw557L60SdVcwftb2F1GF4tCovLfGuZs6ipt6s3iRQVBMKRje80/CQIslEU1VVArr5rX2/D7rZGv81roB1AfOIGeFNh5rgbkjAVdpcMKS8j7KhvpMlO2zSMgD++AoAQyPkG2Pq/nm0jBVx6KW+CX29akGZJ/kyeq0YE4XE7KY6UvOrbwZpISrOUo5kQJITBWYt/rd14D9AE1x4bHB/z6beS5wWnEy4oPIrcvBQp8oo1aJPcjs/xYeWaBh7jgIQw5wD2Cgv7DL0sGT4cRrnc1k0EPVI/xumtdglWjOvWJPpeJwhoAuSMDfSzd/I7tDPrXb4VwQfRB2CIODa2hW8hDukhKGmKO2fow+GpC13bs++rpb5wpRzDcDNrEWw51raCwOb3dkt7B22GwqhtmYSooCLK26QCqbuxMUOnNEdeoQiPWKJBNBM7VBjZkUEzLqAS1nD2OwkjrwGlCSLYv1FsbUkVlKxXzdmDGzZGkT28Yqa0OUm7ruXMxipg7ujL8QWxmV8yHO5nnz4Ut18okHkIaIoUXWOpr+3G+A1128ft+XQjn+u98k9Pm4s/r2G2RSEr940XoFOiCI1WPYgLb5jjd4yKfgcbdM8o0r8rY6cYtB9bMaUJI39B3Bm18oc/nmgCVD0GyPFRpWtoNS1GunfRY7gTYNigPMRu6Yd8f1LKHteJtYcuIx+pN5uC7nD+fMsTQrncyBurHYIM8XLZSwjIeY6HlFgOEq9t0Juo0r3HB9PzsZSnAoyArLj5ZixpR+q/xCf3wr6pfMctynQ/8VKHB/FYZo/AJQkTRbw5l0fhQOUUmWf606tf8Rk4VkZGkXah9HD720Oadr1JfCSCIBQArFp+Uyqd+Ck/uFDsM9JSPAtIx1aj/uJk/zNP/mEp+yTvIjIoQ4J0wYVUqS7i6L+YsnkKYeC79Cln/j4/qAvtNiT4Ei2e2HLldQImeJglCZcvcgM1khrxMDxVmPd/lKn3WFrMncpnpsJrmxMBf0IM7m9ZjbGAnx7T/jMeFiYSLH26neSjSVowDG1f8R00w2T8EvTd/6pUp2bV1zYAGf7LSeDYprMke/18r11fZ74hXRjYkpKw1vSI9LNmiGbxjxH+CQyIuDOAlzUvHe0g27AMnUpZVDHXZGP06BK4qdCAq4HkuU0nDC96ppTIXTwyEqkk4KzqZC82g81k4EpI2MJnSFJXSIGnv4uKpeXHM4aOtvcnr6JvbedRWOmfrl4/mGP1CRFrIGrXRrLhySgqoeIzwlS9PETtXsv9IcuM9exnUWxRQwLCQBbMyU1e6R1qfwVkYVgya9xyI184W6/QuRb02ZRqrSHENqKqVHz/rmNAjvs7rEZvL/qMULYMK6nUZfsJ4ylOi+dj9IrzpGPReQt8sxNGs0XnS2BzBGDYBAW3a4eiiFAIyND2VzAogxCwH5PYTVAA34DVe7fLcyf6zmL1ewprz0/LDd2mn6i9nqf9N5oi/U+9a4uV6aE5z/FWClsuki0CXAt46awA05AXL65MU0oR82reMKw5Cna592YkKkjhcskkxypuMqvl7QtxTm+4rfWwTW0fEUzgQ8qTt5vC1DpJjSmu22bNTe3uKyWtOVwYfB6ZQGOWijQj6Rbwr7AhU3Izg9jsQRvRjTJs2Vdiq5oR1WyP6PQGGJf1v4RDGHWQR4jdBR4RfjMXid236ES0lnEXqC81XdC0tj52vQD7L+4WgkzBOr4bLfIkFB+cVXmLzKUfR1MlFz1jq1TzZxgr0GkBalLovmIWKCIs4wA98fyZHfs9OeNP1dylbigOLO5YXOaSyg2iWRxzAXeEbJ4PwnX3GDnodSeznB/U0lc9QKj/kFuveAgsDcasZZFahpYhsnSCSMiG+k16Zn468ie/hp7AqhU0CK6kJhQaEhtJjUVwttYPxR6hZpFGarGoPTD8Lnk4sGCZQXRKBgGC7TeaenF1dX0j5JP0R2fYzqln1XUmfHSrMSxs2F3D543QAkE2mrKkXnGLfOti/uDr9qvaMLrGxIVt09gOCDldQS3IA3QlX/71AF+TGLzFSVv5iV6A6w4AJF0weP9DrOGvuhcBAag1o/D4mzFI0hRcSBVlrVYPra6cGhX8F99DVRJe3SIVZzgMUn9jHOGqscl+rsijnLQlSnWWJRm8oABTBKZ/pQgkRftetiSgG9OS/KSDThe3sqr/se1CwP8tpC4ft/43aGfMJUuSAeglaJAcqwgTaM1r2zrDXUNvSPcIFIxSf1DrmhlbNXfWpOZUzVIKX9muyjbbQ1rzDMjDjjeMwqHeSAU0EqD6aSBHIyu7kTk59ZfmSK/tutmwp3rmwgQp3LsZrOhtJ/VvGKbTZBgBTToQspmyidixpDZYG/bSzy1F8DxkIuDDiKjCFj8lchUxMtbcUZ8laPM8gSg/DnPK43+oOhbq7oHRyrOUYA7jCfjHT53Ae6cjAS6zJSyVm+UPFAkdbpMJCR70RggIegf1EN1fskWeVQMmkEqSGY3JkPRtq5cH0oWHd33YkFgI+TQOw8W5IQKwbhWJQvxQzFqX7VcM1SVEPpukMzb8tuGKb8bCexyN1dmds8RJquY99XfP7sr7sq72b+ZMcOqv6VzwgwkybDbMXqfwKp8iTcJzrB2fjJYMHFquOBfQsyXs54m5C3zMtn4KnMKEMIb9hKgDANCWnAtFL0wvls/cUhozhc3ZsP/IeHkdOC1epPRP4jlddakbpBUKpDxCWo3Kbw1JqG3vfmUcC6O6lKWWJbiydn5APpNMLHcCrkO8LRVBKhsE6+oh7tLR3aFIbbuiqzUcHMZTgxHPpvKMo2Mp2QA8kkE/CL3U8pUjFzTrEniv60oIh+3XCNRcgYNW85r/9nPdm+Yzx8lsCJSuw50hv2YYoOuuHxm2liI4ibknykJ+9jGuEBD9KcPYT+qzXC7DiuEC1G1RFZSR057VHRQ5TeCHHiFqtgm7aOqnM6PhITyHrku9ctbMoGVqdrxBkkPE8qERipE6rprtYlHrGoD85ZysNsPaz0Rcr4dF0vXGvjgfs0fTBmfMz5kng+QmI6yuM5Zkf2FVbcbYEe2hIR7SLV74QFisaRcIY2CL+H809oK79WC+Y5tcfWVEp3gj4auELkFuHAKUihZVUvNk8uJP7cDpz7TXbn8jmELncxuQIambBmWAFosr+7clr+pl+TgdC/kMadAXss71CpqHZRU9dcP8phWBr8Ud6nP0fbBzmcTFvkN1lVtEl+QyZ6FdSmPAMP0Oxc34KSY40j6hOtL4UQSOoSKrOiylmSLkdMSMCiqrsfKNtnyhdmsAPiQmBNIu5zcnRtAtB5jw/lurOL8B6WGiAAPfNIijKb30ty0kIxj+jn5LjnedG3zZ5H9auUwC3xx9nG3ihiTzqKNYl1WJcsLZesX8dWoT0Z7vXzYNZ+nw8NVAOrzZHQfjmCPVv5Hkl/rGCKQ0CAwrQFl9fd7ReG7O0KkeYzODNRh86wtCsyQb+erMsafcowiYq0Vm6ZizF3mZMrXueDhr1lm7a0AgE6fs5fdzHuhuPsQGpFKUnYl7CrId79nEzheq1B4lgtPn0mbkJkF1AsMWjWJPSV2gr3ZaYaoSydkyFS/aiiSNc9r0WMtxPR1cCnzJ0v1yvhmcpLV3FxdQjx0oD+6SOHegzCT/DtKiBoRSc217eGJhJ6xUqzgfTKdzDxFG9ombFkyJhNIgqZ9lz1ucLtG1ZzU42AuAPcTU1Ec83RGiRTWUMrXhVNzsA+qGbXMo3htxzPhtkGT0Ev2emQ+zEiv0YYqO6T+F101w8Iify0ahBubaknv+aW9A+hz8SsZpqr0vgGWYHe51hHoOt1uq1lmsNc13rViZn5BFjK8FTyyiJ3LHAQWmtTkXDSmeyVwDp8L9JAdbEADL0fNxSxcGb0fh2xNI1IQmSB0f90IVS1aN3jHTWWHGS73R8OtaPNaRPSgNhcQEx4fOLUgbqTJiPJd9LcKxboX0sMYFLXuEAiX/HVpo6unsSBj7g+LOHQ4JvnpW2ROabn9bPRtNc5vRMWwR9WBYAng7YbkL1+c98JPBcxz/+VPkGKg+St+V3DrjhYfieH/NqNcHl6VER212vpTdudlFoWmZ3Hzx+X2WfNJOzsQY30Jhz1F2RsuT/gQaaJJY5VQK5jD0fycLeg3mnWWBojW31bd6XjR6cAflfYRQBn+Tm0YP0STI/N0d0kU3PWaH569Te7JI6ud8q0MaetfMq/MLPAfJ4cs4OXrXdwNUR46gYth1Ml/FhuILdy2NRanQ6Xby1BLhSii2t6jkguRgoAjztLVwJyGQ3EsTIz4ouo1EV4CdwRVzNX6oaX4VMSz4os/Ck7VtnmtCxrVlNzuEcynR3A9ZbpojRXADEXKyBMlxIRRnD0wVWJUf7vmWBltG3+wGuqHR1are4W6BrnxnxFKGq+sGvWcuoDWc4IwNErLu64SH94doKeElp+w6oBtn/py40dobf/us8kAvz5KuzmN8KdM4kWMHG+F3g1Rl4nN7lMQ5dAT74R4/f0mqKEJCgADKskswpMxP4L51NcCJ6v5xCYZ25lX5Z5RG9cIbQ3i0va+WX6h4sXTyiYUyKIymdpHwWuckU9Z4Z+fsgby9pDpTYkzcM8+Q+E0T+2yCApWxaI9GCBAXjft4nzK+sQc/eITWTpv+F5Dfotu8JHHxddD0SdN3NFVKCFnephopgsZeuByQiTiH29qQf6OmOGhr2SGiewEb20pBpi9LfmuiU1qSHLM/c2PEGLyJaBwiRxUb9X1TKIOnw6KuzF9dJZ83WhlYZpiitcGu3YdU1CT+AULgx7dmXi685kmJ4qlZHuLw=\n</div>\n","decryptionError":"Incorrect Password!","noContentError":"No content to display!"},{"title":"","date":"2018-10-13T13:13:09.000Z","mathjax":true,"_content":"~~NOIp~~\n\n~~3~~\n\n\n\n<!--more -->\n\n~~~~[CF896CWillem, Chtholly and Seniorious](http://codeforces.com/contest/896/problem/C)\n\n~~~~$10^{9}$\n\nOld Driver TreeODTChtholly Tree`std::set`~~~~\n\n> \n\n\n\n\n\n```cpp\nstruct node{\n    int l,r;\n    mutable long long val;\n    //mutableval\n\n    node(int _l,int _r=-1,long long _val=-1){\n    //_r_val-1split\n        l=_l;\n        r=_r;\n        val=_val;\n    }\n};\nstd::set<node> s;\n\ninline bool operator<(node p,node q){\n    return p.l<q.l;\n}\n```\n\n\n\n```cpp\nfor(re int i=1;i<=n;++i)\n    s.insert(node(i,i,rnd()%maxval+1));\n```\n\n\n\n\n\n~~~~\n\n```cpp\nstd::<set>::iterator split(int pos)\n```\n\n`pos`\n\n```cpp\n#define _it std::set<node>::iterator\n//\ninline _it split(int pos){\n    _it it=std::lower_bound(s.begin(),s.end(),node(pos));\n    //pos\n    if(it!=s.end()&&it->l==pos)\n        return it;\n    //possplit\n    --it;\n    //pospos\n    int l=it->l,r=it->r;\n    long long val=it->val;\n    s.erase(it);\n    s.insert(node(l,pos-1,val));\n    return s.insert(node(pos,r,val)).first;\n    //[l,r][l,pos)[pos,r]\n}\n```\n\n\n\n`insert``std::pair<std::_Rb_tree_const_iterator<node>,bool>`~~~~`.first`\n\n`std::set`$O(\\operatorname{log}n)$\n\n\n\n```cpp\nvoid assign(int l,int r,int x)\n```\n\n$[l,r]$$x$\n\n```cpp\ninline void assign(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    //split(r+1)split(l)lr+1\n    //split(r+1)~~~~l\n    s.erase(itl,itr);\n    //[itl,itr)\n    s.insert(node(l,r,x));\n    //\n}\n```\n\n\n\n\n\n`assign``set`$\\operatorname{log}n$`assign(l,r,x)`\n\n~~~~\n\n\n\n```cpp\ninline void IntervalAdd(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    for(re _it p=itl;p!=itr;++p)\n        p->val+=x;\n}\n```\n\n\n\n\n\n`std::sort`\n\n```cpp\ninline long long IntervalXth(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    vec.clear();\n    for(re _it p=itl;p!=itr;++p)\n        vec.push_back(std::make_pair(p->val,p->r-p->l+1));\n    std::sort(vec.begin(),vec.end());\n    for(re unsigned i=0;i<vec.size();++i){\n        x-=vec[i].second;\n        if(x<=0)\n            return vec[i].first;\n    }\n    return 0;\n}\n```\n\n\n\n```cpp\ninline int IntervalXpow(int l,int r,int x,int y){\n    _it itr=split(r+1),itl=split(l);\n    int res=0;\n    for(re _it p=itl;p!=itr;++p)\n        res=(1LL*res+1LL*(p->r-p->l+1)*cltpow(p->val%y,x,y)%y)%y;\n    return res;\n}\n```\n\n\n\nCodeForces\n\n![](https://i.loli.net/2018/10/14/5bc28b1443ea5.png)\n\n~~~~\n\n![](https://i.loli.net/2018/10/14/5bc28c7ecfe96.png)\n\n![](https://i.loli.net/2018/10/14/5bc28bc4eed79.jpg)\n\n.jpg\n\n[CF915EPhysical Education Lessons](http://codeforces.com/contest/915/problem/E)\n\n![](https://i.loli.net/2018/10/14/5bc297890bbc6.png)\n\n> Updated on 2018-11-01\n> \n> \n> \n> \n\n\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<set>\n#define re register\n#define maxn 100000\n#define _it std::set<node>::iterator\n\nnamespace cltstream{\n    #ifdef ONLINE_JUDGE\n        #define size 1048576\n        char str[size+1],*head=str,*tail=str;\n        inline char gc(){\n            if(head==tail){\n                tail=(head=str)+fread(str,1,size,stdin);\n                if(head==tail)\n                    return EOF;\n            }\n            return *head++;\n        }\n        #undef size\n    #else\n        #define gc getchar\n    #endif\n\n    template <typename _tp>\n    inline void read(_tp& x){\n        int sn=1;\n        char c=gc();\n        for(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n        if(c==45&&c!=EOF)\n            sn=-1,c=gc();\n        for(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n        x*=sn;\n    }\n\n    template <typename _tp>\n    inline void write(_tp x,char text=' '){\n        if(x<0)\n            putchar(45),x=-x;\n        if(!x)\n            putchar(48);\n        else{\n            int digit[20];\n            for(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n            for(;digit[0];putchar(digit[digit[0]--]^48));\n        }\n        putchar(text);\n    }\n}\n\nint n,m,seed,maxval;\nstruct node{\n    int l,r;\n    mutable long long val;\n\n    node(int _l,int _r=-1,long long _val=-1){\n        l=_l;\n        r=_r;\n        val=_val;\n    }\n};\nstd::set<node> s;\nstd::vector<std::pair<long long,int> > vec;\n\ninline int rnd(){\n    int res=seed;\n    seed=(7LL*seed+13)%1000000007;\n    return res;\n}\n\ninline void swap(int& l,int& r){\n    int tmp=l;\n    l=r;\n    r=tmp;\n}\n\nint cltpow(int x,int y,int mod){\n    if(y==1)\n        return x;\n    int res=cltpow(x,y>>1,mod);\n    res=1LL*res*res%mod;\n    if(y&1)\n        res=1LL*res*x%mod;\n    return res;\n}\n\ninline bool operator<(node p,node q){\n    return p.l<q.l;\n}\n\ninline _it split(int pos){\n    _it it=std::lower_bound(s.begin(),s.end(),node(pos));\n    if(it!=s.end()&&it->l==pos)\n        return it;\n    --it;\n    int l=it->l,r=it->r;\n    long long val=it->val;\n    s.erase(it);\n    s.insert(node(l,pos-1,val));\n    return s.insert(node(pos,r,val)).first;\n}\n\ninline void IntervalAdd(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    for(re _it p=itl;p!=itr;++p)\n        p->val+=x;\n}\n\ninline void IntervalAssign(int l,int r,int x){\n//assign\n    _it itr=split(r+1),itl=split(l);\n    s.erase(itl,itr);\n    s.insert(node(l,r,x));\n}\n\ninline long long IntervalXth(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    vec.clear();\n    for(re _it p=itl;p!=itr;++p)\n        vec.push_back(std::make_pair(p->val,p->r-p->l+1));\n    std::sort(vec.begin(),vec.end());\n    for(re unsigned i=0;i<vec.size();++i){\n        x-=vec[i].second;\n        if(x<=0)\n            return vec[i].first;\n    }\n    return 0;\n}\n\ninline int IntervalXpow(int l,int r,int x,int y){\n    _it itr=split(r+1),itl=split(l);\n    int res=0;\n    for(re _it p=itl;p!=itr;++p)\n        res=(1LL*res+1LL*(p->r-p->l+1)*cltpow(p->val%y,x,y)%y)%y;\n    return res;\n}\n\nint main(){\n    cltstream::read(n);\n    cltstream::read(m);\n    cltstream::read(seed);\n    cltstream::read(maxval);\n    for(re int i=1;i<=n;++i)\n        s.insert(node(i,i,rnd()%maxval+1));\n    for(re int i=1;i<=m;++i){\n        int opt=rnd()%4+1,l=rnd()%n+1,r=rnd()%n+1,x,y;\n        if(l>r)\n            swap(l,r);\n        switch(opt){\n            case 1:\n                x=rnd()%maxval+1;\n                IntervalAdd(l,r,x);\n                break;\n            case 2:\n                x=rnd()%maxval+1;\n                IntervalAssign(l,r,x);\n                break;\n            case 3:\n                x=rnd()%(r-l+1)+1;\n                cltstream::write(IntervalXth(l,r,x),'\\n');\n                break;\n            case 4:\n                x=rnd()%maxval+1;\n                y=rnd()%maxval+1;\n                cltstream::write(IntervalXpow(l,r,x,y),'\\n');\n                break;\n        }\n    }\n    return 0;\n}\n```\n\n\n","source":"_posts/2018-10-13-chtholly-tree-learning-notes.md","raw":"---\ntitle: \ndate: 2018-10-13 21:13:09\ntags:\n  - \ncategories:\n  - \nmathjax: true\n---\n~~NOIp~~\n\n~~3~~\n\n\n\n<!--more -->\n\n~~~~[CF896CWillem, Chtholly and Seniorious](http://codeforces.com/contest/896/problem/C)\n\n~~~~$10^{9}$\n\nOld Driver TreeODTChtholly Tree`std::set`~~~~\n\n> \n\n\n\n\n\n```cpp\nstruct node{\n    int l,r;\n    mutable long long val;\n    //mutableval\n\n    node(int _l,int _r=-1,long long _val=-1){\n    //_r_val-1split\n        l=_l;\n        r=_r;\n        val=_val;\n    }\n};\nstd::set<node> s;\n\ninline bool operator<(node p,node q){\n    return p.l<q.l;\n}\n```\n\n\n\n```cpp\nfor(re int i=1;i<=n;++i)\n    s.insert(node(i,i,rnd()%maxval+1));\n```\n\n\n\n\n\n~~~~\n\n```cpp\nstd::<set>::iterator split(int pos)\n```\n\n`pos`\n\n```cpp\n#define _it std::set<node>::iterator\n//\ninline _it split(int pos){\n    _it it=std::lower_bound(s.begin(),s.end(),node(pos));\n    //pos\n    if(it!=s.end()&&it->l==pos)\n        return it;\n    //possplit\n    --it;\n    //pospos\n    int l=it->l,r=it->r;\n    long long val=it->val;\n    s.erase(it);\n    s.insert(node(l,pos-1,val));\n    return s.insert(node(pos,r,val)).first;\n    //[l,r][l,pos)[pos,r]\n}\n```\n\n\n\n`insert``std::pair<std::_Rb_tree_const_iterator<node>,bool>`~~~~`.first`\n\n`std::set`$O(\\operatorname{log}n)$\n\n\n\n```cpp\nvoid assign(int l,int r,int x)\n```\n\n$[l,r]$$x$\n\n```cpp\ninline void assign(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    //split(r+1)split(l)lr+1\n    //split(r+1)~~~~l\n    s.erase(itl,itr);\n    //[itl,itr)\n    s.insert(node(l,r,x));\n    //\n}\n```\n\n\n\n\n\n`assign``set`$\\operatorname{log}n$`assign(l,r,x)`\n\n~~~~\n\n\n\n```cpp\ninline void IntervalAdd(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    for(re _it p=itl;p!=itr;++p)\n        p->val+=x;\n}\n```\n\n\n\n\n\n`std::sort`\n\n```cpp\ninline long long IntervalXth(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    vec.clear();\n    for(re _it p=itl;p!=itr;++p)\n        vec.push_back(std::make_pair(p->val,p->r-p->l+1));\n    std::sort(vec.begin(),vec.end());\n    for(re unsigned i=0;i<vec.size();++i){\n        x-=vec[i].second;\n        if(x<=0)\n            return vec[i].first;\n    }\n    return 0;\n}\n```\n\n\n\n```cpp\ninline int IntervalXpow(int l,int r,int x,int y){\n    _it itr=split(r+1),itl=split(l);\n    int res=0;\n    for(re _it p=itl;p!=itr;++p)\n        res=(1LL*res+1LL*(p->r-p->l+1)*cltpow(p->val%y,x,y)%y)%y;\n    return res;\n}\n```\n\n\n\nCodeForces\n\n![](https://i.loli.net/2018/10/14/5bc28b1443ea5.png)\n\n~~~~\n\n![](https://i.loli.net/2018/10/14/5bc28c7ecfe96.png)\n\n![](https://i.loli.net/2018/10/14/5bc28bc4eed79.jpg)\n\n.jpg\n\n[CF915EPhysical Education Lessons](http://codeforces.com/contest/915/problem/E)\n\n![](https://i.loli.net/2018/10/14/5bc297890bbc6.png)\n\n> Updated on 2018-11-01\n> \n> \n> \n> \n\n\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<set>\n#define re register\n#define maxn 100000\n#define _it std::set<node>::iterator\n\nnamespace cltstream{\n    #ifdef ONLINE_JUDGE\n        #define size 1048576\n        char str[size+1],*head=str,*tail=str;\n        inline char gc(){\n            if(head==tail){\n                tail=(head=str)+fread(str,1,size,stdin);\n                if(head==tail)\n                    return EOF;\n            }\n            return *head++;\n        }\n        #undef size\n    #else\n        #define gc getchar\n    #endif\n\n    template <typename _tp>\n    inline void read(_tp& x){\n        int sn=1;\n        char c=gc();\n        for(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n        if(c==45&&c!=EOF)\n            sn=-1,c=gc();\n        for(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n        x*=sn;\n    }\n\n    template <typename _tp>\n    inline void write(_tp x,char text=' '){\n        if(x<0)\n            putchar(45),x=-x;\n        if(!x)\n            putchar(48);\n        else{\n            int digit[20];\n            for(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n            for(;digit[0];putchar(digit[digit[0]--]^48));\n        }\n        putchar(text);\n    }\n}\n\nint n,m,seed,maxval;\nstruct node{\n    int l,r;\n    mutable long long val;\n\n    node(int _l,int _r=-1,long long _val=-1){\n        l=_l;\n        r=_r;\n        val=_val;\n    }\n};\nstd::set<node> s;\nstd::vector<std::pair<long long,int> > vec;\n\ninline int rnd(){\n    int res=seed;\n    seed=(7LL*seed+13)%1000000007;\n    return res;\n}\n\ninline void swap(int& l,int& r){\n    int tmp=l;\n    l=r;\n    r=tmp;\n}\n\nint cltpow(int x,int y,int mod){\n    if(y==1)\n        return x;\n    int res=cltpow(x,y>>1,mod);\n    res=1LL*res*res%mod;\n    if(y&1)\n        res=1LL*res*x%mod;\n    return res;\n}\n\ninline bool operator<(node p,node q){\n    return p.l<q.l;\n}\n\ninline _it split(int pos){\n    _it it=std::lower_bound(s.begin(),s.end(),node(pos));\n    if(it!=s.end()&&it->l==pos)\n        return it;\n    --it;\n    int l=it->l,r=it->r;\n    long long val=it->val;\n    s.erase(it);\n    s.insert(node(l,pos-1,val));\n    return s.insert(node(pos,r,val)).first;\n}\n\ninline void IntervalAdd(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    for(re _it p=itl;p!=itr;++p)\n        p->val+=x;\n}\n\ninline void IntervalAssign(int l,int r,int x){\n//assign\n    _it itr=split(r+1),itl=split(l);\n    s.erase(itl,itr);\n    s.insert(node(l,r,x));\n}\n\ninline long long IntervalXth(int l,int r,int x){\n    _it itr=split(r+1),itl=split(l);\n    vec.clear();\n    for(re _it p=itl;p!=itr;++p)\n        vec.push_back(std::make_pair(p->val,p->r-p->l+1));\n    std::sort(vec.begin(),vec.end());\n    for(re unsigned i=0;i<vec.size();++i){\n        x-=vec[i].second;\n        if(x<=0)\n            return vec[i].first;\n    }\n    return 0;\n}\n\ninline int IntervalXpow(int l,int r,int x,int y){\n    _it itr=split(r+1),itl=split(l);\n    int res=0;\n    for(re _it p=itl;p!=itr;++p)\n        res=(1LL*res+1LL*(p->r-p->l+1)*cltpow(p->val%y,x,y)%y)%y;\n    return res;\n}\n\nint main(){\n    cltstream::read(n);\n    cltstream::read(m);\n    cltstream::read(seed);\n    cltstream::read(maxval);\n    for(re int i=1;i<=n;++i)\n        s.insert(node(i,i,rnd()%maxval+1));\n    for(re int i=1;i<=m;++i){\n        int opt=rnd()%4+1,l=rnd()%n+1,r=rnd()%n+1,x,y;\n        if(l>r)\n            swap(l,r);\n        switch(opt){\n            case 1:\n                x=rnd()%maxval+1;\n                IntervalAdd(l,r,x);\n                break;\n            case 2:\n                x=rnd()%maxval+1;\n                IntervalAssign(l,r,x);\n                break;\n            case 3:\n                x=rnd()%(r-l+1)+1;\n                cltstream::write(IntervalXth(l,r,x),'\\n');\n                break;\n            case 4:\n                x=rnd()%maxval+1;\n                y=rnd()%maxval+1;\n                cltstream::write(IntervalXpow(l,r,x,y),'\\n');\n                break;\n        }\n    }\n    return 0;\n}\n```\n\n\n","slug":"chtholly-tree-learning-notes","published":1,"updated":"2018-12-19T12:03:00.539Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w3a0029gwguxpqzfbxb","content":"<p><del>NOIp</del></p>\n<p><del>3</del></p>\n<p></p>\n<a id=\"more\"></a>\n<p><del></del><a href=\"http://codeforces.com/contest/896/problem/C\" target=\"_blank\" rel=\"noopener\">CF896CWillem, Chtholly and Seniorious</a></p>\n<p><del></del>$10^{9}$</p>\n<p>Old Driver TreeODTChtholly Tree<code>std::set</code><del></del></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l,r;</span><br><span class=\"line\">    <span class=\"keyword\">mutable</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val;</span><br><span class=\"line\">    <span class=\"comment\">//mutableval</span></span><br><span class=\"line\"></span><br><span class=\"line\">    node(<span class=\"keyword\">int</span> _l,<span class=\"keyword\">int</span> _r=<span class=\"number\">-1</span>,<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> _val=<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">    <span class=\"comment\">//_r_val-1split</span></span><br><span class=\"line\">        l=_l;</span><br><span class=\"line\">        r=_r;</span><br><span class=\"line\">        val=_val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;node&gt; s;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>&lt;(node p,node q)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.l&lt;q.l;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">    s.insert(node(i,i,rnd()%maxval+<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><del></del></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">std</span>::&lt;<span class=\"built_in\">set</span>&gt;::<span class=\"function\">iterator <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span></span><br></pre></td></tr></table></figure>\n<p><code>pos</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> _it std::set<span class=\"meta-string\">&lt;node&gt;::iterator</span></span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">inline</span> _<span class=\"function\">it <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span>&#123;</span><br><span class=\"line\">    _it it=<span class=\"built_in\">std</span>::lower_bound(s.begin(),s.end(),node(pos));</span><br><span class=\"line\">    <span class=\"comment\">//pos</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(it!=s.end()&amp;&amp;it-&gt;l==pos)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> it;</span><br><span class=\"line\">    <span class=\"comment\">//possplit</span></span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    <span class=\"comment\">//pospos</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l=it-&gt;l,r=it-&gt;r;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val=it-&gt;val;</span><br><span class=\"line\">    s.erase(it);</span><br><span class=\"line\">    s.insert(node(l,pos<span class=\"number\">-1</span>,val));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.insert(node(pos,r,val)).first;</span><br><span class=\"line\">    <span class=\"comment\">//[l,r][l,pos)[pos,r]</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>insert</code><code>std::pair&lt;std::_Rb_tree_const_iterator&lt;node&gt;,bool&gt;</code><del></del><code>.first</code></p>\n<p><code>std::set</code>$O(\\operatorname{log}n)$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">assign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span></span><br></pre></td></tr></table></figure>\n<p>$[l,r]$$x$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">assign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"comment\">//split(r+1)split(l)lr+1</span></span><br><span class=\"line\">    <span class=\"comment\">//split(r+1)~~~~l</span></span><br><span class=\"line\">    s.erase(itl,itr);</span><br><span class=\"line\">    <span class=\"comment\">//[itl,itr)</span></span><br><span class=\"line\">    s.insert(node(l,r,x));</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><code>assign</code><code>set</code>$\\operatorname{log}n$<code>assign(l,r,x)</code></p>\n<p><del></del></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        p-&gt;val+=x;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><code>std::sort</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">IntervalXth</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    vec.clear();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        vec.push_back(<span class=\"built_in\">std</span>::make_pair(p-&gt;val,p-&gt;r-p-&gt;l+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::sort(vec.begin(),vec.end());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">unsigned</span> i=<span class=\"number\">0</span>;i&lt;vec.size();++i)&#123;</span><br><span class=\"line\">        x-=vec[i].second;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> vec[i].first;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">IntervalXpow</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        res=(<span class=\"number\">1L</span>L*res+<span class=\"number\">1L</span>L*(p-&gt;r-p-&gt;l+<span class=\"number\">1</span>)*cltpow(p-&gt;val%y,x,y)%y)%y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>CodeForces</p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28b1443ea5.png\" alt=\"\"></p>\n<p><del></del></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28c7ecfe96.png\" alt=\"\"></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28bc4eed79.jpg\" alt=\"\"></p>\n<p>.jpg</p>\n<p><a href=\"http://codeforces.com/contest/915/problem/E\" target=\"_blank\" rel=\"noopener\">CF915EPhysical Education Lessons</a></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc297890bbc6.png\" alt=\"\"></p>\n<blockquote>\n<p>Updated on 2018-11-01</p>\n<p></p>\n<p></p>\n</blockquote>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;set&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> _it std::set<span class=\"meta-string\">&lt;node&gt;::iterator</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">        <span class=\"keyword\">char</span> str[size+<span class=\"number\">1</span>],*head=str,*tail=str;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(head==tail)&#123;</span><br><span class=\"line\">                tail=(head=str)+fread(str,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(head==tail)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *head++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc getchar</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">            sn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">        x*=sn;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"string\">' '</span>)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"built_in\">putchar</span>(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">            <span class=\"built_in\">putchar</span>(<span class=\"number\">48</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> digit[<span class=\"number\">20</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];<span class=\"built_in\">putchar</span>(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">putchar</span>(text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,seed,maxval;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l,r;</span><br><span class=\"line\">    <span class=\"keyword\">mutable</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val;</span><br><span class=\"line\"></span><br><span class=\"line\">    node(<span class=\"keyword\">int</span> _l,<span class=\"keyword\">int</span> _r=<span class=\"number\">-1</span>,<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> _val=<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">        l=_l;</span><br><span class=\"line\">        r=_r;</span><br><span class=\"line\">        val=_val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;node&gt; s;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">std</span>::pair&lt;<span class=\"keyword\">long</span> <span class=\"keyword\">long</span>,<span class=\"keyword\">int</span>&gt; &gt; vec;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=seed;</span><br><span class=\"line\">    seed=(<span class=\"number\">7L</span>L*seed+<span class=\"number\">13</span>)%<span class=\"number\">1000000007</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; l,<span class=\"keyword\">int</span>&amp; r)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tmp=l;</span><br><span class=\"line\">    l=r;</span><br><span class=\"line\">    r=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y,<span class=\"keyword\">int</span> mod)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(y==<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=cltpow(x,y&gt;&gt;<span class=\"number\">1</span>,mod);</span><br><span class=\"line\">    res=<span class=\"number\">1L</span>L*res*res%mod;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">        res=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>&lt;(node p,node q)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.l&lt;q.l;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> _<span class=\"function\">it <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span>&#123;</span><br><span class=\"line\">    _it it=<span class=\"built_in\">std</span>::lower_bound(s.begin(),s.end(),node(pos));</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(it!=s.end()&amp;&amp;it-&gt;l==pos)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> it;</span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> l=it-&gt;l,r=it-&gt;r;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val=it-&gt;val;</span><br><span class=\"line\">    s.erase(it);</span><br><span class=\"line\">    s.insert(node(l,pos<span class=\"number\">-1</span>,val));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.insert(node(pos,r,val)).first;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        p-&gt;val+=x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAssign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\"><span class=\"comment\">//assign</span></span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    s.erase(itl,itr);</span><br><span class=\"line\">    s.insert(node(l,r,x));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">IntervalXth</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    vec.clear();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        vec.push_back(<span class=\"built_in\">std</span>::make_pair(p-&gt;val,p-&gt;r-p-&gt;l+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::sort(vec.begin(),vec.end());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">unsigned</span> i=<span class=\"number\">0</span>;i&lt;vec.size();++i)&#123;</span><br><span class=\"line\">        x-=vec[i].second;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> vec[i].first;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">IntervalXpow</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        res=(<span class=\"number\">1L</span>L*res+<span class=\"number\">1L</span>L*(p-&gt;r-p-&gt;l+<span class=\"number\">1</span>)*cltpow(p-&gt;val%y,x,y)%y)%y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cltstream::read(n);</span><br><span class=\"line\">    cltstream::read(m);</span><br><span class=\"line\">    cltstream::read(seed);</span><br><span class=\"line\">    cltstream::read(maxval);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        s.insert(node(i,i,rnd()%maxval+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> opt=rnd()%<span class=\"number\">4</span>+<span class=\"number\">1</span>,l=rnd()%n+<span class=\"number\">1</span>,r=rnd()%n+<span class=\"number\">1</span>,x,y;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l&gt;r)</span><br><span class=\"line\">            swap(l,r);</span><br><span class=\"line\">        <span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                IntervalAdd(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                IntervalAssign(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">                x=rnd()%(r-l+<span class=\"number\">1</span>)+<span class=\"number\">1</span>;</span><br><span class=\"line\">                cltstream::write(IntervalXth(l,r,x),<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                y=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                cltstream::write(IntervalXpow(l,r,x,y),<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n","site":{"data":{}},"excerpt":"<p><del>NOIp</del></p>\n<p><del>3</del></p>\n<p></p>","more":"<p><del></del><a href=\"http://codeforces.com/contest/896/problem/C\" target=\"_blank\" rel=\"noopener\">CF896CWillem, Chtholly and Seniorious</a></p>\n<p><del></del>$10^{9}$</p>\n<p>Old Driver TreeODTChtholly Tree<code>std::set</code><del></del></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l,r;</span><br><span class=\"line\">    <span class=\"keyword\">mutable</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val;</span><br><span class=\"line\">    <span class=\"comment\">//mutableval</span></span><br><span class=\"line\"></span><br><span class=\"line\">    node(<span class=\"keyword\">int</span> _l,<span class=\"keyword\">int</span> _r=<span class=\"number\">-1</span>,<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> _val=<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">    <span class=\"comment\">//_r_val-1split</span></span><br><span class=\"line\">        l=_l;</span><br><span class=\"line\">        r=_r;</span><br><span class=\"line\">        val=_val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;node&gt; s;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>&lt;(node p,node q)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.l&lt;q.l;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">    s.insert(node(i,i,rnd()%maxval+<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><del></del></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">std</span>::&lt;<span class=\"built_in\">set</span>&gt;::<span class=\"function\">iterator <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span></span><br></pre></td></tr></table></figure>\n<p><code>pos</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> _it std::set<span class=\"meta-string\">&lt;node&gt;::iterator</span></span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">inline</span> _<span class=\"function\">it <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span>&#123;</span><br><span class=\"line\">    _it it=<span class=\"built_in\">std</span>::lower_bound(s.begin(),s.end(),node(pos));</span><br><span class=\"line\">    <span class=\"comment\">//pos</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(it!=s.end()&amp;&amp;it-&gt;l==pos)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> it;</span><br><span class=\"line\">    <span class=\"comment\">//possplit</span></span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    <span class=\"comment\">//pospos</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l=it-&gt;l,r=it-&gt;r;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val=it-&gt;val;</span><br><span class=\"line\">    s.erase(it);</span><br><span class=\"line\">    s.insert(node(l,pos<span class=\"number\">-1</span>,val));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.insert(node(pos,r,val)).first;</span><br><span class=\"line\">    <span class=\"comment\">//[l,r][l,pos)[pos,r]</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>insert</code><code>std::pair&lt;std::_Rb_tree_const_iterator&lt;node&gt;,bool&gt;</code><del></del><code>.first</code></p>\n<p><code>std::set</code>$O(\\operatorname{log}n)$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">assign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span></span><br></pre></td></tr></table></figure>\n<p>$[l,r]$$x$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">assign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"comment\">//split(r+1)split(l)lr+1</span></span><br><span class=\"line\">    <span class=\"comment\">//split(r+1)~~~~l</span></span><br><span class=\"line\">    s.erase(itl,itr);</span><br><span class=\"line\">    <span class=\"comment\">//[itl,itr)</span></span><br><span class=\"line\">    s.insert(node(l,r,x));</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><code>assign</code><code>set</code>$\\operatorname{log}n$<code>assign(l,r,x)</code></p>\n<p><del></del></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        p-&gt;val+=x;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><code>std::sort</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">IntervalXth</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    vec.clear();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        vec.push_back(<span class=\"built_in\">std</span>::make_pair(p-&gt;val,p-&gt;r-p-&gt;l+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::sort(vec.begin(),vec.end());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">unsigned</span> i=<span class=\"number\">0</span>;i&lt;vec.size();++i)&#123;</span><br><span class=\"line\">        x-=vec[i].second;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> vec[i].first;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">IntervalXpow</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        res=(<span class=\"number\">1L</span>L*res+<span class=\"number\">1L</span>L*(p-&gt;r-p-&gt;l+<span class=\"number\">1</span>)*cltpow(p-&gt;val%y,x,y)%y)%y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>CodeForces</p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28b1443ea5.png\" alt=\"\"></p>\n<p><del></del></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28c7ecfe96.png\" alt=\"\"></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc28bc4eed79.jpg\" alt=\"\"></p>\n<p>.jpg</p>\n<p><a href=\"http://codeforces.com/contest/915/problem/E\" target=\"_blank\" rel=\"noopener\">CF915EPhysical Education Lessons</a></p>\n<p><img src=\"https://i.loli.net/2018/10/14/5bc297890bbc6.png\" alt=\"\"></p>\n<blockquote>\n<p>Updated on 2018-11-01</p>\n<p></p>\n<p></p>\n</blockquote>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;set&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> _it std::set<span class=\"meta-string\">&lt;node&gt;::iterator</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">        <span class=\"keyword\">char</span> str[size+<span class=\"number\">1</span>],*head=str,*tail=str;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(head==tail)&#123;</span><br><span class=\"line\">                tail=(head=str)+fread(str,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(head==tail)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *head++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc getchar</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">            sn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">        x*=sn;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"string\">' '</span>)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"built_in\">putchar</span>(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">            <span class=\"built_in\">putchar</span>(<span class=\"number\">48</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> digit[<span class=\"number\">20</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];<span class=\"built_in\">putchar</span>(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">putchar</span>(text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,seed,maxval;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span>&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> l,r;</span><br><span class=\"line\">    <span class=\"keyword\">mutable</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val;</span><br><span class=\"line\"></span><br><span class=\"line\">    node(<span class=\"keyword\">int</span> _l,<span class=\"keyword\">int</span> _r=<span class=\"number\">-1</span>,<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> _val=<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">        l=_l;</span><br><span class=\"line\">        r=_r;</span><br><span class=\"line\">        val=_val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;node&gt; s;</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">std</span>::pair&lt;<span class=\"keyword\">long</span> <span class=\"keyword\">long</span>,<span class=\"keyword\">int</span>&gt; &gt; vec;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=seed;</span><br><span class=\"line\">    seed=(<span class=\"number\">7L</span>L*seed+<span class=\"number\">13</span>)%<span class=\"number\">1000000007</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; l,<span class=\"keyword\">int</span>&amp; r)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tmp=l;</span><br><span class=\"line\">    l=r;</span><br><span class=\"line\">    r=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y,<span class=\"keyword\">int</span> mod)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(y==<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=cltpow(x,y&gt;&gt;<span class=\"number\">1</span>,mod);</span><br><span class=\"line\">    res=<span class=\"number\">1L</span>L*res*res%mod;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">        res=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>&lt;(node p,node q)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.l&lt;q.l;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> _<span class=\"function\">it <span class=\"title\">split</span><span class=\"params\">(<span class=\"keyword\">int</span> pos)</span></span>&#123;</span><br><span class=\"line\">    _it it=<span class=\"built_in\">std</span>::lower_bound(s.begin(),s.end(),node(pos));</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(it!=s.end()&amp;&amp;it-&gt;l==pos)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> it;</span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> l=it-&gt;l,r=it-&gt;r;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> val=it-&gt;val;</span><br><span class=\"line\">    s.erase(it);</span><br><span class=\"line\">    s.insert(node(l,pos<span class=\"number\">-1</span>,val));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.insert(node(pos,r,val)).first;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        p-&gt;val+=x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAssign</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\"><span class=\"comment\">//assign</span></span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    s.erase(itl,itr);</span><br><span class=\"line\">    s.insert(node(l,r,x));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">IntervalXth</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    vec.clear();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        vec.push_back(<span class=\"built_in\">std</span>::make_pair(p-&gt;val,p-&gt;r-p-&gt;l+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::sort(vec.begin(),vec.end());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">unsigned</span> i=<span class=\"number\">0</span>;i&lt;vec.size();++i)&#123;</span><br><span class=\"line\">        x-=vec[i].second;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> vec[i].first;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">IntervalXpow</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    _it itr=split(r+<span class=\"number\">1</span>),itl=split(l);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re _it p=itl;p!=itr;++p)</span><br><span class=\"line\">        res=(<span class=\"number\">1L</span>L*res+<span class=\"number\">1L</span>L*(p-&gt;r-p-&gt;l+<span class=\"number\">1</span>)*cltpow(p-&gt;val%y,x,y)%y)%y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cltstream::read(n);</span><br><span class=\"line\">    cltstream::read(m);</span><br><span class=\"line\">    cltstream::read(seed);</span><br><span class=\"line\">    cltstream::read(maxval);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        s.insert(node(i,i,rnd()%maxval+<span class=\"number\">1</span>));</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> opt=rnd()%<span class=\"number\">4</span>+<span class=\"number\">1</span>,l=rnd()%n+<span class=\"number\">1</span>,r=rnd()%n+<span class=\"number\">1</span>,x,y;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l&gt;r)</span><br><span class=\"line\">            swap(l,r);</span><br><span class=\"line\">        <span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                IntervalAdd(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                IntervalAssign(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">                x=rnd()%(r-l+<span class=\"number\">1</span>)+<span class=\"number\">1</span>;</span><br><span class=\"line\">                cltstream::write(IntervalXth(l,r,x),<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">                x=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                y=rnd()%maxval+<span class=\"number\">1</span>;</span><br><span class=\"line\">                cltstream::write(IntervalXpow(l,r,x,y),<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>"},{"title":"Episode I","date":"2018-12-08T11:55:00.000Z","mathjax":true,"_content":"\n\n<!-- more -->\n\n\n\n[![](https://i.loli.net/2018/12/08/5c0bb272768cf.png)](https://www.luogu.org/record/show?rid=14518116)\n\n![](https://i.loli.net/2018/12/08/5c0bb2c767fda.jpg)\n\n\n\n$3$\n\n$O(n\\operatorname{log}n)$\n\n$O(n\\operatorname{log}n)$$O(\\operatorname{log}n)$$O(\\operatorname{log}^{2}n)$\n\n\n\n~~~~\n\n`std::set`$3$$O(\\operatorname{log}\\sqrt{n})$$1$$4$$5$$O(\\sqrt{n}\\operatorname{log}\\sqrt{n})$$2$$k$$O(\\operatorname{log}10^{9}\\sqrt{n}\\operatorname{log}\\sqrt{n})$\n\n\n\n[__Shadowice1984__](https://www.luogu.org/space/show?uid=56384)dalao[](https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p4119)\n\n> $O(\\operatorname{log}n)$$\\text{log}$\n> \n> $O(\\sqrt{n})$$O(\\operatorname{log}n)$$\\text{log}$$\\text{log}$$\\text{log}$\n\ndalao[blog](https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p3380)\n\n$\\text{log}$\n\n`cnt1[i][j]`$i$$j$`cnt2[i][j]`$i$$j$$O((n+m)\\sqrt{n})$\n\n\n\n1. \n2. `tmp1``tmp2`\n3. $O(\\sqrt{n})$`cnt`\n4. $2$________\n5. $4$\n\n$O((n+m)\\sqrt{n}+m\\sqrt{n+m})$$n$$m$$38172068$$O(m\\operatorname{log}^{2}n)\\approx 12183043$$\\text{O}2$\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define re register\n#define maxn 50000\n#define maxm 50000\n#define maxs 230\n#define max(a,b) ((a)>=(b)?(a):(b))\n#define min(a,b) ((a)<=(b)?(a):(b))\n#define lowbit(a) ((a)&(-(a)))\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m,sq1,sq2;\nint id1[maxn+1],id2[maxn+maxm+1],p[maxn+maxm+1];\nint a[maxn+1],opt[maxm+1][4];\nint cnt1[maxs+1][(maxs<<1)+1],cnt2[maxs+1][maxn+maxm+1],tmp1[(maxs<<1)+1],tmp2[maxn+maxm+1];\n\nint main(){\n\tcltstream::read(n);\n\tcltstream::read(m);\n\tfor(;(sq1+1)*(sq1+1)<=n;++sq1);\n\tfor(re int i=1;i<=n;++i){\n\t\tid1[i]=(i-1)/sq1+1;\n\t\tcltstream::read(a[i]);\n\t\tp[++p[0]]=a[i];\n\t}\n\tfor(re int i=1;i<=m;++i){\n\t\tcltstream::read(opt[i][0]);\n\t\tcltstream::read(opt[i][1]);\n\t\tcltstream::read(opt[i][2]);\n\t\tif(opt[i][0]!=3)\n\t\t\tcltstream::read(opt[i][3]);\n\t\telse\n\t\t\tp[++p[0]]=opt[i][2];\n\t}\n\tstd::sort(p+1,p+p[0]+1);\n\tp[0]=std::unique(p+1,p+p[0]+1)-p-1;\n\tfor(;(sq2+1)*(sq2+1)<=p[0];++sq2);\n\tfor(re int i=1;i<=p[0];++i)\n\t\tid2[i]=(i-1)/sq2+1;\n\tfor(re int i=1;i<=n;++i){\n\t\ta[i]=std::lower_bound(p+1,p+p[0]+1,a[i])-p;\n\t\t++cnt1[id1[i]][id2[a[i]]];\n\t\t++cnt2[id1[i]][a[i]];\n\t}\n\tfor(re int i=1;i<=id1[n];++i){\n\t\tfor(re int j=1;j<=id2[p[0]];++j)\n\t\t\tcnt1[i][j]+=cnt1[i-1][j];\n\t\tfor(re int j=1;j<=p[0];++j)\n\t\t\tcnt2[i][j]+=cnt2[i-1][j];\n\t}\n\tfor(re int i=1;i<=m;++i){\n\t\tre int l,r,x,ans=0;\n\t\tswitch(opt[i][0]){\n\t\t\tcase 1:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::lower_bound(p+1,p+p[0]+1,opt[i][3])-p;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\t\tfor(re int j=1;j<id2[x];++j)\n\t\t\t\t\t\tans+=cnt1[id1[r]-1][j]-cnt1[id1[l]][j];\n\t\t\t\t\tfor(re int j=(id2[x]-1)*sq2+1;j<x;++j)\n\t\t\t\t\t\tans+=cnt2[id1[r]-1][j]-cnt2[id1[l]][j];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tfor(re int j=l;j<=r;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\tcltstream::write(ans+1,10);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=opt[i][3];\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=1;;++j)\n\t\t\t\t\t\tif(x>cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tx-=cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j];\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2;++k)\n\t\t\t\t\t\t\t\tif(x>cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tx-=cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k];\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tcltstream::write(p[k],10);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=1;;++j)\n\t\t\t\t\t\tif(x>tmp1[j])\n\t\t\t\t\t\t\tx-=tmp1[j];\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2;++k)\n\t\t\t\t\t\t\t\tif(x>tmp2[k])\n\t\t\t\t\t\t\t\t\tx-=tmp2[k];\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tcltstream::write(p[k],10);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tl=opt[i][1],x=std::lower_bound(p+1,p+p[0]+1,opt[i][2])-p;\n\t\t\t\tfor(re int j=id1[l];j<=id1[n];++j){\n\t\t\t\t\t--cnt1[j][id2[a[l]]];\n\t\t\t\t\t++cnt1[j][id2[x]];\n\t\t\t\t\t--cnt2[j][a[l]];\n\t\t\t\t\t++cnt2[j][x];\n\t\t\t\t}\n\t\t\t\ta[l]=x;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::lower_bound(p+1,p+p[0]+1,opt[i][3])-p;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x-1;j>=(id2[x]-1)*sq2+1&&!ans;--j)\n\t\t\t\t\t\tif(cnt2[id1[r]-1][j]-cnt2[id1[l]][j]+tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]-1;j>=1&&!ans;--j)\n\t\t\t\t\t\tif(cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=j*sq2;k>=(j-1)*sq2+1&&!ans;--k)\n\t\t\t\t\t\t\t\tif(cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x-1;j>=(id2[x]-1)*sq2+1&&!ans;--j)\n\t\t\t\t\t\tif(tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]-1;j>=1&&!ans;--j)\n\t\t\t\t\t\tif(tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=j*sq2;k>=(j-1)*sq2+1&&!ans;--k)\n\t\t\t\t\t\t\t\tif(tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcltstream::write(ans?p[ans]:-2147483647,10);\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::upper_bound(p+1,p+p[0]+1,opt[i][3])-p-1;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x+1;j<=id2[x]*sq2&&!ans;++j)\n\t\t\t\t\t\tif(cnt2[id1[r]-1][j]-cnt2[id1[l]][j]+tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]+1;j<=id2[p[0]]&&!ans;++j)\n\t\t\t\t\t\tif(cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2&&!ans;++k)\n\t\t\t\t\t\t\t\tif(cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x+1;j<=id2[x]*sq2&&!ans;++j)\n\t\t\t\t\t\tif(tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]+1;j<=id2[p[0]]&&!ans;++j)\n\t\t\t\t\t\tif(tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2&&!ans;++k)\n\t\t\t\t\t\t\t\tif(tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcltstream::write(ans?p[ans]:2147483647,10);\n\t\t}\n\t}\n\tclop();\n\treturn 0;\n}\n```\n\n$12\\text{KB}$\n\nFuture AlgorithmEpisode II","source":"_posts/2018-12-08-future-algorithm-ep1.md","raw":"---\ntitle: Episode I\ndate: 2018-12-08 19:55:00\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n\n\n<!-- more -->\n\n\n\n[![](https://i.loli.net/2018/12/08/5c0bb272768cf.png)](https://www.luogu.org/record/show?rid=14518116)\n\n![](https://i.loli.net/2018/12/08/5c0bb2c767fda.jpg)\n\n\n\n$3$\n\n$O(n\\operatorname{log}n)$\n\n$O(n\\operatorname{log}n)$$O(\\operatorname{log}n)$$O(\\operatorname{log}^{2}n)$\n\n\n\n~~~~\n\n`std::set`$3$$O(\\operatorname{log}\\sqrt{n})$$1$$4$$5$$O(\\sqrt{n}\\operatorname{log}\\sqrt{n})$$2$$k$$O(\\operatorname{log}10^{9}\\sqrt{n}\\operatorname{log}\\sqrt{n})$\n\n\n\n[__Shadowice1984__](https://www.luogu.org/space/show?uid=56384)dalao[](https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p4119)\n\n> $O(\\operatorname{log}n)$$\\text{log}$\n> \n> $O(\\sqrt{n})$$O(\\operatorname{log}n)$$\\text{log}$$\\text{log}$$\\text{log}$\n\ndalao[blog](https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p3380)\n\n$\\text{log}$\n\n`cnt1[i][j]`$i$$j$`cnt2[i][j]`$i$$j$$O((n+m)\\sqrt{n})$\n\n\n\n1. \n2. `tmp1``tmp2`\n3. $O(\\sqrt{n})$`cnt`\n4. $2$________\n5. $4$\n\n$O((n+m)\\sqrt{n}+m\\sqrt{n+m})$$n$$m$$38172068$$O(m\\operatorname{log}^{2}n)\\approx 12183043$$\\text{O}2$\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define re register\n#define maxn 50000\n#define maxm 50000\n#define maxs 230\n#define max(a,b) ((a)>=(b)?(a):(b))\n#define min(a,b) ((a)<=(b)?(a):(b))\n#define lowbit(a) ((a)&(-(a)))\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m,sq1,sq2;\nint id1[maxn+1],id2[maxn+maxm+1],p[maxn+maxm+1];\nint a[maxn+1],opt[maxm+1][4];\nint cnt1[maxs+1][(maxs<<1)+1],cnt2[maxs+1][maxn+maxm+1],tmp1[(maxs<<1)+1],tmp2[maxn+maxm+1];\n\nint main(){\n\tcltstream::read(n);\n\tcltstream::read(m);\n\tfor(;(sq1+1)*(sq1+1)<=n;++sq1);\n\tfor(re int i=1;i<=n;++i){\n\t\tid1[i]=(i-1)/sq1+1;\n\t\tcltstream::read(a[i]);\n\t\tp[++p[0]]=a[i];\n\t}\n\tfor(re int i=1;i<=m;++i){\n\t\tcltstream::read(opt[i][0]);\n\t\tcltstream::read(opt[i][1]);\n\t\tcltstream::read(opt[i][2]);\n\t\tif(opt[i][0]!=3)\n\t\t\tcltstream::read(opt[i][3]);\n\t\telse\n\t\t\tp[++p[0]]=opt[i][2];\n\t}\n\tstd::sort(p+1,p+p[0]+1);\n\tp[0]=std::unique(p+1,p+p[0]+1)-p-1;\n\tfor(;(sq2+1)*(sq2+1)<=p[0];++sq2);\n\tfor(re int i=1;i<=p[0];++i)\n\t\tid2[i]=(i-1)/sq2+1;\n\tfor(re int i=1;i<=n;++i){\n\t\ta[i]=std::lower_bound(p+1,p+p[0]+1,a[i])-p;\n\t\t++cnt1[id1[i]][id2[a[i]]];\n\t\t++cnt2[id1[i]][a[i]];\n\t}\n\tfor(re int i=1;i<=id1[n];++i){\n\t\tfor(re int j=1;j<=id2[p[0]];++j)\n\t\t\tcnt1[i][j]+=cnt1[i-1][j];\n\t\tfor(re int j=1;j<=p[0];++j)\n\t\t\tcnt2[i][j]+=cnt2[i-1][j];\n\t}\n\tfor(re int i=1;i<=m;++i){\n\t\tre int l,r,x,ans=0;\n\t\tswitch(opt[i][0]){\n\t\t\tcase 1:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::lower_bound(p+1,p+p[0]+1,opt[i][3])-p;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\t\tfor(re int j=1;j<id2[x];++j)\n\t\t\t\t\t\tans+=cnt1[id1[r]-1][j]-cnt1[id1[l]][j];\n\t\t\t\t\tfor(re int j=(id2[x]-1)*sq2+1;j<x;++j)\n\t\t\t\t\t\tans+=cnt2[id1[r]-1][j]-cnt2[id1[l]][j];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tfor(re int j=l;j<=r;++j)\n\t\t\t\t\t\tans+=(a[j]<x);\n\t\t\t\tcltstream::write(ans+1,10);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=opt[i][3];\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=1;;++j)\n\t\t\t\t\t\tif(x>cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tx-=cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j];\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2;++k)\n\t\t\t\t\t\t\t\tif(x>cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tx-=cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k];\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tcltstream::write(p[k],10);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=1;;++j)\n\t\t\t\t\t\tif(x>tmp1[j])\n\t\t\t\t\t\t\tx-=tmp1[j];\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2;++k)\n\t\t\t\t\t\t\t\tif(x>tmp2[k])\n\t\t\t\t\t\t\t\t\tx-=tmp2[k];\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tcltstream::write(p[k],10);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tl=opt[i][1],x=std::lower_bound(p+1,p+p[0]+1,opt[i][2])-p;\n\t\t\t\tfor(re int j=id1[l];j<=id1[n];++j){\n\t\t\t\t\t--cnt1[j][id2[a[l]]];\n\t\t\t\t\t++cnt1[j][id2[x]];\n\t\t\t\t\t--cnt2[j][a[l]];\n\t\t\t\t\t++cnt2[j][x];\n\t\t\t\t}\n\t\t\t\ta[l]=x;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::lower_bound(p+1,p+p[0]+1,opt[i][3])-p;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x-1;j>=(id2[x]-1)*sq2+1&&!ans;--j)\n\t\t\t\t\t\tif(cnt2[id1[r]-1][j]-cnt2[id1[l]][j]+tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]-1;j>=1&&!ans;--j)\n\t\t\t\t\t\tif(cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=j*sq2;k>=(j-1)*sq2+1&&!ans;--k)\n\t\t\t\t\t\t\t\tif(cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x-1;j>=(id2[x]-1)*sq2+1&&!ans;--j)\n\t\t\t\t\t\tif(tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]-1;j>=1&&!ans;--j)\n\t\t\t\t\t\tif(tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=j*sq2;k>=(j-1)*sq2+1&&!ans;--k)\n\t\t\t\t\t\t\t\tif(tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcltstream::write(ans?p[ans]:-2147483647,10);\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tl=opt[i][1],r=opt[i][2],x=std::upper_bound(p+1,p+p[0]+1,opt[i][3])-p-1;\n\t\t\t\tif(id1[l]<id1[r]){\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x+1;j<=id2[x]*sq2&&!ans;++j)\n\t\t\t\t\t\tif(cnt2[id1[r]-1][j]-cnt2[id1[l]][j]+tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]+1;j<=id2[p[0]]&&!ans;++j)\n\t\t\t\t\t\tif(cnt1[id1[r]-1][j]-cnt1[id1[l]][j]+tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2&&!ans;++k)\n\t\t\t\t\t\t\t\tif(cnt2[id1[r]-1][k]-cnt2[id1[l]][k]+tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=id1[l]*sq1;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=(id1[r]-1)*sq1+1;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t++tmp1[id2[a[j]]];\n\t\t\t\t\t\t++tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t\tfor(re int j=x+1;j<=id2[x]*sq2&&!ans;++j)\n\t\t\t\t\t\tif(tmp2[j])\n\t\t\t\t\t\t\tans=j;\n\t\t\t\t\tfor(re int j=id2[x]+1;j<=id2[p[0]]&&!ans;++j)\n\t\t\t\t\t\tif(tmp1[j])\n\t\t\t\t\t\t\tfor(re int k=(j-1)*sq2+1;k<=j*sq2&&!ans;++k)\n\t\t\t\t\t\t\t\tif(tmp2[k])\n\t\t\t\t\t\t\t\t\tans=k;\n\t\t\t\t\tfor(re int j=l;j<=r;++j){\n\t\t\t\t\t\t--tmp1[id2[a[j]]];\n\t\t\t\t\t\t--tmp2[a[j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcltstream::write(ans?p[ans]:2147483647,10);\n\t\t}\n\t}\n\tclop();\n\treturn 0;\n}\n```\n\n$12\\text{KB}$\n\nFuture AlgorithmEpisode II","slug":"future-algorithm-ep1","published":1,"updated":"2018-12-19T12:08:11.478Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w3b002agwgu5gazwykd","content":"<p></p>\n<a id=\"more\"></a>\n<p></p>\n<p><a href=\"https://www.luogu.org/record/show?rid=14518116\" target=\"_blank\" rel=\"noopener\"><img src=\"https://i.loli.net/2018/12/08/5c0bb272768cf.png\" alt=\"\"></a></p>\n<p><img src=\"https://i.loli.net/2018/12/08/5c0bb2c767fda.jpg\" alt=\"\"></p>\n<p></p>\n<p>$3$</p>\n<p>$O(n\\operatorname{log}n)$</p>\n<p>$O(n\\operatorname{log}n)$$O(\\operatorname{log}n)$$O(\\operatorname{log}^{2}n)$</p>\n<p></p>\n<p><del></del></p>\n<p><code>std::set</code>$3$$O(\\operatorname{log}\\sqrt{n})$$1$$4$$5$$O(\\sqrt{n}\\operatorname{log}\\sqrt{n})$$2$$k$$O(\\operatorname{log}10^{9}\\sqrt{n}\\operatorname{log}\\sqrt{n})$</p>\n<p></p>\n<p><a href=\"https://www.luogu.org/space/show?uid=56384\" target=\"_blank\" rel=\"noopener\"><strong>Shadowice1984</strong></a>dalao<a href=\"https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p4119\" target=\"_blank\" rel=\"noopener\"></a></p>\n<blockquote>\n<p>$O(\\operatorname{log}n)$$\\text{log}$</p>\n<p>$O(\\sqrt{n})$$O(\\operatorname{log}n)$$\\text{log}$$\\text{log}$$\\text{log}$</p>\n</blockquote>\n<p>dalao<a href=\"https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p3380\" target=\"_blank\" rel=\"noopener\">blog</a></p>\n<p>$\\text{log}$</p>\n<p><code>cnt1[i][j]</code>$i$$j$<code>cnt2[i][j]</code>$i$$j$$O((n+m)\\sqrt{n})$</p>\n<p></p>\n<ol>\n<li></li>\n<li><code>tmp1</code><code>tmp2</code></li>\n<li>$O(\\sqrt{n})$<code>cnt</code></li>\n<li>$2$<strong></strong><strong></strong></li>\n<li>$4$</li>\n</ol>\n<p>$O((n+m)\\sqrt{n}+m\\sqrt{n+m})$$n$$m$$38172068$$O(m\\operatorname{log}^{2}n)\\approx 12183043$$\\text{O}2$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 50000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 50000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxs 230</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> max(a,b) ((a)&gt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> min(a,b) ((a)&lt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lowbit(a) ((a)&amp;(-(a)))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,sq1,sq2;</span><br><span class=\"line\"><span class=\"keyword\">int</span> id1[maxn+<span class=\"number\">1</span>],id2[maxn+maxm+<span class=\"number\">1</span>],p[maxn+maxm+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> a[maxn+<span class=\"number\">1</span>],opt[maxm+<span class=\"number\">1</span>][<span class=\"number\">4</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> cnt1[maxs+<span class=\"number\">1</span>][(maxs&lt;&lt;<span class=\"number\">1</span>)+<span class=\"number\">1</span>],cnt2[maxs+<span class=\"number\">1</span>][maxn+maxm+<span class=\"number\">1</span>],tmp1[(maxs&lt;&lt;<span class=\"number\">1</span>)+<span class=\"number\">1</span>],tmp2[maxn+maxm+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;(sq1+<span class=\"number\">1</span>)*(sq1+<span class=\"number\">1</span>)&lt;=n;++sq1);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)&#123;</span><br><span class=\"line\">\t\tid1[i]=(i<span class=\"number\">-1</span>)/sq1+<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tcltstream::read(a[i]);</span><br><span class=\"line\">\t\tp[++p[<span class=\"number\">0</span>]]=a[i];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">2</span>]);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(opt[i][<span class=\"number\">0</span>]!=<span class=\"number\">3</span>)</span><br><span class=\"line\">\t\t\tcltstream::read(opt[i][<span class=\"number\">3</span>]);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\tp[++p[<span class=\"number\">0</span>]]=opt[i][<span class=\"number\">2</span>];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">std</span>::sort(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>);</span><br><span class=\"line\">\tp[<span class=\"number\">0</span>]=<span class=\"built_in\">std</span>::unique(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>)-p<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;(sq2+<span class=\"number\">1</span>)*(sq2+<span class=\"number\">1</span>)&lt;=p[<span class=\"number\">0</span>];++sq2);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=p[<span class=\"number\">0</span>];++i)</span><br><span class=\"line\">\t\tid2[i]=(i<span class=\"number\">-1</span>)/sq2+<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)&#123;</span><br><span class=\"line\">\t\ta[i]=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,a[i])-p;</span><br><span class=\"line\">\t\t++cnt1[id1[i]][id2[a[i]]];</span><br><span class=\"line\">\t\t++cnt2[id1[i]][a[i]];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=id1[n];++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]];++j)</span><br><span class=\"line\">\t\t\tcnt1[i][j]+=cnt1[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=p[<span class=\"number\">0</span>];++j)</span><br><span class=\"line\">\t\t\tcnt2[i][j]+=cnt2[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\tre <span class=\"keyword\">int</span> l,r,x,ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(opt[i][<span class=\"number\">0</span>])&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;id2[x];++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j];</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;j&lt;x;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j];</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans+<span class=\"number\">1</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=opt[i][<span class=\"number\">3</span>];</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tx-=cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j];</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tx-=cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k];</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tcltstream::write(p[k],<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tx-=tmp1[j];</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tx-=tmp2[k];</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tcltstream::write(p[k],<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">2</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id1[l];j&lt;=id1[n];++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t--cnt1[j][id2[a[l]]];</span><br><span class=\"line\">\t\t\t\t\t++cnt1[j][id2[x]];</span><br><span class=\"line\">\t\t\t\t\t--cnt2[j][a[l]];</span><br><span class=\"line\">\t\t\t\t\t++cnt2[j][x];</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\ta[l]=x;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x<span class=\"number\">-1</span>;j&gt;=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j]+tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]<span class=\"number\">-1</span>;j&gt;=<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=j*sq2;k&gt;=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x<span class=\"number\">-1</span>;j&gt;=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]<span class=\"number\">-1</span>;j&gt;=<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=j*sq2;k&gt;=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans?p[ans]:<span class=\"number\">-2147483647</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::upper_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x+<span class=\"number\">1</span>;j&lt;=id2[x]*sq2&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j]+tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]+<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]]&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2&amp;&amp;!ans;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x+<span class=\"number\">1</span>;j&lt;=id2[x]*sq2&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]+<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]]&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2&amp;&amp;!ans;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans?p[ans]:<span class=\"number\">2147483647</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$12\\text{KB}$</p>\n<p>Future AlgorithmEpisode II</p>\n","site":{"data":{}},"excerpt":"<p></p>","more":"<p></p>\n<p><a href=\"https://www.luogu.org/record/show?rid=14518116\" target=\"_blank\" rel=\"noopener\"><img src=\"https://i.loli.net/2018/12/08/5c0bb272768cf.png\" alt=\"\"></a></p>\n<p><img src=\"https://i.loli.net/2018/12/08/5c0bb2c767fda.jpg\" alt=\"\"></p>\n<p></p>\n<p>$3$</p>\n<p>$O(n\\operatorname{log}n)$</p>\n<p>$O(n\\operatorname{log}n)$$O(\\operatorname{log}n)$$O(\\operatorname{log}^{2}n)$</p>\n<p></p>\n<p><del></del></p>\n<p><code>std::set</code>$3$$O(\\operatorname{log}\\sqrt{n})$$1$$4$$5$$O(\\sqrt{n}\\operatorname{log}\\sqrt{n})$$2$$k$$O(\\operatorname{log}10^{9}\\sqrt{n}\\operatorname{log}\\sqrt{n})$</p>\n<p></p>\n<p><a href=\"https://www.luogu.org/space/show?uid=56384\" target=\"_blank\" rel=\"noopener\"><strong>Shadowice1984</strong></a>dalao<a href=\"https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p4119\" target=\"_blank\" rel=\"noopener\"></a></p>\n<blockquote>\n<p>$O(\\operatorname{log}n)$$\\text{log}$</p>\n<p>$O(\\sqrt{n})$$O(\\operatorname{log}n)$$\\text{log}$$\\text{log}$$\\text{log}$</p>\n</blockquote>\n<p>dalao<a href=\"https://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p3380\" target=\"_blank\" rel=\"noopener\">blog</a></p>\n<p>$\\text{log}$</p>\n<p><code>cnt1[i][j]</code>$i$$j$<code>cnt2[i][j]</code>$i$$j$$O((n+m)\\sqrt{n})$</p>\n<p></p>\n<ol>\n<li></li>\n<li><code>tmp1</code><code>tmp2</code></li>\n<li>$O(\\sqrt{n})$<code>cnt</code></li>\n<li>$2$<strong></strong><strong></strong></li>\n<li>$4$</li>\n</ol>\n<p>$O((n+m)\\sqrt{n}+m\\sqrt{n+m})$$n$$m$$38172068$$O(m\\operatorname{log}^{2}n)\\approx 12183043$$\\text{O}2$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 50000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 50000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxs 230</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> max(a,b) ((a)&gt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> min(a,b) ((a)&lt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lowbit(a) ((a)&amp;(-(a)))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,sq1,sq2;</span><br><span class=\"line\"><span class=\"keyword\">int</span> id1[maxn+<span class=\"number\">1</span>],id2[maxn+maxm+<span class=\"number\">1</span>],p[maxn+maxm+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> a[maxn+<span class=\"number\">1</span>],opt[maxm+<span class=\"number\">1</span>][<span class=\"number\">4</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> cnt1[maxs+<span class=\"number\">1</span>][(maxs&lt;&lt;<span class=\"number\">1</span>)+<span class=\"number\">1</span>],cnt2[maxs+<span class=\"number\">1</span>][maxn+maxm+<span class=\"number\">1</span>],tmp1[(maxs&lt;&lt;<span class=\"number\">1</span>)+<span class=\"number\">1</span>],tmp2[maxn+maxm+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;(sq1+<span class=\"number\">1</span>)*(sq1+<span class=\"number\">1</span>)&lt;=n;++sq1);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)&#123;</span><br><span class=\"line\">\t\tid1[i]=(i<span class=\"number\">-1</span>)/sq1+<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tcltstream::read(a[i]);</span><br><span class=\"line\">\t\tp[++p[<span class=\"number\">0</span>]]=a[i];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tcltstream::read(opt[i][<span class=\"number\">2</span>]);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(opt[i][<span class=\"number\">0</span>]!=<span class=\"number\">3</span>)</span><br><span class=\"line\">\t\t\tcltstream::read(opt[i][<span class=\"number\">3</span>]);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\tp[++p[<span class=\"number\">0</span>]]=opt[i][<span class=\"number\">2</span>];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">std</span>::sort(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>);</span><br><span class=\"line\">\tp[<span class=\"number\">0</span>]=<span class=\"built_in\">std</span>::unique(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>)-p<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;(sq2+<span class=\"number\">1</span>)*(sq2+<span class=\"number\">1</span>)&lt;=p[<span class=\"number\">0</span>];++sq2);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=p[<span class=\"number\">0</span>];++i)</span><br><span class=\"line\">\t\tid2[i]=(i<span class=\"number\">-1</span>)/sq2+<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)&#123;</span><br><span class=\"line\">\t\ta[i]=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,a[i])-p;</span><br><span class=\"line\">\t\t++cnt1[id1[i]][id2[a[i]]];</span><br><span class=\"line\">\t\t++cnt2[id1[i]][a[i]];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=id1[n];++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]];++j)</span><br><span class=\"line\">\t\t\tcnt1[i][j]+=cnt1[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=p[<span class=\"number\">0</span>];++j)</span><br><span class=\"line\">\t\t\tcnt2[i][j]+=cnt2[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\tre <span class=\"keyword\">int</span> l,r,x,ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(opt[i][<span class=\"number\">0</span>])&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;id2[x];++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j];</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;j&lt;x;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j];</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)</span><br><span class=\"line\">\t\t\t\t\t\tans+=(a[j]&lt;x);</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans+<span class=\"number\">1</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=opt[i][<span class=\"number\">3</span>];</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tx-=cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j];</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tx-=cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k];</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tcltstream::write(p[k],<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tx-=tmp1[j];</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(x&gt;tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tx-=tmp2[k];</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tcltstream::write(p[k],<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">2</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id1[l];j&lt;=id1[n];++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t--cnt1[j][id2[a[l]]];</span><br><span class=\"line\">\t\t\t\t\t++cnt1[j][id2[x]];</span><br><span class=\"line\">\t\t\t\t\t--cnt2[j][a[l]];</span><br><span class=\"line\">\t\t\t\t\t++cnt2[j][x];</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\ta[l]=x;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::lower_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x<span class=\"number\">-1</span>;j&gt;=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j]+tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]<span class=\"number\">-1</span>;j&gt;=<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=j*sq2;k&gt;=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x<span class=\"number\">-1</span>;j&gt;=(id2[x]<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]<span class=\"number\">-1</span>;j&gt;=<span class=\"number\">1</span>&amp;&amp;!ans;--j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=j*sq2;k&gt;=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>&amp;&amp;!ans;--k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans?p[ans]:<span class=\"number\">-2147483647</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">5</span>:</span><br><span class=\"line\">\t\t\t\tl=opt[i][<span class=\"number\">1</span>],r=opt[i][<span class=\"number\">2</span>],x=<span class=\"built_in\">std</span>::upper_bound(p+<span class=\"number\">1</span>,p+p[<span class=\"number\">0</span>]+<span class=\"number\">1</span>,opt[i][<span class=\"number\">3</span>])-p<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(id1[l]&lt;id1[r])&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x+<span class=\"number\">1</span>;j&lt;=id2[x]*sq2&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][j]-cnt2[id1[l]][j]+tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]+<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]]&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt1[id1[r]<span class=\"number\">-1</span>][j]-cnt1[id1[l]][j]+tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2&amp;&amp;!ans;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(cnt2[id1[r]<span class=\"number\">-1</span>][k]-cnt2[id1[l]][k]+tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=id1[l]*sq1;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(id1[r]<span class=\"number\">-1</span>)*sq1+<span class=\"number\">1</span>;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t++tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t++tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=x+<span class=\"number\">1</span>;j&lt;=id2[x]*sq2&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[j])</span><br><span class=\"line\">\t\t\t\t\t\t\tans=j;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=id2[x]+<span class=\"number\">1</span>;j&lt;=id2[p[<span class=\"number\">0</span>]]&amp;&amp;!ans;++j)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp1[j])</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(j<span class=\"number\">-1</span>)*sq2+<span class=\"number\">1</span>;k&lt;=j*sq2&amp;&amp;!ans;++k)</span><br><span class=\"line\">\t\t\t\t\t\t\t\t<span class=\"keyword\">if</span>(tmp2[k])</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\tans=k;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=l;j&lt;=r;++j)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t--tmp1[id2[a[j]]];</span><br><span class=\"line\">\t\t\t\t\t\t--tmp2[a[j]];</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\tcltstream::write(ans?p[ans]:<span class=\"number\">2147483647</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$12\\text{KB}$</p>\n<p>Future AlgorithmEpisode II</p>"},{"title":"Luogu-P5009","date":"2018-11-08T00:04:22.000Z","mathjax":true,"_content":"[](https://www.luogu.org/problemnew/show/P5009)\n\n<!-- more -->\n\nqaq\n\nqaq\n\nqaq\n\n$v$$a$$b$$t_1$$a_i$$x$$t_2(t_2>t_1)$$v_i+t_1a_ib_i+(t_2-t_1)(a_i+x)b_i$$v$$v$$v_i^\\prime$$v_i^\\prime+t_1(a_i+x)b_i=v+t_1a_ib_i$$v_i$$v_i^\\prime$$v_i^\\prime+t_2(a_i+x)b_i$$v_i^\\prime=v_i-t_1xb_i$\n\n$a$$x$$b$$y$$t$$\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$a$$z$$\\Sigma v_i^\\prime+t\\Sigma (a_i+x+z)(b_i+y)=\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$\\Sigma v_i^\\prime=\\Sigma v_i-tz\\Sigma (b_i+y)$\n\n$tz\\Sigma (b_i+y)$$(b_i+y)$$b_i$$b_i$$tz\\Sigma b_i+tzy$$tzy$$tz\\Sigma b_i$$\\Sigma b_i$$B$$\\Sigma v_i+=B\\Sigma b_i$$B+=tz$$a$$b$\n\n\n\n```cpp\naddv[son]+=A[father]*suma[son]+B[father]*sumb[son]+addv[father];\n//qaqqaq\nA[son]+=A[father];\nB[son]+=B[father];\nadda[son]+=adda[father];\naddb[son]+=addf[father];\n```\n\n~~~~\n\n```cpp\n#include<cstdio>\n#define re register\n#define maxn 200005\n#define maxm 200005\n#define mod 100000007\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m;\nint sumv[(maxn<<2)+1],suma[(maxn<<2)+1],sumb[(maxn<<2)+1],sump[(maxn<<2)+1];\nint A[(maxn<<2)+1],B[(maxn<<2)+1];\nint addv[(maxn<<2)+1],adda[(maxn<<2)+1],addb[(maxn<<2)+1];\n\ninline void pushDown(int cur,int ln,int rn){\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*A[cur]*suma[cur<<1]%mod)%mod;\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*B[cur]*sumb[cur<<1]%mod)%mod;\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*ln*addv[cur]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*adda[cur]*sumb[cur<<1]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*addb[cur]*suma[cur<<1]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*adda[cur]*addb[cur]%mod*ln%mod)%mod;\n\tsuma[cur<<1]=(suma[cur<<1]+1LL*ln*adda[cur]%mod)%mod;\n\tsumb[cur<<1]=(sumb[cur<<1]+1LL*ln*addb[cur]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+1LL*A[cur]*adda[cur<<1]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+1LL*B[cur]*addb[cur<<1]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+addv[cur])%mod;\n\tA[cur<<1]=(A[cur<<1]+A[cur])%mod;\n\tB[cur<<1]=(B[cur<<1]+B[cur])%mod;\n\tadda[cur<<1]=(adda[cur<<1]+adda[cur])%mod;\n\taddb[cur<<1]=(addb[cur<<1]+addb[cur])%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*A[cur]*suma[cur<<1|1]%mod)%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*B[cur]*sumb[cur<<1|1]%mod)%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*rn*addv[cur]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*adda[cur]*sumb[cur<<1|1]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*addb[cur]*suma[cur<<1|1]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*adda[cur]*addb[cur]%mod*rn%mod)%mod;\n\tsuma[cur<<1|1]=(suma[cur<<1|1]+1LL*rn*adda[cur]%mod)%mod;\n\tsumb[cur<<1|1]=(sumb[cur<<1|1]+1LL*rn*addb[cur]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+1LL*A[cur]*adda[cur<<1|1]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+1LL*B[cur]*addb[cur<<1|1]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+addv[cur])%mod;\n\tA[cur<<1|1]=(A[cur<<1|1]+A[cur])%mod;\n\tB[cur<<1|1]=(B[cur<<1|1]+B[cur])%mod;\n\tadda[cur<<1|1]=(adda[cur<<1|1]+adda[cur])%mod;\n\taddb[cur<<1|1]=(addb[cur<<1|1]+addb[cur])%mod;\n\tA[cur]=B[cur]=addv[cur]=adda[cur]=addb[cur]=0;\n}\n\ninline void pushUp(int cur){\n\tsumv[cur]=(sumv[cur<<1]+sumv[cur<<1|1])%mod;\n\tsuma[cur]=(suma[cur<<1]+suma[cur<<1|1])%mod;\n\tsumb[cur]=(sumb[cur<<1]+sumb[cur<<1|1])%mod;\n\tsump[cur]=(sump[cur<<1]+sump[cur<<1|1])%mod;\n}\n\nvoid build(int cur,int l,int r){\n\tif(l==r){\n\t\tcltstream::read(sumv[cur]);\n\t\tcltstream::read(suma[cur]);\n\t\tcltstream::read(sumb[cur]);\n\t\tsumv[cur]=(sumv[cur]%mod+mod)%mod;\n\t\tsuma[cur]=(suma[cur]%mod+mod)%mod;\n\t\tsumb[cur]=(sumb[cur]%mod+mod)%mod;\n\t\tsump[cur]=1LL*suma[cur]*sumb[cur]%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tbuild(cur<<1,l,mid);\n\t\tbuild(cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nint query(int L,int R,int t,int cur,int l,int r){\n\tif(l>=L&&r<=R)\n\t\treturn (sumv[cur]+1LL*t*sump[cur]%mod)%mod;\n\telse{\n\t\tint mid=(l+r)>>1,res=0;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tres=(res+query(L,R,t,cur<<1,l,mid))%mod;\n\t\tif(R>mid)\n\t\t\tres=(res+query(L,R,t,cur<<1|1,mid+1,r))%mod;\n\t\treturn res;\n\t}\n}\n\nvoid modifyV(int L,int R,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\taddv[cur]=(addv[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyV(L,R,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyV(L,R,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nvoid modifyA(int L,int R,int t,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+(-1LL*x*t%mod*sumb[cur]%mod+mod)%mod)%mod;\n\t\tsuma[cur]=(suma[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\tsump[cur]=(sump[cur]+1LL*sumb[cur]*x%mod)%mod;\n\t\tB[cur]=(B[cur]+(-1LL*x*t%mod+mod)%mod)%mod;\n\t\taddv[cur]=(addv[cur]+(-1LL*x*t%mod*addb[cur]%mod+mod)%mod)%mod;\n\t\tadda[cur]=(adda[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyA(L,R,t,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyA(L,R,t,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nvoid modifyB(int L,int R,int t,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+(-1LL*x*t%mod*suma[cur]%mod+mod)%mod)%mod;\n\t\tsumb[cur]=(sumb[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\tsump[cur]=(sump[cur]+1LL*suma[cur]*x%mod)%mod;\n\t\tA[cur]=(A[cur]+(-1LL*x*t%mod+mod)%mod)%mod;\n\t\taddv[cur]=(addv[cur]+(-1LL*x*t%mod*adda[cur]%mod+mod)%mod)%mod;\n\t\taddb[cur]=(addb[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyB(L,R,t,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyB(L,R,t,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nint main(){\n\tcltstream::read(n);\n\tcltstream::read(m);\n\tbuild(1,1,n);\n\tfor(re int i=1;i<=m;++i){\n\t\tint opt,t,l,r,x;\n\t\tcltstream::read(opt);\n\t\tcltstream::read(t);\n\t\tcltstream::read(l);\n\t\tcltstream::read(r);\n\t\tswitch(opt){\n\t\t\tcase 1:\n\t\t\t\tcltstream::write(query(l,r,t,1,1,n),10);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyA(l,r,t,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyB(l,r,t,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyV(l,r,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tclop();\n\treturn 0;\n}\n```\n\nqaq\n\n![](https://i.loli.net/2018/11/08/5be38edf529ca.jpg)\n\n __NOIp2018__  __1 __","source":"_posts/2018-11-08-luogu-p5009-solution.md","raw":"---\ntitle: Luogu-P5009\ndate: 2018-11-08 08:04:22\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n[](https://www.luogu.org/problemnew/show/P5009)\n\n<!-- more -->\n\nqaq\n\nqaq\n\nqaq\n\n$v$$a$$b$$t_1$$a_i$$x$$t_2(t_2>t_1)$$v_i+t_1a_ib_i+(t_2-t_1)(a_i+x)b_i$$v$$v$$v_i^\\prime$$v_i^\\prime+t_1(a_i+x)b_i=v+t_1a_ib_i$$v_i$$v_i^\\prime$$v_i^\\prime+t_2(a_i+x)b_i$$v_i^\\prime=v_i-t_1xb_i$\n\n$a$$x$$b$$y$$t$$\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$a$$z$$\\Sigma v_i^\\prime+t\\Sigma (a_i+x+z)(b_i+y)=\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$\\Sigma v_i^\\prime=\\Sigma v_i-tz\\Sigma (b_i+y)$\n\n$tz\\Sigma (b_i+y)$$(b_i+y)$$b_i$$b_i$$tz\\Sigma b_i+tzy$$tzy$$tz\\Sigma b_i$$\\Sigma b_i$$B$$\\Sigma v_i+=B\\Sigma b_i$$B+=tz$$a$$b$\n\n\n\n```cpp\naddv[son]+=A[father]*suma[son]+B[father]*sumb[son]+addv[father];\n//qaqqaq\nA[son]+=A[father];\nB[son]+=B[father];\nadda[son]+=adda[father];\naddb[son]+=addf[father];\n```\n\n~~~~\n\n```cpp\n#include<cstdio>\n#define re register\n#define maxn 200005\n#define maxm 200005\n#define mod 100000007\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m;\nint sumv[(maxn<<2)+1],suma[(maxn<<2)+1],sumb[(maxn<<2)+1],sump[(maxn<<2)+1];\nint A[(maxn<<2)+1],B[(maxn<<2)+1];\nint addv[(maxn<<2)+1],adda[(maxn<<2)+1],addb[(maxn<<2)+1];\n\ninline void pushDown(int cur,int ln,int rn){\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*A[cur]*suma[cur<<1]%mod)%mod;\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*B[cur]*sumb[cur<<1]%mod)%mod;\n\tsumv[cur<<1]=(sumv[cur<<1]+1LL*ln*addv[cur]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*adda[cur]*sumb[cur<<1]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*addb[cur]*suma[cur<<1]%mod)%mod;\n\tsump[cur<<1]=(sump[cur<<1]+1LL*adda[cur]*addb[cur]%mod*ln%mod)%mod;\n\tsuma[cur<<1]=(suma[cur<<1]+1LL*ln*adda[cur]%mod)%mod;\n\tsumb[cur<<1]=(sumb[cur<<1]+1LL*ln*addb[cur]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+1LL*A[cur]*adda[cur<<1]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+1LL*B[cur]*addb[cur<<1]%mod)%mod;\n\taddv[cur<<1]=(addv[cur<<1]+addv[cur])%mod;\n\tA[cur<<1]=(A[cur<<1]+A[cur])%mod;\n\tB[cur<<1]=(B[cur<<1]+B[cur])%mod;\n\tadda[cur<<1]=(adda[cur<<1]+adda[cur])%mod;\n\taddb[cur<<1]=(addb[cur<<1]+addb[cur])%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*A[cur]*suma[cur<<1|1]%mod)%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*B[cur]*sumb[cur<<1|1]%mod)%mod;\n\tsumv[cur<<1|1]=(sumv[cur<<1|1]+1LL*rn*addv[cur]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*adda[cur]*sumb[cur<<1|1]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*addb[cur]*suma[cur<<1|1]%mod)%mod;\n\tsump[cur<<1|1]=(sump[cur<<1|1]+1LL*adda[cur]*addb[cur]%mod*rn%mod)%mod;\n\tsuma[cur<<1|1]=(suma[cur<<1|1]+1LL*rn*adda[cur]%mod)%mod;\n\tsumb[cur<<1|1]=(sumb[cur<<1|1]+1LL*rn*addb[cur]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+1LL*A[cur]*adda[cur<<1|1]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+1LL*B[cur]*addb[cur<<1|1]%mod)%mod;\n\taddv[cur<<1|1]=(addv[cur<<1|1]+addv[cur])%mod;\n\tA[cur<<1|1]=(A[cur<<1|1]+A[cur])%mod;\n\tB[cur<<1|1]=(B[cur<<1|1]+B[cur])%mod;\n\tadda[cur<<1|1]=(adda[cur<<1|1]+adda[cur])%mod;\n\taddb[cur<<1|1]=(addb[cur<<1|1]+addb[cur])%mod;\n\tA[cur]=B[cur]=addv[cur]=adda[cur]=addb[cur]=0;\n}\n\ninline void pushUp(int cur){\n\tsumv[cur]=(sumv[cur<<1]+sumv[cur<<1|1])%mod;\n\tsuma[cur]=(suma[cur<<1]+suma[cur<<1|1])%mod;\n\tsumb[cur]=(sumb[cur<<1]+sumb[cur<<1|1])%mod;\n\tsump[cur]=(sump[cur<<1]+sump[cur<<1|1])%mod;\n}\n\nvoid build(int cur,int l,int r){\n\tif(l==r){\n\t\tcltstream::read(sumv[cur]);\n\t\tcltstream::read(suma[cur]);\n\t\tcltstream::read(sumb[cur]);\n\t\tsumv[cur]=(sumv[cur]%mod+mod)%mod;\n\t\tsuma[cur]=(suma[cur]%mod+mod)%mod;\n\t\tsumb[cur]=(sumb[cur]%mod+mod)%mod;\n\t\tsump[cur]=1LL*suma[cur]*sumb[cur]%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tbuild(cur<<1,l,mid);\n\t\tbuild(cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nint query(int L,int R,int t,int cur,int l,int r){\n\tif(l>=L&&r<=R)\n\t\treturn (sumv[cur]+1LL*t*sump[cur]%mod)%mod;\n\telse{\n\t\tint mid=(l+r)>>1,res=0;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tres=(res+query(L,R,t,cur<<1,l,mid))%mod;\n\t\tif(R>mid)\n\t\t\tres=(res+query(L,R,t,cur<<1|1,mid+1,r))%mod;\n\t\treturn res;\n\t}\n}\n\nvoid modifyV(int L,int R,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\taddv[cur]=(addv[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyV(L,R,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyV(L,R,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nvoid modifyA(int L,int R,int t,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+(-1LL*x*t%mod*sumb[cur]%mod+mod)%mod)%mod;\n\t\tsuma[cur]=(suma[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\tsump[cur]=(sump[cur]+1LL*sumb[cur]*x%mod)%mod;\n\t\tB[cur]=(B[cur]+(-1LL*x*t%mod+mod)%mod)%mod;\n\t\taddv[cur]=(addv[cur]+(-1LL*x*t%mod*addb[cur]%mod+mod)%mod)%mod;\n\t\tadda[cur]=(adda[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyA(L,R,t,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyA(L,R,t,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nvoid modifyB(int L,int R,int t,int x,int cur,int l,int r){\n\tif(l>=L&&r<=R){\n\t\tsumv[cur]=(sumv[cur]+(-1LL*x*t%mod*suma[cur]%mod+mod)%mod)%mod;\n\t\tsumb[cur]=(sumb[cur]+1LL*(r-l+1)*x%mod)%mod;\n\t\tsump[cur]=(sump[cur]+1LL*suma[cur]*x%mod)%mod;\n\t\tA[cur]=(A[cur]+(-1LL*x*t%mod+mod)%mod)%mod;\n\t\taddv[cur]=(addv[cur]+(-1LL*x*t%mod*adda[cur]%mod+mod)%mod)%mod;\n\t\taddb[cur]=(addb[cur]+x)%mod;\n\t}\n\telse{\n\t\tint mid=(l+r)>>1;\n\t\tpushDown(cur,mid-l+1,r-mid);\n\t\tif(L<=mid)\n\t\t\tmodifyB(L,R,t,x,cur<<1,l,mid);\n\t\tif(R>mid)\n\t\t\tmodifyB(L,R,t,x,cur<<1|1,mid+1,r);\n\t\tpushUp(cur);\n\t}\n}\n\nint main(){\n\tcltstream::read(n);\n\tcltstream::read(m);\n\tbuild(1,1,n);\n\tfor(re int i=1;i<=m;++i){\n\t\tint opt,t,l,r,x;\n\t\tcltstream::read(opt);\n\t\tcltstream::read(t);\n\t\tcltstream::read(l);\n\t\tcltstream::read(r);\n\t\tswitch(opt){\n\t\t\tcase 1:\n\t\t\t\tcltstream::write(query(l,r,t,1,1,n),10);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyA(l,r,t,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyB(l,r,t,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcltstream::read(x);\n\t\t\t\tmodifyV(l,r,(x%mod+mod)%mod,1,1,n);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tclop();\n\treturn 0;\n}\n```\n\nqaq\n\n![](https://i.loli.net/2018/11/08/5be38edf529ca.jpg)\n\n __NOIp2018__  __1 __","slug":"luogu-p5009-solution","published":1,"updated":"2018-12-12T02:05:04.885Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w3e002cgwgurcdoc2dd","content":"<p><a href=\"https://www.luogu.org/problemnew/show/P5009\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<p>qaq</p>\n<p>qaq</p>\n<p>qaq</p>\n<p>$v$$a$$b$$t_1$$a_i$$x$$t_2(t_2&gt;t_1)$$v_i+t_1a_ib_i+(t_2-t_1)(a_i+x)b_i$$v$$v$$v_i^\\prime$$v_i^\\prime+t_1(a_i+x)b_i=v+t_1a_ib_i$$v_i$$v_i^\\prime$$v_i^\\prime+t_2(a_i+x)b_i$$v_i^\\prime=v_i-t_1xb_i$</p>\n<p>$a$$x$$b$$y$$t$$\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$a$$z$$\\Sigma v_i^\\prime+t\\Sigma (a_i+x+z)(b_i+y)=\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$\\Sigma v_i^\\prime=\\Sigma v_i-tz\\Sigma (b_i+y)$</p>\n<p>$tz\\Sigma (b_i+y)$$(b_i+y)$$b_i$$b_i$$tz\\Sigma b_i+tzy$$tzy$$tz\\Sigma b_i$$\\Sigma b_i$$B$$\\Sigma v_i+=B\\Sigma b_i$$B+=tz$$a$$b$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">addv[son]+=A[father]*suma[son]+B[father]*sumb[son]+addv[father];</span><br><span class=\"line\"><span class=\"comment\">//qaqqaq</span></span><br><span class=\"line\">A[son]+=A[father];</span><br><span class=\"line\">B[son]+=B[father];</span><br><span class=\"line\">adda[son]+=adda[father];</span><br><span class=\"line\">addb[son]+=addf[father];</span><br></pre></td></tr></table></figure>\n<p><del></del></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 200005</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 200005</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 100000007</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> sumv[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],suma[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],sumb[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],sump[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> A[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],B[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> addv[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],adda[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],addb[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> ln,<span class=\"keyword\">int</span> rn)</span></span>&#123;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*addv[cur]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*addb[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*addb[cur]%mod*ln%mod)%mod;</span><br><span class=\"line\">\tsuma[cur&lt;&lt;<span class=\"number\">1</span>]=(suma[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*adda[cur]%mod)%mod;</span><br><span class=\"line\">\tsumb[cur&lt;&lt;<span class=\"number\">1</span>]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*addb[cur]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*adda[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*addb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+addv[cur])%mod;</span><br><span class=\"line\">\tA[cur&lt;&lt;<span class=\"number\">1</span>]=(A[cur&lt;&lt;<span class=\"number\">1</span>]+A[cur])%mod;</span><br><span class=\"line\">\tB[cur&lt;&lt;<span class=\"number\">1</span>]=(B[cur&lt;&lt;<span class=\"number\">1</span>]+B[cur])%mod;</span><br><span class=\"line\">\tadda[cur&lt;&lt;<span class=\"number\">1</span>]=(adda[cur&lt;&lt;<span class=\"number\">1</span>]+adda[cur])%mod;</span><br><span class=\"line\">\taddb[cur&lt;&lt;<span class=\"number\">1</span>]=(addb[cur&lt;&lt;<span class=\"number\">1</span>]+addb[cur])%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*addv[cur]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*addb[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*addb[cur]%mod*rn%mod)%mod;</span><br><span class=\"line\">\tsuma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*adda[cur]%mod)%mod;</span><br><span class=\"line\">\tsumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*addb[cur]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*adda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*addb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+addv[cur])%mod;</span><br><span class=\"line\">\tA[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(A[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+A[cur])%mod;</span><br><span class=\"line\">\tB[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(B[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+B[cur])%mod;</span><br><span class=\"line\">\tadda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(adda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+adda[cur])%mod;</span><br><span class=\"line\">\taddb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+addb[cur])%mod;</span><br><span class=\"line\">\tA[cur]=B[cur]=addv[cur]=adda[cur]=addb[cur]=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> cur)</span></span>&#123;</span><br><span class=\"line\">\tsumv[cur]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsuma[cur]=(suma[cur&lt;&lt;<span class=\"number\">1</span>]+suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsumb[cur]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>]+sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsump[cur]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l==r)&#123;</span><br><span class=\"line\">\t\tcltstream::read(sumv[cur]);</span><br><span class=\"line\">\t\tcltstream::read(suma[cur]);</span><br><span class=\"line\">\t\tcltstream::read(sumb[cur]);</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsuma[cur]=(suma[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsumb[cur]=(sumb[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=<span class=\"number\">1L</span>L*suma[cur]*sumb[cur]%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tbuild(cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\tbuild(cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> (sumv[cur]+<span class=\"number\">1L</span>L*t*sump[cur]%mod)%mod;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>,res=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tres=(res+query(L,R,t,cur&lt;&lt;<span class=\"number\">1</span>,l,mid))%mod;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tres=(res+query(L,R,t,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r))%mod;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyV</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyV(L,R,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyV(L,R,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyA</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*sumb[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tsuma[cur]=(suma[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=(sump[cur]+<span class=\"number\">1L</span>L*sumb[cur]*x%mod)%mod;</span><br><span class=\"line\">\t\tB[cur]=(B[cur]+(<span class=\"number\">-1L</span>L*x*t%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*addb[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tadda[cur]=(adda[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyA(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyA(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyB</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*suma[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tsumb[cur]=(sumb[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=(sump[cur]+<span class=\"number\">1L</span>L*suma[cur]*x%mod)%mod;</span><br><span class=\"line\">\t\tA[cur]=(A[cur]+(<span class=\"number\">-1L</span>L*x*t%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*adda[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddb[cur]=(addb[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyB(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyB(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\tbuild(<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> opt,t,l,r,x;</span><br><span class=\"line\">\t\tcltstream::read(opt);</span><br><span class=\"line\">\t\tcltstream::read(t);</span><br><span class=\"line\">\t\tcltstream::read(l);</span><br><span class=\"line\">\t\tcltstream::read(r);</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::write(query(l,r,t,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n),<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyA(l,r,t,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyB(l,r,t,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyV(l,r,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>qaq</p>\n<p><img src=\"https://i.loli.net/2018/11/08/5be38edf529ca.jpg\" alt=\"\"></p>\n<p> <strong>NOIp2018</strong>  <strong>1 </strong></p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/problemnew/show/P5009\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<p>qaq</p>\n<p>qaq</p>\n<p>qaq</p>\n<p>$v$$a$$b$$t_1$$a_i$$x$$t_2(t_2&gt;t_1)$$v_i+t_1a_ib_i+(t_2-t_1)(a_i+x)b_i$$v$$v$$v_i^\\prime$$v_i^\\prime+t_1(a_i+x)b_i=v+t_1a_ib_i$$v_i$$v_i^\\prime$$v_i^\\prime+t_2(a_i+x)b_i$$v_i^\\prime=v_i-t_1xb_i$</p>\n<p>$a$$x$$b$$y$$t$$\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$a$$z$$\\Sigma v_i^\\prime+t\\Sigma (a_i+x+z)(b_i+y)=\\Sigma v_i+t\\Sigma (a_i+x)(b_i+y)$$\\Sigma v_i^\\prime=\\Sigma v_i-tz\\Sigma (b_i+y)$</p>\n<p>$tz\\Sigma (b_i+y)$$(b_i+y)$$b_i$$b_i$$tz\\Sigma b_i+tzy$$tzy$$tz\\Sigma b_i$$\\Sigma b_i$$B$$\\Sigma v_i+=B\\Sigma b_i$$B+=tz$$a$$b$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">addv[son]+=A[father]*suma[son]+B[father]*sumb[son]+addv[father];</span><br><span class=\"line\"><span class=\"comment\">//qaqqaq</span></span><br><span class=\"line\">A[son]+=A[father];</span><br><span class=\"line\">B[son]+=B[father];</span><br><span class=\"line\">adda[son]+=adda[father];</span><br><span class=\"line\">addb[son]+=addf[father];</span><br></pre></td></tr></table></figure>\n<p><del></del></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 200005</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 200005</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 100000007</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> sumv[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],suma[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],sumb[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],sump[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> A[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],B[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> addv[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],adda[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>],addb[(maxn&lt;&lt;<span class=\"number\">2</span>)+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> ln,<span class=\"keyword\">int</span> rn)</span></span>&#123;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*addv[cur]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*addb[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*addb[cur]%mod*ln%mod)%mod;</span><br><span class=\"line\">\tsuma[cur&lt;&lt;<span class=\"number\">1</span>]=(suma[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*adda[cur]%mod)%mod;</span><br><span class=\"line\">\tsumb[cur&lt;&lt;<span class=\"number\">1</span>]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*ln*addb[cur]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*adda[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*addb[cur&lt;&lt;<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>]+addv[cur])%mod;</span><br><span class=\"line\">\tA[cur&lt;&lt;<span class=\"number\">1</span>]=(A[cur&lt;&lt;<span class=\"number\">1</span>]+A[cur])%mod;</span><br><span class=\"line\">\tB[cur&lt;&lt;<span class=\"number\">1</span>]=(B[cur&lt;&lt;<span class=\"number\">1</span>]+B[cur])%mod;</span><br><span class=\"line\">\tadda[cur&lt;&lt;<span class=\"number\">1</span>]=(adda[cur&lt;&lt;<span class=\"number\">1</span>]+adda[cur])%mod;</span><br><span class=\"line\">\taddb[cur&lt;&lt;<span class=\"number\">1</span>]=(addb[cur&lt;&lt;<span class=\"number\">1</span>]+addb[cur])%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*addv[cur]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*addb[cur]*suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\tsump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*adda[cur]*addb[cur]%mod*rn%mod)%mod;</span><br><span class=\"line\">\tsuma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*adda[cur]%mod)%mod;</span><br><span class=\"line\">\tsumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*rn*addb[cur]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*A[cur]*adda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+<span class=\"number\">1L</span>L*B[cur]*addb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]%mod)%mod;</span><br><span class=\"line\">\taddv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+addv[cur])%mod;</span><br><span class=\"line\">\tA[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(A[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+A[cur])%mod;</span><br><span class=\"line\">\tB[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(B[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+B[cur])%mod;</span><br><span class=\"line\">\tadda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(adda[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+adda[cur])%mod;</span><br><span class=\"line\">\taddb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]=(addb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+addb[cur])%mod;</span><br><span class=\"line\">\tA[cur]=B[cur]=addv[cur]=adda[cur]=addb[cur]=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> cur)</span></span>&#123;</span><br><span class=\"line\">\tsumv[cur]=(sumv[cur&lt;&lt;<span class=\"number\">1</span>]+sumv[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsuma[cur]=(suma[cur&lt;&lt;<span class=\"number\">1</span>]+suma[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsumb[cur]=(sumb[cur&lt;&lt;<span class=\"number\">1</span>]+sumb[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">\tsump[cur]=(sump[cur&lt;&lt;<span class=\"number\">1</span>]+sump[cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>])%mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l==r)&#123;</span><br><span class=\"line\">\t\tcltstream::read(sumv[cur]);</span><br><span class=\"line\">\t\tcltstream::read(suma[cur]);</span><br><span class=\"line\">\t\tcltstream::read(sumb[cur]);</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsuma[cur]=(suma[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsumb[cur]=(sumb[cur]%mod+mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=<span class=\"number\">1L</span>L*suma[cur]*sumb[cur]%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tbuild(cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\tbuild(cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> (sumv[cur]+<span class=\"number\">1L</span>L*t*sump[cur]%mod)%mod;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>,res=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tres=(res+query(L,R,t,cur&lt;&lt;<span class=\"number\">1</span>,l,mid))%mod;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tres=(res+query(L,R,t,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r))%mod;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyV</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyV(L,R,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyV(L,R,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyA</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*sumb[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tsuma[cur]=(suma[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=(sump[cur]+<span class=\"number\">1L</span>L*sumb[cur]*x%mod)%mod;</span><br><span class=\"line\">\t\tB[cur]=(B[cur]+(<span class=\"number\">-1L</span>L*x*t%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*addb[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tadda[cur]=(adda[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyA(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyA(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">modifyB</span><span class=\"params\">(<span class=\"keyword\">int</span> L,<span class=\"keyword\">int</span> R,<span class=\"keyword\">int</span> t,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> cur,<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&gt;=L&amp;&amp;r&lt;=R)&#123;</span><br><span class=\"line\">\t\tsumv[cur]=(sumv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*suma[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\tsumb[cur]=(sumb[cur]+<span class=\"number\">1L</span>L*(r-l+<span class=\"number\">1</span>)*x%mod)%mod;</span><br><span class=\"line\">\t\tsump[cur]=(sump[cur]+<span class=\"number\">1L</span>L*suma[cur]*x%mod)%mod;</span><br><span class=\"line\">\t\tA[cur]=(A[cur]+(<span class=\"number\">-1L</span>L*x*t%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddv[cur]=(addv[cur]+(<span class=\"number\">-1L</span>L*x*t%mod*adda[cur]%mod+mod)%mod)%mod;</span><br><span class=\"line\">\t\taddb[cur]=(addb[cur]+x)%mod;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> mid=(l+r)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tpushDown(cur,mid-l+<span class=\"number\">1</span>,r-mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(L&lt;=mid)</span><br><span class=\"line\">\t\t\tmodifyB(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>,l,mid);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(R&gt;mid)</span><br><span class=\"line\">\t\t\tmodifyB(L,R,t,x,cur&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,r);</span><br><span class=\"line\">\t\tpushUp(cur);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\tbuild(<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> opt,t,l,r,x;</span><br><span class=\"line\">\t\tcltstream::read(opt);</span><br><span class=\"line\">\t\tcltstream::read(t);</span><br><span class=\"line\">\t\tcltstream::read(l);</span><br><span class=\"line\">\t\tcltstream::read(r);</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::write(query(l,r,t,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n),<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyA(l,r,t,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyB(l,r,t,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">\t\t\t\tcltstream::read(x);</span><br><span class=\"line\">\t\t\t\tmodifyV(l,r,(x%mod+mod)%mod,<span class=\"number\">1</span>,<span class=\"number\">1</span>,n);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>qaq</p>\n<p><img src=\"https://i.loli.net/2018/11/08/5be38edf529ca.jpg\" alt=\"\"></p>\n<p> <strong>NOIp2018</strong>  <strong>1 </strong></p>"},{"mathjax":true,"date":"2018-12-20T08:58:39.000Z","title":"Part II","_content":"$998244353$\n\n<!-- more -->\n\n### \n\n#### \n\n\n\nxjb\n\n$f(x)$$g(x)$$x$$x_{0}$$f(x)$\n\n\n\n$$g(x)=\\sum\\limits_{i=0}^{n}g[i](x-x_{0})^{i}$$\n\n$x\\rightarrow x_{0}$$g$$x$$f$$x_{0}$\n\n$0$$x\\rightarrow x_{0}$$x-x_{0}$\n\n$$g[0]=f(x_{0})$$\n\n$1$\n\n$$g^{\\prime}(x)=\\sum\\limits_{i=1}^{n}ig[i](x-x_{0})^{i-1}=g[1]=f^{\\prime}(x_{0})$$\n\n$2$\n\n$$g^{\\prime\\prime}(x)=\\sum\\limits_{i=2}^{n}i(i-1)g[i](x-x_{0})^{i-2}=2g[2]=f^{\\prime\\prime}(x_{0})$$\n\n$3$\n\n$$g^{\\prime\\prime\\prime}(x)=\\sum\\limits_{i=3}^{n}i(i-1)(i-2)g[i](x-x_{0})^{i-3}=6g[3]=f^{\\prime\\prime\\prime}(x_{0})$$\n\n$g[n]$\n\n$$g[n]=\\cfrac{f^{(n)}(x_{0})}{n!}$$\n\n\n\n$$g(x)=\\sum\\limits_{i=0}^{n}\\cfrac{f^{(i)}(x_{0})}{i!}(x-x_{0})^i$$\n\n~~~~\n\n#### \n\n$n-1$$F(x)$$G(x)$\n\n$$F(G(x))\\equiv 0\\pmod{x^{n}}$$\n\n$G_{0}$\n\n$$F(G_{0})\\equiv 0\\pmod{x^{t}}$$\n\n$G$\n\n$$F(G)\\equiv 0\\pmod{x^{2t}}$$\n\n$F$$G_{0}$\n\n$$\\begin{aligned}\nF(G)&=F(G_{0})\\\\\n&+F^{\\prime}(G_{0})(G-G_{0})\\\\\n&+\\cfrac{F^{\\prime\\prime}(G_{0})}{2}(G-G_{0})^{2}\\\\\n&+\\cdots\\end{aligned}$$\n\n\n\n$$\\begin{aligned}\nF(G)-F(G_{0})&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\n\\end{aligned}$$\n\n$G-G_{0}$$t$$(G-G_{0})^{k}$$kt$\n\n$$\\begin{aligned}\nF(G)&\\equiv F(G_{0})+F^{\\prime}(G_{0})(G-G_{0})\\pmod{x^{2t}}\\\\\nF^{\\prime}(G_{0})G&\\equiv F^{\\prime}(G_{0})G_{0}-F(G_{0})\\pmod{x^{2t}}\\\\\nG&\\equiv G_{0}-\\cfrac{F(G_{0})}{F^{\\prime}(G_{0})}\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$t\\geqslant n$$G_{0}$\n\n### [](https://www.luogu.org/problemnew/show/P4238)\n\n$n-1$$F(x)$$G(x)$\n\n$$F(x)\\times G(x)\\equiv 1\\pmod{x^{n}}$$\n\n$G_{0}$\n\n$$F\\times G_{0}\\equiv 1\\pmod{x^{t}}$$\n\n$G$\n\n$$F\\times G\\equiv 1\\pmod{x^{2t}}$$\n\n\n\n~~~~\n\n$$\\begin{aligned}\nF\\times G-F\\times G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\n(G-G_{0})^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG^{2}-2GG_{0}+G_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$F$\n\n$$\\begin{aligned}\nG-2G_{0}+FG_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG&\\equiv 2G_{0}-FG_{0}^{2}\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$t=1$$G[0]\\equiv F[0]^{-1}$\n\n\n\n\n\n\n\n### [](https://www.luogu.org/problemnew/show/P4725)\n\n$n-1$$F(x)$$G(x)$\n\n$$G(x)\\equiv\\ln F(x)\\pmod{x^{n}}$$\n\n\n\n$$G^{\\prime}\\equiv F^{\\prime}\\ln^{\\prime}F\\pmod{x^{n}}$$\n\n\n\n$$\\ln^{\\prime}x=\\frac{1}{x}$$\n\n\n\n$$G^{\\prime}\\equiv\\cfrac{F^{\\prime}}{F}\\pmod{x^{n}}$$\n\n++\n\n### [](https://www.luogu.org/problemnew/show/P4726)\n\n\n\n$n-1$$F(x)$$G(x)$\n\n$$G(x)\\equiv e^{F(x)}\\pmod{x^{n}}$$\n\n\n\n$$\\ln G-F\\equiv 0\\pmod{x^{n}}$$\n\n$F$\n\n$$A(G)=\\ln G-F$$\n\n$$A^{\\prime}(G)=\\ln^{\\prime}G=\\cfrac{1}{G}$$\n\n\n\n$$\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}(1-\\ln G_{0}+F)\\pmod{x^{2t}}\n\\end{aligned}$$\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define re register\n#define maxn 524288\n#define mod 998244353\n#define swap(a,b) a^=b,b^=a,a^=b\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n;\nint unit[2][24],rev[maxn+1],inv[maxn+1]={0,1},F[maxn+1],G[maxn+1],tmp1[maxn+1],tmp2[maxn+1],tmp3[maxn+1],tmp4[maxn+1];\n\ninline int cltpow(re int x,re int y){\n\tre int res=1;\n\tfor(;y;){\n\t\tif(y&1)\n\t\t\tres=1LL*res*x%mod;\n\t\tx=1LL*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\ninline void NTT(re int* F,re int n,re int tp){\n\tfor(re int i=0;i<n;++i)\n\t\tif(i<(rev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0)))\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(re int k=1,p=1;p<n;++k,p<<=1)\n\t\tfor(re int i=0;i<n;i+=p<<1)\n\t\t\tfor(re int j=i,tmp=1;j<i+p;++j,tmp=1LL*tmp*unit[tp][k]%mod){\n\t\t\t\tre int x=F[j],y=1LL*F[j+p]*tmp%mod;\n\t\t\t\tF[j]=(x+y)%mod;\n\t\t\t\tF[j+p]=(x-y+mod)%mod;\n\t\t\t}\n\tre int v=cltpow(n,tp*(mod-2));\n\tfor(re int i=0;i<n;++i)\n\t\tF[i]=1LL*F[i]*v%mod;\n}\n\ninline void Inv(re int* F,re int* G,re int n){\n\tG[0]=cltpow(F[0],mod-2);\n\tfor(re int i=1,j=4;i<n;i<<=1,j<<=1){\n\t\tfor(re int k=0;k<(i<<1);++k)\n\t\t\ttmp1[k]=F[k];\n\t\tNTT(tmp1,j,0);\n\t\tNTT(G,j,0);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\tG[k]=(2-1LL*tmp1[k]*G[k]%mod+mod)*G[k]%mod;\n\t\tNTT(G,j,1);\n\t\tfor(re int k=(i<<1);k<j;++k)\n\t\t\tG[k]=0;\n\t\tfor(re int k=0;k<j;++k)\n\t\t\ttmp1[k]=0;\n\t}\n}\n\ninline void Ln(re int* F,re int* G,re int n){\n\tfor(re int i=1;i<n;++i)\n\t\tG[i-1]=1LL*F[i]*i%mod;\n\tInv(F,tmp2,n);\n\tre int N=1;\n\tfor(;N<n;N<<=1);\n\tN<<=1;\n\tNTT(G,N,0);\n\tNTT(tmp2,N,0);\n\tfor(re int i=0;i<N;++i)\n\t\tG[i]=1LL*G[i]*tmp2[i]%mod;\n\tNTT(G,N,1);\n\tfor(re int i=n-1;i>=1;--i)\n\t\tG[i]=1LL*G[i-1]*inv[i]%mod;\n\tG[0]=0;\n\tfor(re int i=n;i<N;++i)\n\t\tG[i]=0;\n\tfor(re int i=0;i<N;++i)\n\t\ttmp2[i]=0;\n}\n\ninline void Exp(re int* F,re int* G,re int n){\n\tG[0]=1;\n\tfor(re int i=1,j=2;i<(n<<1);i<<=1,j<<=1){\n\t\tLn(G,tmp3,i);\n\t\tfor(re int k=0;k<i;++k)\n\t\t\ttmp4[k]=F[k];\n\t\tNTT(tmp3,j,0);\n\t\tNTT(tmp4,j,0);\n\t\tNTT(G,j,0);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\tG[k]=((1LL-tmp3[k]+tmp4[k])%mod+mod)*G[k]%mod;\n\t\tNTT(G,j,1);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\ttmp3[k]=tmp4[k]=0;\n\t}\n}\n\nint main(){\n\tunit[0][23]=cltpow(3,119);\n\tunit[1][23]=cltpow(332748118,119);\n\tfor(re int i=0;i<2;++i)\n\t\tfor(re int j=22;j>=0;--j)\n\t\t\tunit[i][j]=1LL*unit[i][j+1]*unit[i][j+1]%mod;\n\tfor(re int i=2;i<=maxn;++i)\n\t\tinv[i]=(mod-1LL*mod/i*inv[mod%i]%mod)%mod;\n\tcltstream::read(n);\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::read(F[i]);\n\tExp(F,G,n);\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::write(G[i],i<n-1?32:-1);\n\tclop();\n\treturn 0;\n}\n```\n\n### \n\n$n-1$$F(x)$$G(x)$\n\n$$G^{2}(x)\\equiv F(x)\\pmod{x^{n}}$$\n\n\n\n$$A(G)=G^{2}-F$$\n\n$$A^{\\prime}(G)=2G$$\n\n$$\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}-\\cfrac{G_{0}^{2}-F}{2G_{0}}\\\\\n&\\equiv\\cfrac{G_{0}^{2}+F}{2G_{0}}\\\\\n&=\\cfrac{1}{2}(G_{0}+\\cfrac{F}{G_{0}})\\pmod{x^{2t}}\n\\end{aligned}$$\n\n~~~~\n\n### \n\n[](http://codeforces.com/contest/438/problem/E)\n\n[Remote Judge](https://www.luogu.org/problemnew/show/CF438E)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3e4d32b6f.gif)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3e4d34c6e.jpg)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3f327ea74.jpg)\n\n\n\n\n\n\n\n$$G(x)=\\sum\\limits_{i=0}^{m}G[i]x^{i}$$\n\n\n\n$$G[i]=[i\\in\\{c_{1},c_{2},\\cdots,c_{n}\\}]$$\n\n$F[i]$$i$\n\n$$F[0]=1$$\n\n$$F[x]=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]$$\n\n$i$$j$$x-i-j$\n\n\n\n$$\\begin{aligned}\nF[x]&=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]\\\\\n&=\\sum\\limits_{i=0}^{x}G[i]F^{2}[x-i]\\\\\n&=(GF^{2})[x]\n\\end{aligned}$$\n\n\n\n\n\n$$GF^{2}+1=F$$\n\n$+1$$F(0)=F[0]=1$$G(0)=G[0]=0$\n\n\n\n$$F=\\cfrac{1\\pm\\sqrt{1-4G}}{2G}$$\n\n$(1\\mp\\sqrt{1-4G})$\n\n$$F=\\cfrac{2}{1\\mp\\sqrt{1-4G}}$$\n\n$x=0$$0$$\\cfrac{2}{2}=1$\n\n$$F=\\cfrac{2}{1+\\sqrt{1-4G}}$$\n\n~~~~","source":"_posts/2018-12-20-polynomial-learning-notes-pt2.md","raw":"---\nmathjax: true\ndate: 2018-12-20 16:58:39\ntitle: Part II\ntags:\n  - FFT\n  - NTT\ncategories:\n  - \n---\n$998244353$\n\n<!-- more -->\n\n### \n\n#### \n\n\n\nxjb\n\n$f(x)$$g(x)$$x$$x_{0}$$f(x)$\n\n\n\n$$g(x)=\\sum\\limits_{i=0}^{n}g[i](x-x_{0})^{i}$$\n\n$x\\rightarrow x_{0}$$g$$x$$f$$x_{0}$\n\n$0$$x\\rightarrow x_{0}$$x-x_{0}$\n\n$$g[0]=f(x_{0})$$\n\n$1$\n\n$$g^{\\prime}(x)=\\sum\\limits_{i=1}^{n}ig[i](x-x_{0})^{i-1}=g[1]=f^{\\prime}(x_{0})$$\n\n$2$\n\n$$g^{\\prime\\prime}(x)=\\sum\\limits_{i=2}^{n}i(i-1)g[i](x-x_{0})^{i-2}=2g[2]=f^{\\prime\\prime}(x_{0})$$\n\n$3$\n\n$$g^{\\prime\\prime\\prime}(x)=\\sum\\limits_{i=3}^{n}i(i-1)(i-2)g[i](x-x_{0})^{i-3}=6g[3]=f^{\\prime\\prime\\prime}(x_{0})$$\n\n$g[n]$\n\n$$g[n]=\\cfrac{f^{(n)}(x_{0})}{n!}$$\n\n\n\n$$g(x)=\\sum\\limits_{i=0}^{n}\\cfrac{f^{(i)}(x_{0})}{i!}(x-x_{0})^i$$\n\n~~~~\n\n#### \n\n$n-1$$F(x)$$G(x)$\n\n$$F(G(x))\\equiv 0\\pmod{x^{n}}$$\n\n$G_{0}$\n\n$$F(G_{0})\\equiv 0\\pmod{x^{t}}$$\n\n$G$\n\n$$F(G)\\equiv 0\\pmod{x^{2t}}$$\n\n$F$$G_{0}$\n\n$$\\begin{aligned}\nF(G)&=F(G_{0})\\\\\n&+F^{\\prime}(G_{0})(G-G_{0})\\\\\n&+\\cfrac{F^{\\prime\\prime}(G_{0})}{2}(G-G_{0})^{2}\\\\\n&+\\cdots\\end{aligned}$$\n\n\n\n$$\\begin{aligned}\nF(G)-F(G_{0})&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\n\\end{aligned}$$\n\n$G-G_{0}$$t$$(G-G_{0})^{k}$$kt$\n\n$$\\begin{aligned}\nF(G)&\\equiv F(G_{0})+F^{\\prime}(G_{0})(G-G_{0})\\pmod{x^{2t}}\\\\\nF^{\\prime}(G_{0})G&\\equiv F^{\\prime}(G_{0})G_{0}-F(G_{0})\\pmod{x^{2t}}\\\\\nG&\\equiv G_{0}-\\cfrac{F(G_{0})}{F^{\\prime}(G_{0})}\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$t\\geqslant n$$G_{0}$\n\n### [](https://www.luogu.org/problemnew/show/P4238)\n\n$n-1$$F(x)$$G(x)$\n\n$$F(x)\\times G(x)\\equiv 1\\pmod{x^{n}}$$\n\n$G_{0}$\n\n$$F\\times G_{0}\\equiv 1\\pmod{x^{t}}$$\n\n$G$\n\n$$F\\times G\\equiv 1\\pmod{x^{2t}}$$\n\n\n\n~~~~\n\n$$\\begin{aligned}\nF\\times G-F\\times G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\n(G-G_{0})^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG^{2}-2GG_{0}+G_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$F$\n\n$$\\begin{aligned}\nG-2G_{0}+FG_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG&\\equiv 2G_{0}-FG_{0}^{2}\\pmod{x^{2t}}\n\\end{aligned}$$\n\n$t=1$$G[0]\\equiv F[0]^{-1}$\n\n\n\n\n\n\n\n### [](https://www.luogu.org/problemnew/show/P4725)\n\n$n-1$$F(x)$$G(x)$\n\n$$G(x)\\equiv\\ln F(x)\\pmod{x^{n}}$$\n\n\n\n$$G^{\\prime}\\equiv F^{\\prime}\\ln^{\\prime}F\\pmod{x^{n}}$$\n\n\n\n$$\\ln^{\\prime}x=\\frac{1}{x}$$\n\n\n\n$$G^{\\prime}\\equiv\\cfrac{F^{\\prime}}{F}\\pmod{x^{n}}$$\n\n++\n\n### [](https://www.luogu.org/problemnew/show/P4726)\n\n\n\n$n-1$$F(x)$$G(x)$\n\n$$G(x)\\equiv e^{F(x)}\\pmod{x^{n}}$$\n\n\n\n$$\\ln G-F\\equiv 0\\pmod{x^{n}}$$\n\n$F$\n\n$$A(G)=\\ln G-F$$\n\n$$A^{\\prime}(G)=\\ln^{\\prime}G=\\cfrac{1}{G}$$\n\n\n\n$$\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}(1-\\ln G_{0}+F)\\pmod{x^{2t}}\n\\end{aligned}$$\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define re register\n#define maxn 524288\n#define mod 998244353\n#define swap(a,b) a^=b,b^=a,a^=b\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n;\nint unit[2][24],rev[maxn+1],inv[maxn+1]={0,1},F[maxn+1],G[maxn+1],tmp1[maxn+1],tmp2[maxn+1],tmp3[maxn+1],tmp4[maxn+1];\n\ninline int cltpow(re int x,re int y){\n\tre int res=1;\n\tfor(;y;){\n\t\tif(y&1)\n\t\t\tres=1LL*res*x%mod;\n\t\tx=1LL*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\ninline void NTT(re int* F,re int n,re int tp){\n\tfor(re int i=0;i<n;++i)\n\t\tif(i<(rev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0)))\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(re int k=1,p=1;p<n;++k,p<<=1)\n\t\tfor(re int i=0;i<n;i+=p<<1)\n\t\t\tfor(re int j=i,tmp=1;j<i+p;++j,tmp=1LL*tmp*unit[tp][k]%mod){\n\t\t\t\tre int x=F[j],y=1LL*F[j+p]*tmp%mod;\n\t\t\t\tF[j]=(x+y)%mod;\n\t\t\t\tF[j+p]=(x-y+mod)%mod;\n\t\t\t}\n\tre int v=cltpow(n,tp*(mod-2));\n\tfor(re int i=0;i<n;++i)\n\t\tF[i]=1LL*F[i]*v%mod;\n}\n\ninline void Inv(re int* F,re int* G,re int n){\n\tG[0]=cltpow(F[0],mod-2);\n\tfor(re int i=1,j=4;i<n;i<<=1,j<<=1){\n\t\tfor(re int k=0;k<(i<<1);++k)\n\t\t\ttmp1[k]=F[k];\n\t\tNTT(tmp1,j,0);\n\t\tNTT(G,j,0);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\tG[k]=(2-1LL*tmp1[k]*G[k]%mod+mod)*G[k]%mod;\n\t\tNTT(G,j,1);\n\t\tfor(re int k=(i<<1);k<j;++k)\n\t\t\tG[k]=0;\n\t\tfor(re int k=0;k<j;++k)\n\t\t\ttmp1[k]=0;\n\t}\n}\n\ninline void Ln(re int* F,re int* G,re int n){\n\tfor(re int i=1;i<n;++i)\n\t\tG[i-1]=1LL*F[i]*i%mod;\n\tInv(F,tmp2,n);\n\tre int N=1;\n\tfor(;N<n;N<<=1);\n\tN<<=1;\n\tNTT(G,N,0);\n\tNTT(tmp2,N,0);\n\tfor(re int i=0;i<N;++i)\n\t\tG[i]=1LL*G[i]*tmp2[i]%mod;\n\tNTT(G,N,1);\n\tfor(re int i=n-1;i>=1;--i)\n\t\tG[i]=1LL*G[i-1]*inv[i]%mod;\n\tG[0]=0;\n\tfor(re int i=n;i<N;++i)\n\t\tG[i]=0;\n\tfor(re int i=0;i<N;++i)\n\t\ttmp2[i]=0;\n}\n\ninline void Exp(re int* F,re int* G,re int n){\n\tG[0]=1;\n\tfor(re int i=1,j=2;i<(n<<1);i<<=1,j<<=1){\n\t\tLn(G,tmp3,i);\n\t\tfor(re int k=0;k<i;++k)\n\t\t\ttmp4[k]=F[k];\n\t\tNTT(tmp3,j,0);\n\t\tNTT(tmp4,j,0);\n\t\tNTT(G,j,0);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\tG[k]=((1LL-tmp3[k]+tmp4[k])%mod+mod)*G[k]%mod;\n\t\tNTT(G,j,1);\n\t\tfor(re int k=0;k<j;++k)\n\t\t\ttmp3[k]=tmp4[k]=0;\n\t}\n}\n\nint main(){\n\tunit[0][23]=cltpow(3,119);\n\tunit[1][23]=cltpow(332748118,119);\n\tfor(re int i=0;i<2;++i)\n\t\tfor(re int j=22;j>=0;--j)\n\t\t\tunit[i][j]=1LL*unit[i][j+1]*unit[i][j+1]%mod;\n\tfor(re int i=2;i<=maxn;++i)\n\t\tinv[i]=(mod-1LL*mod/i*inv[mod%i]%mod)%mod;\n\tcltstream::read(n);\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::read(F[i]);\n\tExp(F,G,n);\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::write(G[i],i<n-1?32:-1);\n\tclop();\n\treturn 0;\n}\n```\n\n### \n\n$n-1$$F(x)$$G(x)$\n\n$$G^{2}(x)\\equiv F(x)\\pmod{x^{n}}$$\n\n\n\n$$A(G)=G^{2}-F$$\n\n$$A^{\\prime}(G)=2G$$\n\n$$\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}-\\cfrac{G_{0}^{2}-F}{2G_{0}}\\\\\n&\\equiv\\cfrac{G_{0}^{2}+F}{2G_{0}}\\\\\n&=\\cfrac{1}{2}(G_{0}+\\cfrac{F}{G_{0}})\\pmod{x^{2t}}\n\\end{aligned}$$\n\n~~~~\n\n### \n\n[](http://codeforces.com/contest/438/problem/E)\n\n[Remote Judge](https://www.luogu.org/problemnew/show/CF438E)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3e4d32b6f.gif)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3e4d34c6e.jpg)\n\n\n\n![](https://i.loli.net/2018/12/21/5c1c3f327ea74.jpg)\n\n\n\n\n\n\n\n$$G(x)=\\sum\\limits_{i=0}^{m}G[i]x^{i}$$\n\n\n\n$$G[i]=[i\\in\\{c_{1},c_{2},\\cdots,c_{n}\\}]$$\n\n$F[i]$$i$\n\n$$F[0]=1$$\n\n$$F[x]=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]$$\n\n$i$$j$$x-i-j$\n\n\n\n$$\\begin{aligned}\nF[x]&=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]\\\\\n&=\\sum\\limits_{i=0}^{x}G[i]F^{2}[x-i]\\\\\n&=(GF^{2})[x]\n\\end{aligned}$$\n\n\n\n\n\n$$GF^{2}+1=F$$\n\n$+1$$F(0)=F[0]=1$$G(0)=G[0]=0$\n\n\n\n$$F=\\cfrac{1\\pm\\sqrt{1-4G}}{2G}$$\n\n$(1\\mp\\sqrt{1-4G})$\n\n$$F=\\cfrac{2}{1\\mp\\sqrt{1-4G}}$$\n\n$x=0$$0$$\\cfrac{2}{2}=1$\n\n$$F=\\cfrac{2}{1+\\sqrt{1-4G}}$$\n\n~~~~","slug":"polynomial-learning-notes-pt2","published":1,"updated":"2018-12-23T03:26:13.483Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w3f002egwgugusfxwy5","content":"<p>$998244353$</p>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>xjb</p>\n<p>$f(x)$$g(x)$$x$$x_{0}$$f(x)$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=0}^{n}g[i](x-x_{0})^{i}</script><p>$x\\rightarrow x_{0}$$g$$x$$f$$x_{0}$</p>\n<p>$0$$x\\rightarrow x_{0}$$x-x_{0}$</p>\n<script type=\"math/tex; mode=display\">g[0]=f(x_{0})</script><p>$1$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime}(x)=\\sum\\limits_{i=1}^{n}ig[i](x-x_{0})^{i-1}=g[1]=f^{\\prime}(x_{0})</script><p>$2$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime\\prime}(x)=\\sum\\limits_{i=2}^{n}i(i-1)g[i](x-x_{0})^{i-2}=2g[2]=f^{\\prime\\prime}(x_{0})</script><p>$3$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime\\prime\\prime}(x)=\\sum\\limits_{i=3}^{n}i(i-1)(i-2)g[i](x-x_{0})^{i-3}=6g[3]=f^{\\prime\\prime\\prime}(x_{0})</script><p>$g[n]$</p>\n<script type=\"math/tex; mode=display\">g[n]=\\cfrac{f^{(n)}(x_{0})}{n!}</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=0}^{n}\\cfrac{f^{(i)}(x_{0})}{i!}(x-x_{0})^i</script><p><del></del></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">F(G(x))\\equiv 0\\pmod{x^{n}}</script><p>$G_{0}$</p>\n<script type=\"math/tex; mode=display\">F(G_{0})\\equiv 0\\pmod{x^{t}}</script><p>$G$</p>\n<script type=\"math/tex; mode=display\">F(G)\\equiv 0\\pmod{x^{2t}}</script><p>$F$$G_{0}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)&=F(G_{0})\\\\\n&+F^{\\prime}(G_{0})(G-G_{0})\\\\\n&+\\cfrac{F^{\\prime\\prime}(G_{0})}{2}(G-G_{0})^{2}\\\\\n&+\\cdots\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)-F(G_{0})&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\n\\end{aligned}</script><p>$G-G_{0}$$t$$(G-G_{0})^{k}$$kt$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)&\\equiv F(G_{0})+F^{\\prime}(G_{0})(G-G_{0})\\pmod{x^{2t}}\\\\\nF^{\\prime}(G_{0})G&\\equiv F^{\\prime}(G_{0})G_{0}-F(G_{0})\\pmod{x^{2t}}\\\\\nG&\\equiv G_{0}-\\cfrac{F(G_{0})}{F^{\\prime}(G_{0})}\\pmod{x^{2t}}\n\\end{aligned}</script><p>$t\\geqslant n$$G_{0}$</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4238\" target=\"_blank\" rel=\"noopener\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">F(x)\\times G(x)\\equiv 1\\pmod{x^{n}}</script><p>$G_{0}$</p>\n<script type=\"math/tex; mode=display\">F\\times G_{0}\\equiv 1\\pmod{x^{t}}</script><p>$G$</p>\n<script type=\"math/tex; mode=display\">F\\times G\\equiv 1\\pmod{x^{2t}}</script><p></p>\n<p><del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF\\times G-F\\times G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\n(G-G_{0})^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG^{2}-2GG_{0}+G_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\n\\end{aligned}</script><p>$F$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nG-2G_{0}+FG_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG&\\equiv 2G_{0}-FG_{0}^{2}\\pmod{x^{2t}}\n\\end{aligned}</script><p>$t=1$$G[0]\\equiv F[0]^{-1}$</p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4725\" target=\"_blank\" rel=\"noopener\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G(x)\\equiv\\ln F(x)\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">G^{\\prime}\\equiv F^{\\prime}\\ln^{\\prime}F\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\ln^{\\prime}x=\\frac{1}{x}</script><p></p>\n<script type=\"math/tex; mode=display\">G^{\\prime}\\equiv\\cfrac{F^{\\prime}}{F}\\pmod{x^{n}}</script><p>++</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4726\" target=\"_blank\" rel=\"noopener\"></a></h3><p></p>\n<p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G(x)\\equiv e^{F(x)}\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\ln G-F\\equiv 0\\pmod{x^{n}}</script><p>$F$</p>\n<script type=\"math/tex; mode=display\">A(G)=\\ln G-F</script><script type=\"math/tex; mode=display\">A^{\\prime}(G)=\\ln^{\\prime}G=\\cfrac{1}{G}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}(1-\\ln G_{0}+F)\\pmod{x^{2t}}\n\\end{aligned}</script><p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 524288</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> swap(a,b) a^=b,b^=a,a^=b</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">int</span> unit[<span class=\"number\">2</span>][<span class=\"number\">24</span>],rev[maxn+<span class=\"number\">1</span>],inv[maxn+<span class=\"number\">1</span>]=&#123;<span class=\"number\">0</span>,<span class=\"number\">1</span>&#125;,F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>],tmp1[maxn+<span class=\"number\">1</span>],tmp2[maxn+<span class=\"number\">1</span>],tmp3[maxn+<span class=\"number\">1</span>],tmp4[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(re <span class=\"keyword\">int</span> x,re <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> res=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;y;)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tres=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">\t\tx=<span class=\"number\">1L</span>L*x*x%mod;</span><br><span class=\"line\">\t\ty&gt;&gt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span> n,re <span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;(rev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>)))</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">1</span>,p=<span class=\"number\">1</span>;p&lt;n;++k,p&lt;&lt;=<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=p&lt;&lt;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=i,tmp=<span class=\"number\">1</span>;j&lt;i+p;++j,tmp=<span class=\"number\">1L</span>L*tmp*unit[tp][k]%mod)&#123;</span><br><span class=\"line\">\t\t\t\tre <span class=\"keyword\">int</span> x=F[j],y=<span class=\"number\">1L</span>L*F[j+p]*tmp%mod;</span><br><span class=\"line\">\t\t\t\tF[j]=(x+y)%mod;</span><br><span class=\"line\">\t\t\t\tF[j+p]=(x-y+mod)%mod;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> v=cltpow(n,tp*(mod<span class=\"number\">-2</span>));</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=<span class=\"number\">1L</span>L*F[i]*v%mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=cltpow(F[<span class=\"number\">0</span>],mod<span class=\"number\">-2</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>,j=<span class=\"number\">4</span>;i&lt;n;i&lt;&lt;=<span class=\"number\">1</span>,j&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(i&lt;&lt;<span class=\"number\">1</span>);++k)</span><br><span class=\"line\">\t\t\ttmp1[k]=F[k];</span><br><span class=\"line\">\t\tNTT(tmp1,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=(<span class=\"number\">2</span><span class=\"number\">-1L</span>L*tmp1[k]*G[k]%mod+mod)*G[k]%mod;</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(i&lt;&lt;<span class=\"number\">1</span>);k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\ttmp1[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Ln</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tG[i<span class=\"number\">-1</span>]=<span class=\"number\">1L</span>L*F[i]*i%mod;</span><br><span class=\"line\">\tInv(F,tmp2,n);</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> N=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;N&lt;n;N&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\tN&lt;&lt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\tNTT(G,N,<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(tmp2,N,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;N;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1L</span>L*G[i]*tmp2[i]%mod;</span><br><span class=\"line\">\tNTT(G,N,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">1</span>;--i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1L</span>L*G[i<span class=\"number\">-1</span>]*inv[i]%mod;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=n;i&lt;N;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;N;++i)</span><br><span class=\"line\">\t\ttmp2[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Exp</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>,j=<span class=\"number\">2</span>;i&lt;(n&lt;&lt;<span class=\"number\">1</span>);i&lt;&lt;=<span class=\"number\">1</span>,j&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tLn(G,tmp3,i);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;i;++k)</span><br><span class=\"line\">\t\t\ttmp4[k]=F[k];</span><br><span class=\"line\">\t\tNTT(tmp3,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(tmp4,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=((<span class=\"number\">1L</span>L-tmp3[k]+tmp4[k])%mod+mod)*G[k]%mod;</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\ttmp3[k]=tmp4[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tunit[<span class=\"number\">0</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">3</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\tunit[<span class=\"number\">1</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">332748118</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">2</span>;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">22</span>;j&gt;=<span class=\"number\">0</span>;--j)</span><br><span class=\"line\">\t\t\tunit[i][j]=<span class=\"number\">1L</span>L*unit[i][j+<span class=\"number\">1</span>]*unit[i][j+<span class=\"number\">1</span>]%mod;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=maxn;++i)</span><br><span class=\"line\">\t\tinv[i]=(mod<span class=\"number\">-1L</span>L*mod/i*inv[mod%i]%mod)%mod;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::read(F[i]);</span><br><span class=\"line\">\tExp(F,G,n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::write(G[i],i&lt;n<span class=\"number\">-1</span>?<span class=\"number\">32</span>:<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G^{2}(x)\\equiv F(x)\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">A(G)=G^{2}-F</script><script type=\"math/tex; mode=display\">A^{\\prime}(G)=2G</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}-\\cfrac{G_{0}^{2}-F}{2G_{0}}\\\\\n&\\equiv\\cfrac{G_{0}^{2}+F}{2G_{0}}\\\\\n&=\\cfrac{1}{2}(G_{0}+\\cfrac{F}{G_{0}})\\pmod{x^{2t}}\n\\end{aligned}</script><p><del></del></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://codeforces.com/contest/438/problem/E\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/CF438E\" target=\"_blank\" rel=\"noopener\">Remote Judge</a></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3e4d32b6f.gif\" alt=\"\"></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3e4d34c6e.jpg\" alt=\"\"></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3f327ea74.jpg\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{m}G[i]x^{i}</script><p></p>\n<script type=\"math/tex; mode=display\">G[i]=[i\\in\\{c_{1},c_{2},\\cdots,c_{n}\\}]</script><p>$F[i]$$i$</p>\n<script type=\"math/tex; mode=display\">F[0]=1</script><script type=\"math/tex; mode=display\">F[x]=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]</script><p>$i$$j$$x-i-j$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF[x]&=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]\\\\\n&=\\sum\\limits_{i=0}^{x}G[i]F^{2}[x-i]\\\\\n&=(GF^{2})[x]\n\\end{aligned}</script><p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">GF^{2}+1=F</script><p>$+1$$F(0)=F[0]=1$$G(0)=G[0]=0$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{1\\pm\\sqrt{1-4G}}{2G}</script><p>$(1\\mp\\sqrt{1-4G})$</p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{2}{1\\mp\\sqrt{1-4G}}</script><p>$x=0$$0$$\\cfrac{2}{2}=1$</p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{2}{1+\\sqrt{1-4G}}</script><p><del></del></p>\n","site":{"data":{}},"excerpt":"<p>$998244353$</p>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>xjb</p>\n<p>$f(x)$$g(x)$$x$$x_{0}$$f(x)$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=0}^{n}g[i](x-x_{0})^{i}</script><p>$x\\rightarrow x_{0}$$g$$x$$f$$x_{0}$</p>\n<p>$0$$x\\rightarrow x_{0}$$x-x_{0}$</p>\n<script type=\"math/tex; mode=display\">g[0]=f(x_{0})</script><p>$1$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime}(x)=\\sum\\limits_{i=1}^{n}ig[i](x-x_{0})^{i-1}=g[1]=f^{\\prime}(x_{0})</script><p>$2$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime\\prime}(x)=\\sum\\limits_{i=2}^{n}i(i-1)g[i](x-x_{0})^{i-2}=2g[2]=f^{\\prime\\prime}(x_{0})</script><p>$3$</p>\n<script type=\"math/tex; mode=display\">g^{\\prime\\prime\\prime}(x)=\\sum\\limits_{i=3}^{n}i(i-1)(i-2)g[i](x-x_{0})^{i-3}=6g[3]=f^{\\prime\\prime\\prime}(x_{0})</script><p>$g[n]$</p>\n<script type=\"math/tex; mode=display\">g[n]=\\cfrac{f^{(n)}(x_{0})}{n!}</script><p></p>\n<script type=\"math/tex; mode=display\">g(x)=\\sum\\limits_{i=0}^{n}\\cfrac{f^{(i)}(x_{0})}{i!}(x-x_{0})^i</script><p><del></del></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">F(G(x))\\equiv 0\\pmod{x^{n}}</script><p>$G_{0}$</p>\n<script type=\"math/tex; mode=display\">F(G_{0})\\equiv 0\\pmod{x^{t}}</script><p>$G$</p>\n<script type=\"math/tex; mode=display\">F(G)\\equiv 0\\pmod{x^{2t}}</script><p>$F$$G_{0}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)&=F(G_{0})\\\\\n&+F^{\\prime}(G_{0})(G-G_{0})\\\\\n&+\\cfrac{F^{\\prime\\prime}(G_{0})}{2}(G-G_{0})^{2}\\\\\n&+\\cdots\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)-F(G_{0})&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\n\\end{aligned}</script><p>$G-G_{0}$$t$$(G-G_{0})^{k}$$kt$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(G)&\\equiv F(G_{0})+F^{\\prime}(G_{0})(G-G_{0})\\pmod{x^{2t}}\\\\\nF^{\\prime}(G_{0})G&\\equiv F^{\\prime}(G_{0})G_{0}-F(G_{0})\\pmod{x^{2t}}\\\\\nG&\\equiv G_{0}-\\cfrac{F(G_{0})}{F^{\\prime}(G_{0})}\\pmod{x^{2t}}\n\\end{aligned}</script><p>$t\\geqslant n$$G_{0}$</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4238\" target=\"_blank\" rel=\"noopener\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">F(x)\\times G(x)\\equiv 1\\pmod{x^{n}}</script><p>$G_{0}$</p>\n<script type=\"math/tex; mode=display\">F\\times G_{0}\\equiv 1\\pmod{x^{t}}</script><p>$G$</p>\n<script type=\"math/tex; mode=display\">F\\times G\\equiv 1\\pmod{x^{2t}}</script><p></p>\n<p><del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF\\times G-F\\times G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\nG-G_{0}&\\equiv 0\\pmod{x^{t}}\\\\\n(G-G_{0})^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG^{2}-2GG_{0}+G_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\n\\end{aligned}</script><p>$F$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nG-2G_{0}+FG_{0}^{2}&\\equiv 0\\pmod{x^{2t}}\\\\\nG&\\equiv 2G_{0}-FG_{0}^{2}\\pmod{x^{2t}}\n\\end{aligned}</script><p>$t=1$$G[0]\\equiv F[0]^{-1}$</p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4725\" target=\"_blank\" rel=\"noopener\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G(x)\\equiv\\ln F(x)\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">G^{\\prime}\\equiv F^{\\prime}\\ln^{\\prime}F\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\ln^{\\prime}x=\\frac{1}{x}</script><p></p>\n<script type=\"math/tex; mode=display\">G^{\\prime}\\equiv\\cfrac{F^{\\prime}}{F}\\pmod{x^{n}}</script><p>++</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"https://www.luogu.org/problemnew/show/P4726\" target=\"_blank\" rel=\"noopener\"></a></h3><p></p>\n<p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G(x)\\equiv e^{F(x)}\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\ln G-F\\equiv 0\\pmod{x^{n}}</script><p>$F$</p>\n<script type=\"math/tex; mode=display\">A(G)=\\ln G-F</script><script type=\"math/tex; mode=display\">A^{\\prime}(G)=\\ln^{\\prime}G=\\cfrac{1}{G}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}(1-\\ln G_{0}+F)\\pmod{x^{2t}}\n\\end{aligned}</script><p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 524288</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> swap(a,b) a^=b,b^=a,a^=b</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">int</span> unit[<span class=\"number\">2</span>][<span class=\"number\">24</span>],rev[maxn+<span class=\"number\">1</span>],inv[maxn+<span class=\"number\">1</span>]=&#123;<span class=\"number\">0</span>,<span class=\"number\">1</span>&#125;,F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>],tmp1[maxn+<span class=\"number\">1</span>],tmp2[maxn+<span class=\"number\">1</span>],tmp3[maxn+<span class=\"number\">1</span>],tmp4[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(re <span class=\"keyword\">int</span> x,re <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> res=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;y;)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tres=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">\t\tx=<span class=\"number\">1L</span>L*x*x%mod;</span><br><span class=\"line\">\t\ty&gt;&gt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span> n,re <span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;(rev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>)))</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">1</span>,p=<span class=\"number\">1</span>;p&lt;n;++k,p&lt;&lt;=<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=p&lt;&lt;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=i,tmp=<span class=\"number\">1</span>;j&lt;i+p;++j,tmp=<span class=\"number\">1L</span>L*tmp*unit[tp][k]%mod)&#123;</span><br><span class=\"line\">\t\t\t\tre <span class=\"keyword\">int</span> x=F[j],y=<span class=\"number\">1L</span>L*F[j+p]*tmp%mod;</span><br><span class=\"line\">\t\t\t\tF[j]=(x+y)%mod;</span><br><span class=\"line\">\t\t\t\tF[j+p]=(x-y+mod)%mod;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> v=cltpow(n,tp*(mod<span class=\"number\">-2</span>));</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=<span class=\"number\">1L</span>L*F[i]*v%mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=cltpow(F[<span class=\"number\">0</span>],mod<span class=\"number\">-2</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>,j=<span class=\"number\">4</span>;i&lt;n;i&lt;&lt;=<span class=\"number\">1</span>,j&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;(i&lt;&lt;<span class=\"number\">1</span>);++k)</span><br><span class=\"line\">\t\t\ttmp1[k]=F[k];</span><br><span class=\"line\">\t\tNTT(tmp1,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=(<span class=\"number\">2</span><span class=\"number\">-1L</span>L*tmp1[k]*G[k]%mod+mod)*G[k]%mod;</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=(i&lt;&lt;<span class=\"number\">1</span>);k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\ttmp1[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Ln</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tG[i<span class=\"number\">-1</span>]=<span class=\"number\">1L</span>L*F[i]*i%mod;</span><br><span class=\"line\">\tInv(F,tmp2,n);</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> N=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;N&lt;n;N&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\tN&lt;&lt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\tNTT(G,N,<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(tmp2,N,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;N;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1L</span>L*G[i]*tmp2[i]%mod;</span><br><span class=\"line\">\tNTT(G,N,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">1</span>;--i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1L</span>L*G[i<span class=\"number\">-1</span>]*inv[i]%mod;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=n;i&lt;N;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;N;++i)</span><br><span class=\"line\">\t\ttmp2[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">Exp</span><span class=\"params\">(re <span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span>* G,re <span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\tG[<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>,j=<span class=\"number\">2</span>;i&lt;(n&lt;&lt;<span class=\"number\">1</span>);i&lt;&lt;=<span class=\"number\">1</span>,j&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tLn(G,tmp3,i);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;i;++k)</span><br><span class=\"line\">\t\t\ttmp4[k]=F[k];</span><br><span class=\"line\">\t\tNTT(tmp3,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(tmp4,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\tG[k]=((<span class=\"number\">1L</span>L-tmp3[k]+tmp4[k])%mod+mod)*G[k]%mod;</span><br><span class=\"line\">\t\tNTT(G,j,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;j;++k)</span><br><span class=\"line\">\t\t\ttmp3[k]=tmp4[k]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tunit[<span class=\"number\">0</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">3</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\tunit[<span class=\"number\">1</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">332748118</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">2</span>;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">22</span>;j&gt;=<span class=\"number\">0</span>;--j)</span><br><span class=\"line\">\t\t\tunit[i][j]=<span class=\"number\">1L</span>L*unit[i][j+<span class=\"number\">1</span>]*unit[i][j+<span class=\"number\">1</span>]%mod;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=maxn;++i)</span><br><span class=\"line\">\t\tinv[i]=(mod<span class=\"number\">-1L</span>L*mod/i*inv[mod%i]%mod)%mod;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::read(F[i]);</span><br><span class=\"line\">\tExp(F,G,n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::write(G[i],i&lt;n<span class=\"number\">-1</span>?<span class=\"number\">32</span>:<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>$n-1$$F(x)$$G(x)$</p>\n<script type=\"math/tex; mode=display\">G^{2}(x)\\equiv F(x)\\pmod{x^{n}}</script><p></p>\n<script type=\"math/tex; mode=display\">A(G)=G^{2}-F</script><script type=\"math/tex; mode=display\">A^{\\prime}(G)=2G</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nG&\\equiv G_{0}-\\cfrac{A(G_{0})}{A{^\\prime}(G_{0})}\\\\\n&\\equiv G_{0}-\\cfrac{G_{0}^{2}-F}{2G_{0}}\\\\\n&\\equiv\\cfrac{G_{0}^{2}+F}{2G_{0}}\\\\\n&=\\cfrac{1}{2}(G_{0}+\\cfrac{F}{G_{0}})\\pmod{x^{2t}}\n\\end{aligned}</script><p><del></del></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://codeforces.com/contest/438/problem/E\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/CF438E\" target=\"_blank\" rel=\"noopener\">Remote Judge</a></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3e4d32b6f.gif\" alt=\"\"></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3e4d34c6e.jpg\" alt=\"\"></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2018/12/21/5c1c3f327ea74.jpg\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{m}G[i]x^{i}</script><p></p>\n<script type=\"math/tex; mode=display\">G[i]=[i\\in\\{c_{1},c_{2},\\cdots,c_{n}\\}]</script><p>$F[i]$$i$</p>\n<script type=\"math/tex; mode=display\">F[0]=1</script><script type=\"math/tex; mode=display\">F[x]=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]</script><p>$i$$j$$x-i-j$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF[x]&=\\sum\\limits_{i=0}^{x}G[i]\\sum\\limits_{j=0}^{x-i}F[j]F[x-i-j]\\\\\n&=\\sum\\limits_{i=0}^{x}G[i]F^{2}[x-i]\\\\\n&=(GF^{2})[x]\n\\end{aligned}</script><p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">GF^{2}+1=F</script><p>$+1$$F(0)=F[0]=1$$G(0)=G[0]=0$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{1\\pm\\sqrt{1-4G}}{2G}</script><p>$(1\\mp\\sqrt{1-4G})$</p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{2}{1\\mp\\sqrt{1-4G}}</script><p>$x=0$$0$$\\cfrac{2}{2}=1$</p>\n<script type=\"math/tex; mode=display\">F=\\cfrac{2}{1+\\sqrt{1-4G}}</script><p><del></del></p>"},{"mathjax":true,"date":"2018-12-26T12:17:22.000Z","title":"","_content":"[](https://www.luogu.org/team/show?teamid=11367)\n\n<!-- more -->\n\n# [T47720](https://www.luogu.org/problemnew/show/T47720)\n\n[](/luogu-t47720-solution/)\n\n# [T53537](https://www.luogu.org/problemnew/show/T53537)\n\n[](https://www.luogu.org/problemnew/show/P4117)\n\nJF~~~~\n\ntag`set`\n\n$1$$k$$k$$k$$k$$k$$k$\n\n$2$~~~~\n\n$3$`lower_bound`\n\n\n\n```cpp\n#include<cstdio>\n#include<set>\n#define re register\n#define maxn 100000\n#define maxm 100000\n#define maxblock 320\n#define maxval 200000\n#define mod 998244353\n#define max(a,b) ((a)>=(b)?(a):(b))\n#define min(a,b) ((a)<=(b)?(a):(b))\n\nnamespace cltstream{\n    #define size 1048576\n    char cltin[size+1],*ih=cltin,*it=cltin;\n    inline char gc(){\n        #ifdef ONLINE_JUDGE\n            if(ih==it){\n                it=(ih=cltin)+fread(cltin,1,size,stdin);\n                if(ih==it)\n                    return EOF;\n            }\n            return *ih++;\n        #else\n            return getchar();\n        #endif\n    }\n\n    char cltout[size+1],*oh=cltout;\n    int outcnt=0;\n    inline void pc(char c){\n        if(c==-1)\n            fwrite(cltout,1,outcnt,stdout);\n        else{\n            if(outcnt==size){\n                fwrite(cltout,1,size,stdout);\n                oh=cltout;\n                outcnt=0;\n            }\n            *oh++=c;\n            ++outcnt;\n        }\n    }\n    #undef size\n\n    template <typename _tp>\n    inline void read(_tp& x){\n        int sn=1;\n        char c=gc();\n        for(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n        if(c==45&&c!=EOF)\n            sn=-1,c=gc();\n        for(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n        x*=sn;\n    }\n\n    template <typename _tp>\n    inline void write(_tp x,char text=' '){\n        if(x<0)\n            pc(45),x=-x;\n        if(!x)\n            pc(48);\n        else{\n            int digit[22];\n            for(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n            for(;digit[0];pc(digit[digit[0]--]^48));\n        }\n        pc(text);\n    }\n}\n\nint n,m,size;\nint a[maxn+1],id[maxn+1];\nint val[maxn+1],f[maxn+1];\nint pos[maxblock+1][maxval+1];\nint maxv[maxblock+1],minv[maxblock+1],tag[maxblock+1],sam[maxblock+1];\nstd::set<int> s[maxblock+1];\n\nint find(int x){\n    return f[x]==x?x:f[x]=find(f[x]);\n}\n\ninline void init(int x){\n    maxv[x]=-2e9;\n    minv[x]=2e9;\n    for(re int i=(x-1)*size+1;i<=x*size&&i<=n;++i)\n        if(!pos[x][a[i]]){\n            val[i]=a[i];\n            f[i]=i;\n            pos[x][a[i]]=i;\n            maxv[x]=max(maxv[x],a[i]);\n            minv[x]=min(minv[x],a[i]);\n            s[x].insert(a[i]);\n        }\n        else\n            f[i]=pos[x][a[i]];\n}\n\ninline void destory(int x){\n    for(re int i=(x-1)*size+1;i<=x*size&&i<=n;++i){\n        a[i]=sam[x]?sam[x]:val[find(i)]+tag[x];\n        pos[x][val[i]]=0;\n    }\n    tag[x]=sam[x]=0;\n    s[x].clear();\n}\n\ninline void solve(int x,int y){\n    if(sam[x]){\n        if(sam[x]>y)\n            sam[x]-=y;\n        return;\n    }\n    if(maxv[x]-(y-tag[x])<=(y-tag[x])-minv[x]+1){\n        for(re int i=(y-tag[x])+1;i<=maxv[x];++i)\n            if(pos[x][i]){\n                s[x].erase(i);\n                if(!pos[x][i-y]){\n                    val[pos[x][i]]-=y;\n                    pos[x][i-y]=pos[x][i];\n                    s[x].insert(i-y);\n                }\n                else\n                    if(pos[x][i]>pos[x][i-y])\n                        f[pos[x][i]]=pos[x][i-y];\n                    else{\n                        f[pos[x][i-y]]=pos[x][i];\n                        pos[x][i-y]=pos[x][i];\n                        val[pos[x][i-y]]-=y;\n                    }\n                pos[x][i]=0;\n            }\n    }\n    else{\n        for(re int i=(y-tag[x]);i>=minv[x];--i)\n            if(pos[x][i]){\n                s[x].erase(i);\n                if(!pos[x][i+y]){\n                    val[pos[x][i]]+=y;\n                    pos[x][i+y]=pos[x][i];\n                    s[x].insert(i+y);\n                }\n                else\n                    if(pos[x][i]>pos[x][i+y])\n                        f[pos[x][i]]=pos[x][i+y];\n                    else{\n                        f[pos[x][i+y]]=pos[x][i];\n                        pos[x][i+y]=pos[x][i];\n                        val[pos[x][i+y]]+=y;\n                    }\n                pos[x][i]=0;\n            }\n        tag[x]-=y;\n    }\n    minv[x]=*s[x].begin();\n    std::set<int>::iterator it=s[x].end();\n    --it;\n    maxv[x]=*it;\n}\n\ninline void IntervalCut(int l,int r,int x){\n    int L=id[l],R=id[r];\n    destory(L);\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        if(a[i]>x)\n            a[i]-=x;\n    init(L);\n    for(re int i=L+1;i<=R-1;++i)\n        solve(i,x);\n    if(L<R){\n        destory(R);\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            if(a[i]>x)\n                a[i]-=x;\n        init(R);\n    }\n}\n\ninline void IntervalAssignToMin(int l,int r){\n    int L=id[l],R=id[r],res=2e9;\n    destory(L);\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        res=min(res,a[i]);\n    for(re int i=L+1;i<=R-1;++i)\n        res=min(res,sam[i]?sam[i]:minv[i]+tag[i]);\n    if(L<R){\n        destory(R);\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            res=min(res,a[i]);\n    }\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        a[i]=res;\n    init(L);\n    for(re int i=L+1;i<=R-1;++i)\n        sam[i]=res;\n    if(L<R){\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            a[i]=res;\n        init(R);\n    }\n}\n\ninline void IntervalPre(int l,int r,int x){\n    int L=id[l],R=id[r],p=0,res=-2e9;\n    if(sam[L]){\n        if(sam[L]<x&&sam[L]>res){\n            p=l;\n            res=sam[L];\n        }\n    }\n    else\n        for(re int i=l;i<=L*size&&i<=r;++i)\n            if(val[find(i)]+tag[L]<x&&val[find(i)]+tag[L]>res){\n                p=i;\n                res=val[f[i]]+tag[L];\n            }\n    for(re int i=L+1;i<=R-1;++i)\n        if(sam[i]){\n            if(sam[i]<x&&sam[i]>res){\n                p=(i-1)*size+1;\n                res=sam[i];\n            }\n        }\n        else{\n            std::set<int>::iterator it=s[i].lower_bound(x-tag[i]);\n            if(it!=s[i].begin()){\n                --it;\n                if(*it+tag[i]<x&&*it+tag[i]>res){\n                    p=pos[i][*it];\n                    res=*it+tag[i];\n                }\n            }\n        }\n    if(L<R){\n        if(sam[R]){\n            if(sam[R]<x&&sam[R]>res){\n                p=(R-1)*size+1;\n                res=sam[R];\n            }\n        }\n        else\n            for(re int i=(R-1)*size+1;i<=r;++i)\n                if(val[find(i)]+tag[R]<x&&val[find(i)]+tag[R]>res){\n                    p=i;\n                    res=val[f[i]]+tag[R];\n                }\n    }\n    if(p)\n        cltstream::write(p,'\\n');\n    else{\n        cltstream::pc('G');\n        cltstream::pc('R');\n        cltstream::pc('E');\n        cltstream::pc('A');\n        cltstream::pc('T');\n        cltstream::pc(10);\n    }\n}\n\nint main(){\n    cltstream::read(n);\n    cltstream::read(m);\n    for(re int i=1;i<=n;++i)\n        cltstream::read(a[i]);\n    for(;(size+1)*(size+1)<=n;++size);\n    for(re int i=1;(i-1)*size+1<=n;++i){\n        init(i);\n        for(re int j=(i-1)*size+1;j<=i*size&&j<=n;++j)\n            id[j]=i;\n    }\n    for(re int i=1;i<=m;++i){\n        int opt,l,r,x;\n        cltstream::read(opt);\n        cltstream::read(l);\n        cltstream::read(r);\n        switch(opt){\n            case 1:\n                cltstream::read(x);\n                IntervalCut(l,r,x);\n                break;\n            case 2:\n                IntervalAssignToMin(l,r);\n                break;\n            case 3:\n                cltstream::read(x);\n                IntervalPre(l,r,x);\n                break;\n        }\n    }\n    for(re int i=1;i<=n;++i)\n        (a[0]+=sam[id[i]]?sam[id[i]]:val[find(i)]+tag[id[i]])%=mod;\n    cltstream::write(a[0],'\\n');\n    cltstream::pc(-1);\n    return 0;\n}\n```\n\n# [T53987ZJF](https://www.luogu.org/problemnew/show/T53987)\n\n+\n\nT3\n\n\n\nsto ____ orz\n\n## SPFA\n\n\n\n# [T56269](https://www.luogu.org/problemnew/show/T56269)\n\nsto __SnoWY__ orz\n\nOI\n\n$k+1$$k$\n\nemmmmmm\n\n\n\n$k+1$$u$$v$$w$$u$$v$$0$$1$$n$`dis[n]`\n\n$n$`dis`$n$$0$$k$$k$$k+1$\n\n\n\n%SnoWY\n\n[](https://i.loli.net/2018/12/26/5c237e1c077b4.jpg)\n\n# [T62117](https://www.luogu.org/problemnew/show/T62117)\n\n\n\n\n\n\n\n$k$$n$$O(n\\sqrt{n})$\n\n\n\n# [T64137 2](https://www.luogu.org/problemnew/show/T64137)\n\n~~~~\n\n[](/block-decomposition/)\n\n\n\n$1\\text{s}/4\\text{MB}$`fread`$2\\text{MB}$$850\\text{ms}$$1.5\\text{MB}$$2\\times 10^{6}$\n\n\n","source":"_posts/2018-12-26-timuzu-solutions.md","raw":"---\nmathjax: true\ndate: 2018-12-26 20:17:22\ntitle: \ntags:\n  - \n  - \n  - \ncategories:\n  - \n---\n[](https://www.luogu.org/team/show?teamid=11367)\n\n<!-- more -->\n\n# [T47720](https://www.luogu.org/problemnew/show/T47720)\n\n[](/luogu-t47720-solution/)\n\n# [T53537](https://www.luogu.org/problemnew/show/T53537)\n\n[](https://www.luogu.org/problemnew/show/P4117)\n\nJF~~~~\n\ntag`set`\n\n$1$$k$$k$$k$$k$$k$$k$\n\n$2$~~~~\n\n$3$`lower_bound`\n\n\n\n```cpp\n#include<cstdio>\n#include<set>\n#define re register\n#define maxn 100000\n#define maxm 100000\n#define maxblock 320\n#define maxval 200000\n#define mod 998244353\n#define max(a,b) ((a)>=(b)?(a):(b))\n#define min(a,b) ((a)<=(b)?(a):(b))\n\nnamespace cltstream{\n    #define size 1048576\n    char cltin[size+1],*ih=cltin,*it=cltin;\n    inline char gc(){\n        #ifdef ONLINE_JUDGE\n            if(ih==it){\n                it=(ih=cltin)+fread(cltin,1,size,stdin);\n                if(ih==it)\n                    return EOF;\n            }\n            return *ih++;\n        #else\n            return getchar();\n        #endif\n    }\n\n    char cltout[size+1],*oh=cltout;\n    int outcnt=0;\n    inline void pc(char c){\n        if(c==-1)\n            fwrite(cltout,1,outcnt,stdout);\n        else{\n            if(outcnt==size){\n                fwrite(cltout,1,size,stdout);\n                oh=cltout;\n                outcnt=0;\n            }\n            *oh++=c;\n            ++outcnt;\n        }\n    }\n    #undef size\n\n    template <typename _tp>\n    inline void read(_tp& x){\n        int sn=1;\n        char c=gc();\n        for(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n        if(c==45&&c!=EOF)\n            sn=-1,c=gc();\n        for(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n        x*=sn;\n    }\n\n    template <typename _tp>\n    inline void write(_tp x,char text=' '){\n        if(x<0)\n            pc(45),x=-x;\n        if(!x)\n            pc(48);\n        else{\n            int digit[22];\n            for(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n            for(;digit[0];pc(digit[digit[0]--]^48));\n        }\n        pc(text);\n    }\n}\n\nint n,m,size;\nint a[maxn+1],id[maxn+1];\nint val[maxn+1],f[maxn+1];\nint pos[maxblock+1][maxval+1];\nint maxv[maxblock+1],minv[maxblock+1],tag[maxblock+1],sam[maxblock+1];\nstd::set<int> s[maxblock+1];\n\nint find(int x){\n    return f[x]==x?x:f[x]=find(f[x]);\n}\n\ninline void init(int x){\n    maxv[x]=-2e9;\n    minv[x]=2e9;\n    for(re int i=(x-1)*size+1;i<=x*size&&i<=n;++i)\n        if(!pos[x][a[i]]){\n            val[i]=a[i];\n            f[i]=i;\n            pos[x][a[i]]=i;\n            maxv[x]=max(maxv[x],a[i]);\n            minv[x]=min(minv[x],a[i]);\n            s[x].insert(a[i]);\n        }\n        else\n            f[i]=pos[x][a[i]];\n}\n\ninline void destory(int x){\n    for(re int i=(x-1)*size+1;i<=x*size&&i<=n;++i){\n        a[i]=sam[x]?sam[x]:val[find(i)]+tag[x];\n        pos[x][val[i]]=0;\n    }\n    tag[x]=sam[x]=0;\n    s[x].clear();\n}\n\ninline void solve(int x,int y){\n    if(sam[x]){\n        if(sam[x]>y)\n            sam[x]-=y;\n        return;\n    }\n    if(maxv[x]-(y-tag[x])<=(y-tag[x])-minv[x]+1){\n        for(re int i=(y-tag[x])+1;i<=maxv[x];++i)\n            if(pos[x][i]){\n                s[x].erase(i);\n                if(!pos[x][i-y]){\n                    val[pos[x][i]]-=y;\n                    pos[x][i-y]=pos[x][i];\n                    s[x].insert(i-y);\n                }\n                else\n                    if(pos[x][i]>pos[x][i-y])\n                        f[pos[x][i]]=pos[x][i-y];\n                    else{\n                        f[pos[x][i-y]]=pos[x][i];\n                        pos[x][i-y]=pos[x][i];\n                        val[pos[x][i-y]]-=y;\n                    }\n                pos[x][i]=0;\n            }\n    }\n    else{\n        for(re int i=(y-tag[x]);i>=minv[x];--i)\n            if(pos[x][i]){\n                s[x].erase(i);\n                if(!pos[x][i+y]){\n                    val[pos[x][i]]+=y;\n                    pos[x][i+y]=pos[x][i];\n                    s[x].insert(i+y);\n                }\n                else\n                    if(pos[x][i]>pos[x][i+y])\n                        f[pos[x][i]]=pos[x][i+y];\n                    else{\n                        f[pos[x][i+y]]=pos[x][i];\n                        pos[x][i+y]=pos[x][i];\n                        val[pos[x][i+y]]+=y;\n                    }\n                pos[x][i]=0;\n            }\n        tag[x]-=y;\n    }\n    minv[x]=*s[x].begin();\n    std::set<int>::iterator it=s[x].end();\n    --it;\n    maxv[x]=*it;\n}\n\ninline void IntervalCut(int l,int r,int x){\n    int L=id[l],R=id[r];\n    destory(L);\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        if(a[i]>x)\n            a[i]-=x;\n    init(L);\n    for(re int i=L+1;i<=R-1;++i)\n        solve(i,x);\n    if(L<R){\n        destory(R);\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            if(a[i]>x)\n                a[i]-=x;\n        init(R);\n    }\n}\n\ninline void IntervalAssignToMin(int l,int r){\n    int L=id[l],R=id[r],res=2e9;\n    destory(L);\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        res=min(res,a[i]);\n    for(re int i=L+1;i<=R-1;++i)\n        res=min(res,sam[i]?sam[i]:minv[i]+tag[i]);\n    if(L<R){\n        destory(R);\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            res=min(res,a[i]);\n    }\n    for(re int i=l;i<=L*size&&i<=r;++i)\n        a[i]=res;\n    init(L);\n    for(re int i=L+1;i<=R-1;++i)\n        sam[i]=res;\n    if(L<R){\n        for(re int i=(R-1)*size+1;i<=r;++i)\n            a[i]=res;\n        init(R);\n    }\n}\n\ninline void IntervalPre(int l,int r,int x){\n    int L=id[l],R=id[r],p=0,res=-2e9;\n    if(sam[L]){\n        if(sam[L]<x&&sam[L]>res){\n            p=l;\n            res=sam[L];\n        }\n    }\n    else\n        for(re int i=l;i<=L*size&&i<=r;++i)\n            if(val[find(i)]+tag[L]<x&&val[find(i)]+tag[L]>res){\n                p=i;\n                res=val[f[i]]+tag[L];\n            }\n    for(re int i=L+1;i<=R-1;++i)\n        if(sam[i]){\n            if(sam[i]<x&&sam[i]>res){\n                p=(i-1)*size+1;\n                res=sam[i];\n            }\n        }\n        else{\n            std::set<int>::iterator it=s[i].lower_bound(x-tag[i]);\n            if(it!=s[i].begin()){\n                --it;\n                if(*it+tag[i]<x&&*it+tag[i]>res){\n                    p=pos[i][*it];\n                    res=*it+tag[i];\n                }\n            }\n        }\n    if(L<R){\n        if(sam[R]){\n            if(sam[R]<x&&sam[R]>res){\n                p=(R-1)*size+1;\n                res=sam[R];\n            }\n        }\n        else\n            for(re int i=(R-1)*size+1;i<=r;++i)\n                if(val[find(i)]+tag[R]<x&&val[find(i)]+tag[R]>res){\n                    p=i;\n                    res=val[f[i]]+tag[R];\n                }\n    }\n    if(p)\n        cltstream::write(p,'\\n');\n    else{\n        cltstream::pc('G');\n        cltstream::pc('R');\n        cltstream::pc('E');\n        cltstream::pc('A');\n        cltstream::pc('T');\n        cltstream::pc(10);\n    }\n}\n\nint main(){\n    cltstream::read(n);\n    cltstream::read(m);\n    for(re int i=1;i<=n;++i)\n        cltstream::read(a[i]);\n    for(;(size+1)*(size+1)<=n;++size);\n    for(re int i=1;(i-1)*size+1<=n;++i){\n        init(i);\n        for(re int j=(i-1)*size+1;j<=i*size&&j<=n;++j)\n            id[j]=i;\n    }\n    for(re int i=1;i<=m;++i){\n        int opt,l,r,x;\n        cltstream::read(opt);\n        cltstream::read(l);\n        cltstream::read(r);\n        switch(opt){\n            case 1:\n                cltstream::read(x);\n                IntervalCut(l,r,x);\n                break;\n            case 2:\n                IntervalAssignToMin(l,r);\n                break;\n            case 3:\n                cltstream::read(x);\n                IntervalPre(l,r,x);\n                break;\n        }\n    }\n    for(re int i=1;i<=n;++i)\n        (a[0]+=sam[id[i]]?sam[id[i]]:val[find(i)]+tag[id[i]])%=mod;\n    cltstream::write(a[0],'\\n');\n    cltstream::pc(-1);\n    return 0;\n}\n```\n\n# [T53987ZJF](https://www.luogu.org/problemnew/show/T53987)\n\n+\n\nT3\n\n\n\nsto ____ orz\n\n## SPFA\n\n\n\n# [T56269](https://www.luogu.org/problemnew/show/T56269)\n\nsto __SnoWY__ orz\n\nOI\n\n$k+1$$k$\n\nemmmmmm\n\n\n\n$k+1$$u$$v$$w$$u$$v$$0$$1$$n$`dis[n]`\n\n$n$`dis`$n$$0$$k$$k$$k+1$\n\n\n\n%SnoWY\n\n[](https://i.loli.net/2018/12/26/5c237e1c077b4.jpg)\n\n# [T62117](https://www.luogu.org/problemnew/show/T62117)\n\n\n\n\n\n\n\n$k$$n$$O(n\\sqrt{n})$\n\n\n\n# [T64137 2](https://www.luogu.org/problemnew/show/T64137)\n\n~~~~\n\n[](/block-decomposition/)\n\n\n\n$1\\text{s}/4\\text{MB}$`fread`$2\\text{MB}$$850\\text{ms}$$1.5\\text{MB}$$2\\times 10^{6}$\n\n\n","slug":"timuzu-solutions","published":1,"updated":"2018-12-29T04:37:58.357Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w3g002ggwgunik4o5wp","content":"<p><a href=\"https://www.luogu.org/team/show?teamid=11367\" target=\"_blank\" rel=\"noopener\"></a></p>\n<a id=\"more\"></a>\n<h1 id=\"T47720\"><a href=\"#T47720\" class=\"headerlink\" title=\"T47720\"></a><a href=\"https://www.luogu.org/problemnew/show/T47720\" target=\"_blank\" rel=\"noopener\">T47720</a></h1><p><a href=\"/luogu-t47720-solution/\"></a></p>\n<h1 id=\"T53537\"><a href=\"#T53537\" class=\"headerlink\" title=\"T53537\"></a><a href=\"https://www.luogu.org/problemnew/show/T53537\" target=\"_blank\" rel=\"noopener\">T53537</a></h1><p><a href=\"https://www.luogu.org/problemnew/show/P4117\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>JF<del></del></p>\n<p>tag<code>set</code></p>\n<p>$1$$k$$k$$k$$k$$k$$k$</p>\n<p>$2$<del></del></p>\n<p>$3$<code>lower_bound</code></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;set&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxblock 320</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxval 200000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> max(a,b) ((a)&gt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> min(a,b) ((a)&lt;=(b)?(a):(b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">    <span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">                it=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> outcnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">-1</span>)</span><br><span class=\"line\">            fwrite(cltout,<span class=\"number\">1</span>,outcnt,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(outcnt==size)&#123;</span><br><span class=\"line\">                fwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">                oh=cltout;</span><br><span class=\"line\">                outcnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            *oh++=c;</span><br><span class=\"line\">            ++outcnt;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">            sn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">        x*=sn;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"string\">' '</span>)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">            pc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">            pc(<span class=\"number\">48</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pc(text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,size;</span><br><span class=\"line\"><span class=\"keyword\">int</span> a[maxn+<span class=\"number\">1</span>],id[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> val[maxn+<span class=\"number\">1</span>],f[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> pos[maxblock+<span class=\"number\">1</span>][maxval+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> maxv[maxblock+<span class=\"number\">1</span>],minv[maxblock+<span class=\"number\">1</span>],tag[maxblock+<span class=\"number\">1</span>],sam[maxblock+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt; s[maxblock+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f[x]==x?x:f[x]=find(f[x]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    maxv[x]=<span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    minv[x]=<span class=\"number\">2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(x<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=x*size&amp;&amp;i&lt;=n;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!pos[x][a[i]])&#123;</span><br><span class=\"line\">            val[i]=a[i];</span><br><span class=\"line\">            f[i]=i;</span><br><span class=\"line\">            pos[x][a[i]]=i;</span><br><span class=\"line\">            maxv[x]=max(maxv[x],a[i]);</span><br><span class=\"line\">            minv[x]=min(minv[x],a[i]);</span><br><span class=\"line\">            s[x].insert(a[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            f[i]=pos[x][a[i]];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">destory</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(x<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=x*size&amp;&amp;i&lt;=n;++i)&#123;</span><br><span class=\"line\">        a[i]=sam[x]?sam[x]:val[find(i)]+tag[x];</span><br><span class=\"line\">        pos[x][val[i]]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tag[x]=sam[x]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    s[x].clear();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sam[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[x]&gt;y)</span><br><span class=\"line\">            sam[x]-=y;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(maxv[x]-(y-tag[x])&lt;=(y-tag[x])-minv[x]+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(y-tag[x])+<span class=\"number\">1</span>;i&lt;=maxv[x];++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(pos[x][i])&#123;</span><br><span class=\"line\">                s[x].erase(i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!pos[x][i-y])&#123;</span><br><span class=\"line\">                    val[pos[x][i]]-=y;</span><br><span class=\"line\">                    pos[x][i-y]=pos[x][i];</span><br><span class=\"line\">                    s[x].insert(i-y);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(pos[x][i]&gt;pos[x][i-y])</span><br><span class=\"line\">                        f[pos[x][i]]=pos[x][i-y];</span><br><span class=\"line\">                    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                        f[pos[x][i-y]]=pos[x][i];</span><br><span class=\"line\">                        pos[x][i-y]=pos[x][i];</span><br><span class=\"line\">                        val[pos[x][i-y]]-=y;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                pos[x][i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(y-tag[x]);i&gt;=minv[x];--i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(pos[x][i])&#123;</span><br><span class=\"line\">                s[x].erase(i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!pos[x][i+y])&#123;</span><br><span class=\"line\">                    val[pos[x][i]]+=y;</span><br><span class=\"line\">                    pos[x][i+y]=pos[x][i];</span><br><span class=\"line\">                    s[x].insert(i+y);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(pos[x][i]&gt;pos[x][i+y])</span><br><span class=\"line\">                        f[pos[x][i]]=pos[x][i+y];</span><br><span class=\"line\">                    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                        f[pos[x][i+y]]=pos[x][i];</span><br><span class=\"line\">                        pos[x][i+y]=pos[x][i];</span><br><span class=\"line\">                        val[pos[x][i+y]]+=y;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                pos[x][i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        tag[x]-=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    minv[x]=*s[x].begin();</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt;::iterator it=s[x].end();</span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    maxv[x]=*it;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalCut</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r];</span><br><span class=\"line\">    destory(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a[i]&gt;x)</span><br><span class=\"line\">            a[i]-=x;</span><br><span class=\"line\">    init(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        solve(i,x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        destory(R);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a[i]&gt;x)</span><br><span class=\"line\">                a[i]-=x;</span><br><span class=\"line\">        init(R);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAssignToMin</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r],res=<span class=\"number\">2e9</span>;</span><br><span class=\"line\">    destory(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        res=min(res,a[i]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        res=min(res,sam[i]?sam[i]:minv[i]+tag[i]);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        destory(R);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            res=min(res,a[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        a[i]=res;</span><br><span class=\"line\">    init(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        sam[i]=res;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            a[i]=res;</span><br><span class=\"line\">        init(R);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalPre</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r],p=<span class=\"number\">0</span>,res=<span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sam[L])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[L]&lt;x&amp;&amp;sam[L]&gt;res)&#123;</span><br><span class=\"line\">            p=l;</span><br><span class=\"line\">            res=sam[L];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(val[find(i)]+tag[L]&lt;x&amp;&amp;val[find(i)]+tag[L]&gt;res)&#123;</span><br><span class=\"line\">                p=i;</span><br><span class=\"line\">                res=val[f[i]]+tag[L];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[i])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sam[i]&lt;x&amp;&amp;sam[i]&gt;res)&#123;</span><br><span class=\"line\">                p=(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;</span><br><span class=\"line\">                res=sam[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt;::iterator it=s[i].lower_bound(x-tag[i]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(it!=s[i].begin())&#123;</span><br><span class=\"line\">                --it;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(*it+tag[i]&lt;x&amp;&amp;*it+tag[i]&gt;res)&#123;</span><br><span class=\"line\">                    p=pos[i][*it];</span><br><span class=\"line\">                    res=*it+tag[i];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[R])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sam[R]&lt;x&amp;&amp;sam[R]&gt;res)&#123;</span><br><span class=\"line\">                p=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;</span><br><span class=\"line\">                res=sam[R];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(val[find(i)]+tag[R]&lt;x&amp;&amp;val[find(i)]+tag[R]&gt;res)&#123;</span><br><span class=\"line\">                    p=i;</span><br><span class=\"line\">                    res=val[f[i]]+tag[R];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(p)</span><br><span class=\"line\">        cltstream::write(p,<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'G'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'R'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'E'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'A'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'T'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cltstream::read(n);</span><br><span class=\"line\">    cltstream::read(m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        cltstream::read(a[i]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;(size+<span class=\"number\">1</span>)*(size+<span class=\"number\">1</span>)&lt;=n;++size);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>&lt;=n;++i)&#123;</span><br><span class=\"line\">        init(i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;j&lt;=i*size&amp;&amp;j&lt;=n;++j)</span><br><span class=\"line\">            id[j]=i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> opt,l,r,x;</span><br><span class=\"line\">        cltstream::read(opt);</span><br><span class=\"line\">        cltstream::read(l);</span><br><span class=\"line\">        cltstream::read(r);</span><br><span class=\"line\">        <span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                cltstream::read(x);</span><br><span class=\"line\">                IntervalCut(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">                IntervalAssignToMin(l,r);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">                cltstream::read(x);</span><br><span class=\"line\">                IntervalPre(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        (a[<span class=\"number\">0</span>]+=sam[id[i]]?sam[id[i]]:val[find(i)]+tag[id[i]])%=mod;</span><br><span class=\"line\">    cltstream::write(a[<span class=\"number\">0</span>],<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    cltstream::pc(<span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"T53987ZJF\"><a href=\"#T53987ZJF\" class=\"headerlink\" title=\"T53987ZJF\"></a><a href=\"https://www.luogu.org/problemnew/show/T53987\" target=\"_blank\" rel=\"noopener\">T53987ZJF</a></h1><p>+</p>\n<p>T3</p>\n<p></p>\n<p>sto <strong></strong> orz</p>\n<h2 id=\"SPFA\"><a href=\"#SPFA\" class=\"headerlink\" title=\"SPFA\"></a>SPFA</h2><p></p>\n<h1 id=\"T56269\"><a href=\"#T56269\" class=\"headerlink\" title=\"T56269\"></a><a href=\"https://www.luogu.org/problemnew/show/T56269\" target=\"_blank\" rel=\"noopener\">T56269</a></h1><p>sto <strong>SnoWY</strong> orz</p>\n<p>OI</p>\n<p>$k+1$$k$</p>\n<p>emmmmmm</p>\n<p></p>\n<p>$k+1$$u$$v$$w$$u$$v$$0$$1$$n$<code>dis[n]</code></p>\n<p>$n$<code>dis</code>$n$$0$$k$$k$$k+1$</p>\n<p></p>\n<p>%SnoWY</p>\n<p><a href=\"https://i.loli.net/2018/12/26/5c237e1c077b4.jpg\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"T62117\"><a href=\"#T62117\" class=\"headerlink\" title=\"T62117\"></a><a href=\"https://www.luogu.org/problemnew/show/T62117\" target=\"_blank\" rel=\"noopener\">T62117</a></h1><p></p>\n<p></p>\n<p></p>\n<p>$k$$n$$O(n\\sqrt{n})$</p>\n<p></p>\n<h1 id=\"T64137-2\"><a href=\"#T64137-2\" class=\"headerlink\" title=\"T64137 2\"></a><a href=\"https://www.luogu.org/problemnew/show/T64137\" target=\"_blank\" rel=\"noopener\">T64137 2</a></h1><p><del></del></p>\n<p><a href=\"/block-decomposition/\"></a></p>\n<p></p>\n<p>$1\\text{s}/4\\text{MB}$<code>fread</code>$2\\text{MB}$$850\\text{ms}$$1.5\\text{MB}$$2\\times 10^{6}$</p>\n<p></p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://www.luogu.org/team/show?teamid=11367\" target=\"_blank\" rel=\"noopener\"></a></p>","more":"<h1 id=\"T47720\"><a href=\"#T47720\" class=\"headerlink\" title=\"T47720\"></a><a href=\"https://www.luogu.org/problemnew/show/T47720\" target=\"_blank\" rel=\"noopener\">T47720</a></h1><p><a href=\"/luogu-t47720-solution/\"></a></p>\n<h1 id=\"T53537\"><a href=\"#T53537\" class=\"headerlink\" title=\"T53537\"></a><a href=\"https://www.luogu.org/problemnew/show/T53537\" target=\"_blank\" rel=\"noopener\">T53537</a></h1><p><a href=\"https://www.luogu.org/problemnew/show/P4117\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>JF<del></del></p>\n<p>tag<code>set</code></p>\n<p>$1$$k$$k$$k$$k$$k$$k$</p>\n<p>$2$<del></del></p>\n<p>$3$<code>lower_bound</code></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;set&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxm 100000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxblock 320</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxval 200000</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> max(a,b) ((a)&gt;=(b)?(a):(b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> min(a,b) ((a)&lt;=(b)?(a):(b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">    <span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">                it=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> outcnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">-1</span>)</span><br><span class=\"line\">            fwrite(cltout,<span class=\"number\">1</span>,outcnt,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(outcnt==size)&#123;</span><br><span class=\"line\">                fwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">                oh=cltout;</span><br><span class=\"line\">                outcnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            *oh++=c;</span><br><span class=\"line\">            ++outcnt;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">            sn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">        x*=sn;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"string\">' '</span>)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">            pc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">            pc(<span class=\"number\">48</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pc(text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,size;</span><br><span class=\"line\"><span class=\"keyword\">int</span> a[maxn+<span class=\"number\">1</span>],id[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> val[maxn+<span class=\"number\">1</span>],f[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> pos[maxblock+<span class=\"number\">1</span>][maxval+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> maxv[maxblock+<span class=\"number\">1</span>],minv[maxblock+<span class=\"number\">1</span>],tag[maxblock+<span class=\"number\">1</span>],sam[maxblock+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt; s[maxblock+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f[x]==x?x:f[x]=find(f[x]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    maxv[x]=<span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    minv[x]=<span class=\"number\">2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(x<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=x*size&amp;&amp;i&lt;=n;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!pos[x][a[i]])&#123;</span><br><span class=\"line\">            val[i]=a[i];</span><br><span class=\"line\">            f[i]=i;</span><br><span class=\"line\">            pos[x][a[i]]=i;</span><br><span class=\"line\">            maxv[x]=max(maxv[x],a[i]);</span><br><span class=\"line\">            minv[x]=min(minv[x],a[i]);</span><br><span class=\"line\">            s[x].insert(a[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            f[i]=pos[x][a[i]];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">destory</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(x<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=x*size&amp;&amp;i&lt;=n;++i)&#123;</span><br><span class=\"line\">        a[i]=sam[x]?sam[x]:val[find(i)]+tag[x];</span><br><span class=\"line\">        pos[x][val[i]]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tag[x]=sam[x]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    s[x].clear();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sam[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[x]&gt;y)</span><br><span class=\"line\">            sam[x]-=y;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(maxv[x]-(y-tag[x])&lt;=(y-tag[x])-minv[x]+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(y-tag[x])+<span class=\"number\">1</span>;i&lt;=maxv[x];++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(pos[x][i])&#123;</span><br><span class=\"line\">                s[x].erase(i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!pos[x][i-y])&#123;</span><br><span class=\"line\">                    val[pos[x][i]]-=y;</span><br><span class=\"line\">                    pos[x][i-y]=pos[x][i];</span><br><span class=\"line\">                    s[x].insert(i-y);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(pos[x][i]&gt;pos[x][i-y])</span><br><span class=\"line\">                        f[pos[x][i]]=pos[x][i-y];</span><br><span class=\"line\">                    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                        f[pos[x][i-y]]=pos[x][i];</span><br><span class=\"line\">                        pos[x][i-y]=pos[x][i];</span><br><span class=\"line\">                        val[pos[x][i-y]]-=y;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                pos[x][i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(y-tag[x]);i&gt;=minv[x];--i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(pos[x][i])&#123;</span><br><span class=\"line\">                s[x].erase(i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!pos[x][i+y])&#123;</span><br><span class=\"line\">                    val[pos[x][i]]+=y;</span><br><span class=\"line\">                    pos[x][i+y]=pos[x][i];</span><br><span class=\"line\">                    s[x].insert(i+y);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(pos[x][i]&gt;pos[x][i+y])</span><br><span class=\"line\">                        f[pos[x][i]]=pos[x][i+y];</span><br><span class=\"line\">                    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                        f[pos[x][i+y]]=pos[x][i];</span><br><span class=\"line\">                        pos[x][i+y]=pos[x][i];</span><br><span class=\"line\">                        val[pos[x][i+y]]+=y;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                pos[x][i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        tag[x]-=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    minv[x]=*s[x].begin();</span><br><span class=\"line\">    <span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt;::iterator it=s[x].end();</span><br><span class=\"line\">    --it;</span><br><span class=\"line\">    maxv[x]=*it;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalCut</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r];</span><br><span class=\"line\">    destory(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a[i]&gt;x)</span><br><span class=\"line\">            a[i]-=x;</span><br><span class=\"line\">    init(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        solve(i,x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        destory(R);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a[i]&gt;x)</span><br><span class=\"line\">                a[i]-=x;</span><br><span class=\"line\">        init(R);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalAssignToMin</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r],res=<span class=\"number\">2e9</span>;</span><br><span class=\"line\">    destory(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        res=min(res,a[i]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        res=min(res,sam[i]?sam[i]:minv[i]+tag[i]);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        destory(R);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            res=min(res,a[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">        a[i]=res;</span><br><span class=\"line\">    init(L);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        sam[i]=res;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">            a[i]=res;</span><br><span class=\"line\">        init(R);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">IntervalPre</span><span class=\"params\">(<span class=\"keyword\">int</span> l,<span class=\"keyword\">int</span> r,<span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L=id[l],R=id[r],p=<span class=\"number\">0</span>,res=<span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sam[L])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[L]&lt;x&amp;&amp;sam[L]&gt;res)&#123;</span><br><span class=\"line\">            p=l;</span><br><span class=\"line\">            res=sam[L];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=l;i&lt;=L*size&amp;&amp;i&lt;=r;++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(val[find(i)]+tag[L]&lt;x&amp;&amp;val[find(i)]+tag[L]&gt;res)&#123;</span><br><span class=\"line\">                p=i;</span><br><span class=\"line\">                res=val[f[i]]+tag[L];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=L+<span class=\"number\">1</span>;i&lt;=R<span class=\"number\">-1</span>;++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[i])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sam[i]&lt;x&amp;&amp;sam[i]&gt;res)&#123;</span><br><span class=\"line\">                p=(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;</span><br><span class=\"line\">                res=sam[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">std</span>::<span class=\"built_in\">set</span>&lt;<span class=\"keyword\">int</span>&gt;::iterator it=s[i].lower_bound(x-tag[i]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(it!=s[i].begin())&#123;</span><br><span class=\"line\">                --it;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(*it+tag[i]&lt;x&amp;&amp;*it+tag[i]&gt;res)&#123;</span><br><span class=\"line\">                    p=pos[i][*it];</span><br><span class=\"line\">                    res=*it+tag[i];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L&lt;R)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sam[R])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sam[R]&lt;x&amp;&amp;sam[R]&gt;res)&#123;</span><br><span class=\"line\">                p=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;</span><br><span class=\"line\">                res=sam[R];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=(R<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;i&lt;=r;++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(val[find(i)]+tag[R]&lt;x&amp;&amp;val[find(i)]+tag[R]&gt;res)&#123;</span><br><span class=\"line\">                    p=i;</span><br><span class=\"line\">                    res=val[f[i]]+tag[R];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(p)</span><br><span class=\"line\">        cltstream::write(p,<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'G'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'R'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'E'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'A'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"string\">'T'</span>);</span><br><span class=\"line\">        cltstream::pc(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cltstream::read(n);</span><br><span class=\"line\">    cltstream::read(m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        cltstream::read(a[i]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;(size+<span class=\"number\">1</span>)*(size+<span class=\"number\">1</span>)&lt;=n;++size);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>&lt;=n;++i)&#123;</span><br><span class=\"line\">        init(i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=(i<span class=\"number\">-1</span>)*size+<span class=\"number\">1</span>;j&lt;=i*size&amp;&amp;j&lt;=n;++j)</span><br><span class=\"line\">            id[j]=i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> opt,l,r,x;</span><br><span class=\"line\">        cltstream::read(opt);</span><br><span class=\"line\">        cltstream::read(l);</span><br><span class=\"line\">        cltstream::read(r);</span><br><span class=\"line\">        <span class=\"keyword\">switch</span>(opt)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                cltstream::read(x);</span><br><span class=\"line\">                IntervalCut(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">                IntervalAssignToMin(l,r);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">                cltstream::read(x);</span><br><span class=\"line\">                IntervalPre(l,r,x);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;++i)</span><br><span class=\"line\">        (a[<span class=\"number\">0</span>]+=sam[id[i]]?sam[id[i]]:val[find(i)]+tag[id[i]])%=mod;</span><br><span class=\"line\">    cltstream::write(a[<span class=\"number\">0</span>],<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    cltstream::pc(<span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"T53987ZJF\"><a href=\"#T53987ZJF\" class=\"headerlink\" title=\"T53987ZJF\"></a><a href=\"https://www.luogu.org/problemnew/show/T53987\" target=\"_blank\" rel=\"noopener\">T53987ZJF</a></h1><p>+</p>\n<p>T3</p>\n<p></p>\n<p>sto <strong></strong> orz</p>\n<h2 id=\"SPFA\"><a href=\"#SPFA\" class=\"headerlink\" title=\"SPFA\"></a>SPFA</h2><p></p>\n<h1 id=\"T56269\"><a href=\"#T56269\" class=\"headerlink\" title=\"T56269\"></a><a href=\"https://www.luogu.org/problemnew/show/T56269\" target=\"_blank\" rel=\"noopener\">T56269</a></h1><p>sto <strong>SnoWY</strong> orz</p>\n<p>OI</p>\n<p>$k+1$$k$</p>\n<p>emmmmmm</p>\n<p></p>\n<p>$k+1$$u$$v$$w$$u$$v$$0$$1$$n$<code>dis[n]</code></p>\n<p>$n$<code>dis</code>$n$$0$$k$$k$$k+1$</p>\n<p></p>\n<p>%SnoWY</p>\n<p><a href=\"https://i.loli.net/2018/12/26/5c237e1c077b4.jpg\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"T62117\"><a href=\"#T62117\" class=\"headerlink\" title=\"T62117\"></a><a href=\"https://www.luogu.org/problemnew/show/T62117\" target=\"_blank\" rel=\"noopener\">T62117</a></h1><p></p>\n<p></p>\n<p></p>\n<p>$k$$n$$O(n\\sqrt{n})$</p>\n<p></p>\n<h1 id=\"T64137-2\"><a href=\"#T64137-2\" class=\"headerlink\" title=\"T64137 2\"></a><a href=\"https://www.luogu.org/problemnew/show/T64137\" target=\"_blank\" rel=\"noopener\">T64137 2</a></h1><p><del></del></p>\n<p><a href=\"/block-decomposition/\"></a></p>\n<p></p>\n<p>$1\\text{s}/4\\text{MB}$<code>fread</code>$2\\text{MB}$$850\\text{ms}$$1.5\\text{MB}$$2\\times 10^{6}$</p>\n<p></p>"},{"mathjax":true,"date":"2018-12-19T12:23:01.000Z","title":"Part I","_content":"blog\n\n<!-- more -->\n\n$n-1$$F(x)$$m-1$$G(x)$$(F\\times G)(x)$$n,m\\leqslant 10^{6}$\n\n$F(x)$$i$$F[i]$\n\n$$F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}$$\n\n$$G(x)=\\sum\\limits_{i=0}^{m-1}G[i]x^{i}$$\n\n$$(F\\times G)(x)=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}F[i]G[j]x^{i+j}$$\n\n$$(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]$$\n\n$O(n^{2})$\n\n\n\n# \n\n$n$$(x_{0},y_{0}),(x_{1},y_{1}),\\cdots,(x_{n-1},y_{n-1})$$x_{i}$$n-1$\n\n\n\n$$(0,2),(1,7),(2,4)$$\n\n~~~~\n\n\n\n$$\\begin{cases}\n&\\text{C}=2\\\\\n&\\text{A}+\\text{B}+\\text{C}=7\\\\\n&4\\text{A}+2\\text{B}+\\text{C}=4\n\\end{cases}$$\n\n\n\n$$\\begin{cases}\n&\\text{A}=-4\\\\\n&\\text{B}=9\\\\\n&\\text{C}=2\n\\end{cases}$$\n\n$(F\\times G)(x)=F(x)G(x)$~~~~$F(x)$$G(x)$$O(n)$$(F\\times G)(x)$$(F\\times G)(x)$$n+m-2$$n+m-1$\n\n$O(n^{2})$\n\n\n\n# \n\n\n\n## \n\n\n\n$$x^{2}+1=0$$\n\n$\\Delta=b^{2}-4ac=-4\\lt 0$\n\n$i$$i^{2}=-1$$x+yi$$\\sqrt{x^{2}+y^{2}}$$x$$\\operatorname{tan}^{-1}\\cfrac{y}{x}$\n\n$i$$x$$y$$x+yi$$(x,y)$\n\n![](https://i.loli.net/2018/12/19/5c1a46b4d785b.png)\n\n$4+i$$3+4i$\n\n\n\n$$(x_{1}+y_{1}i)+(x_{2}+y_{2}i)=(x_{1}+x_{2})+(y_{1}+y_{2})i$$\n\n$$(x_{1}+y_{1}i)-(x_{2}+y_{2}i)=(x_{1}-x_{2})+(y_{1}-y_{2})i$$\n\n$$(x_{1}+y_{1}i)(x_{2}+y_{2}i)=(x_{1}x_{2}-y_{1}y_{2})+(x_{1}y_{2}+x_{2}y_{1})i$$\n\n$$\\begin{aligned}\n\\cfrac{x_{1}+y_{1}i}{x_{2}+y_{2}i}&=\\cfrac{(x_{1}+y_{1}i)(x_{2}-y_{2}i)}{(x_{2}+y_{2}i)(x_{2}-y_{2}i)}\\\\\n&=\\cfrac{(x_{1}x_{2}+y_{1}y_{2})+(x_{2}y_{1}-x_{1}y_{2})i}{x_{2}^{2}+y_{2}^{2}}\\\\\n&=\\cfrac{x_{1}x_{2}+y_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}+\\cfrac{x_{2}y_{1}-x_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}i\n\\end{aligned}$$\n\n\n\n$c_{1}$$c_{2}$$r_{1}$$r_{2}$$\\alpha_{1}$$\\alpha_{2}$\n\n$$c_{1}=r_{1}(\\operatorname{cos}\\alpha_{1}+i\\operatorname{sin}\\alpha_{1})$$\n\n$$c_{2}=r_{2}(\\operatorname{cos}\\alpha_{2}+i\\operatorname{sin}\\alpha_{2})$$\n\n$$\\begin{aligned}\nc_{1}c_{2}&=r_{1}r_{2}(\\cos\\alpha_{1}+i\\sin\\alpha_{1})(\\cos\\alpha_{2}+i\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}(\\cos\\alpha_{1}\\cos\\alpha_{2}+i\\cos\\alpha_{1}\\sin\\alpha_{2}+i\\sin\\alpha_{1}\\cos\\alpha_{2}-\\sin\\alpha_{1}\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}[\\cos(\\alpha_{1}+\\alpha_{2})+i\\sin(\\alpha_{1}+\\alpha_{2})]\n\\end{aligned}$$\n\n\n\n## \n\n$1$\n\n![](https://i.loli.net/2018/12/20/5c1b06e5602fa.png)\n\n\n\n$$x^{n}=1$$\n\n\n\n$n$$1$$1$$a$\n\n$$2\\pi\\mid na$$\n\n$$\\cfrac{2\\pi}{n}\\mid a$$\n\n$n$$\\cfrac{2k\\pi}{n}(k\\in[0,n)\\cap\\mathbb{Z})$$\\cfrac{2\\pi}{n}$$\\cos\\cfrac{2\\pi}{n}+i\\sin\\cfrac{2\\pi}{n}$$n$$\\omega_{n}$$n$$\\omega_{n}^{k}(k\\in[0,n)\\cap\\mathbb{Z})$\n\n\n\n$$\\omega_{2n}^{2k}=\\omega_{n}^{k}$$\n\n$1$\n\n\n\n$$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\n\n$\\omega_{n}^{\\frac{n}{2}}$$\\cfrac{2\\times\\frac{n}{2}\\pi}{n}=\\pi$$-1$\n\n# Fast Fourier Transformation\n\n## \n\n\n\nJean Baptiste Joseph Fourier$n$\n\n$0$$+1$$2$\n\n\n\n$$\\begin{aligned}\nF_{1}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i]x^{i}\\\\\n&=F[0]x^{0}+F[2]x^{1}+\\cdots+F[n-2]x^{\\frac{n}{2}-1}\n\\end{aligned}$$\n\n$$\\begin{aligned}\nF_{2}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i+1]x^{i}\\\\\n&=F[1]x^{0}+F[3]x^{1}+\\cdots+F[n-1]x^{\\frac{n}{2}-1}\n\\end{aligned}$$\n\n\n\n$$F(x)=F_{1}(x^{2})+xF_{2}(x^{2})$$\n\n$0\\leqslant k<\\cfrac{n}{2}$$x=\\omega_{n}^{k}$$x=\\omega_{n}^{k+\\frac{n}{2}}$\n\n$$\\begin{aligned}\nF(\\omega_{n}^{k})&=F_{1}(\\omega_{n}^{2k})+\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}$$\n\n$$\\begin{aligned}\nF(\\omega_{n}^{k+\\frac{n}{2}})&=F_{1}(\\omega_{n}^{2k+n})+\\omega_{n}^{k+\\frac{n}{2}}F_{2}(\\omega_{n}^{2k+n})\\\\\n&=F_{1}(\\omega_{n}^{2k})-\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}$$\n\n$F_{1}(x)$$F_{2}(x)$$O(n)$$F(x)$$n=1$\n\n\n\n```cpp\nvoid work(complex* F,int n){\n\tif(n==1)\n\t\treturn;\n\tcomplex F1[n>>1],F2[n>>1];\n    for(int i=0;i<n;i+=2){\n    \tF1[i]=F[2*i];\n        F2[i]=F[2*i+1];\n\t}\n    work(F1,n>>1);\n    work(F2,n>>1);\n    complex unit(cos(2*Pi/n),sin(2*Pi/n)),tmp=1;\n    for(int i=0;i<(n>>1);++i,tmp=tmp*unit){\n    \tcomplex w=F2[i+(n>>1)]*tmp;\n        F[i]=F1[i]+w;\n        F[i+(n>>1)]=F1[i]-w;\n\t}\n}\n```\n\n~~~~\n\n`F`\n\n```plaintext\n0 1 2 3 4 5 6 7\n0 2 4 6|1 3 5 7\n0 4|2 6|1 5|3 7\n0|4|2|6|1|5|3|7\n```\n\n\n\n|  |  |  |  |\n| :-: | :-: | :-: | :-: |\n| $0$ | $000$ | $0$ | $000$ |\n| $1$ | $001$ | $4$ | $100$ |\n| $2$ | $010$ | $2$ | $010$ |\n| $3$ | $011$ | $6$ | $110$ |\n| $4$ | $100$ | $1$ | $001$ |\n| $5$ | $101$ | $5$ | $101$ |\n| $6$ | $110$ | $3$ | $011$ |\n| $7$ | $111$ | $7$ | $111$ |\n\n$\\operatorname{log}n$\n\n$O(n)$\n\n```cpp\nfor(int i=0;i<n;++i)\n\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n```\n\n$i$$i$$1$$1$\n\n\n\n```cpp\nvoid work(complex* F,int n){\n\tfor(int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tcomplex unit(cos(Pi/p),sin(Pi/p));\n\t\tfor(int i=0;i<n;i+=len){\n\t\t\tcomplex cur(1,0);\n\t\t\tfor(int j=i;j<i+p;++j){\n\t\t\t\tcomplex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n$F(\\omega_{n}^{0}),F(\\omega_{n}^{1}),\\cdots,F(\\omega_{n}^{n-1})$$y_{0},y_{1},\\cdots,y_{n-1}$\n\n$$\\begin{bmatrix}\n&(\\omega_{n}^{0})^{0}&(\\omega_{n}^{0})^{1}&\\cdots&(\\omega_{n}^{0})^{n-1}&\\\\\n&(\\omega_{n}^{1})^{0}&(\\omega_{n}^{1})^{1}&\\cdots&(\\omega_{n}^{1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&(\\omega_{n}^{n-1})^{0}&(\\omega_{n}^{n-1})^{1}&\\cdots&(\\omega_{n}^{n-1})^{n-1}\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\n&F[0]&\\\\\n&F[1]\\\\\n&\\vdots\\\\\n&F[n-1]\n\\end{bmatrix}\n=\\begin{bmatrix}\n&y_{0}&\\\\\n&y_{1}\\\\\n&\\vdots\\\\\n&y_{n-1}\n\\end{bmatrix}$$\n\n\n\n$$\\begin{bmatrix}\n&\\frac{1}{n}(\\omega_{n}^{0})^{0}&\\frac{1}{n}(\\omega_{n}^{0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{0})^{n-1}&\\\\\n&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\n\\end{bmatrix}$$\n\n$A$$B$$A\\times B=C$$A[i][j]=\\omega_{n}^{ij}$$B[i][j]=\\cfrac{1}{n}\\omega_{n}^{-ij}$\n\n$$\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}A[i][k]B[k][j]\\\\\n&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{ik-kj}\n\\end{aligned}$$\n\n$i=j$$C[i][j]=1$\n\n$i\\neq j$$i-j=l$\n\n$$\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{lk}\\\\\n&=\\cfrac{\\omega_{n}^{ln}-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=\\cfrac{1-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=0\n\\end{aligned}$$\n\n$C$$B$$A$\n\n\n\n$$\\begin{bmatrix}&\\frac{1}{n}(\\omega_{n}^{-0})^{0}&\\frac{1}{n}(\\omega_{n}^{-0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-0})^{n-1}&\\\\&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\&\\vdots&\\vdots&\\ddots&\\vdots\\\\&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\\end{bmatrix}\\begin{bmatrix}&y_{0}&\\\\&y_{1}\\\\&\\vdots\\\\&y_{n-1}\\end{bmatrix}=\\begin{bmatrix}&F[0]&\\\\&F[1]\\\\&\\vdots\\\\&F[n-1]\\end{bmatrix}$$\n\n$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$$\\omega_{n}^{0},\\omega_{n}^{-1},\\cdots,\\omega_{n}^{-n+1}$FFT$n$\n\n\n\n```cpp\ncomplex unit(cos(Pi/p),sin(Pi/p));\n```\n\n\n\n```cpp\ncomplex unit(cos(Pi/p),tp*sin(Pi/p));\n```\n\n`tp``tp=1``tp=-1`\n\n\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#define maxn 2097152\n\nconst double Pi=acos(-1.0);\n\nint n,m;\nint rev[maxn+1];\nstruct complex{\n\tdouble r,c;\n\t\n\tcomplex(double _r=0,double _c=0){\n\t\tr=_r;\n\t\tc=_c;\n\t}\n};\ncomplex F[maxn+1],G[maxn+1];\n\ninline complex operator+(complex& a,complex& b){\n\treturn complex(a.r+b.r,a.c+b.c);\n}\n\ninline complex operator-(complex& a,complex& b){\n\treturn complex(a.r-b.r,a.c-b.c);\n}\n\ninline complex operator*(complex& a,complex& b){\n\treturn complex(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);\n}\n\ntemplate<typename _tp>\ninline void swap(_tp& x,_tp& y){\n\t_tp tmp=x;\n\tx=y;\n\ty=tmp;\n}\n\ninline void FAQ(complex F[],int tp){\n\tfor(register int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(register int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));\n\t\tfor(register int i=0;i<n;i+=len){\n\t\t\tregister complex cur(1,0);\n\t\t\tfor(register int j=i;j<i+p;++j){\n\t\t\t\tregister complex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\t++n;\n\tfor(register int i=0;i<n;++i)\n\t\tscanf(\"%d\",&F[i].r);\n\t++m;\n\tfor(register int i=0;i<m;++i)\n\t\tscanf(\"%d\",&G[i].r);\n\tfor(m+=n-1,n=1;n<m;n<<=1);\n\tfor(register int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tFAQ(F,1);\n\tFAQ(G,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF[i]=F[i]*G[i];\n\tFAQ(F,-1);\n\tfor(register int i=0;i<m;++i)\n\t\tprintf(\"%0.0lf \",F[i].r/n);\n\treturn 0;\n}\n```\n\n~~`cltstream`~~\n\n[](https://www.luogu.org/problemnew/show/P3803)\n\n\n\n\n\n\n\n## \n\n### [ZJOI2014](https://www.luogu.org/problemnew/show/P3338)\n\n\n\n$n$$F$$G$$H$\n\n$$H[i]=\\sum\\limits_{j=0}^{i}F[j]G[i-j]=\\sum\\limits_{0\\leqslant j<n,0\\leqslant k<n,j+k=i}F[j]G[k]$$\n\n\n\n$$(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]$$\n\n\n\n\n\n$$F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}$$\n\n$$G(x)=\\sum\\limits_{i=0}^{n-1}G[i]x^{i}$$\n\nFFT$n$\n\n$j\\lt i$$j\\gt i$\n\n$j\\lt i$$F[i]=q_{i}$$G[i]=\\begin{cases}&\\cfrac{1}{i^{2}}\\;\\;&(i\\gt 0)\\\\&0&(i=0)\\end{cases}$\n\n$$\\begin{aligned}\nE_{i}&=\\sum_{j=0}^{i-1}F[j]G[i-j]\\\\\n&=\\sum_{j=0}^{i}F[j]G[i-j]\n\\end{aligned}$$\n\n\n\n$j>i$$F$\n\n\n\n```cpp\n#include\\lt cstdio>\n#include<cmath>\n#define maxn 2097152\n\nconst double Pi=acos(-1.0);\n\nint n,m;\nint rev[maxn+1];\nstruct complex{\n\tdouble r,c;\n\t\n\tcomplex(double _r=0,double _c=0){\n\t\tr=_r;\n\t\tc=_c;\n\t}\n};\ncomplex F1[maxn+1],F2[maxn+1],G[maxn+1];\n\ninline complex operator+(complex& a,complex& b){\n\treturn complex(a.r+b.r,a.c+b.c);\n}\n\ninline complex operator-(complex& a,complex& b){\n\treturn complex(a.r-b.r,a.c-b.c);\n}\n\ninline complex operator*(complex& a,complex& b){\n\treturn complex(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);\n}\n\ntemplate<typename _tp>\ninline void swap(_tp& x,_tp& y){\n\t_tp tmp=x;\n\tx=y;\n\ty=tmp;\n}\n\ninline void FAQ(complex F[],int tp){\n\tfor(register int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(register int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));\n\t\tfor(register int i=0;i<n;i+=len){\n\t\t\tregister complex cur(1,0);\n\t\t\tfor(register int j=i;j<i+p;++j){\n\t\t\t\tregister complex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(register int i=0;i<n;++i){\n\t\tscanf(\"%lf\",&F1[i].r);\n\t\tF2[n-i-1].r=F1[i].r;\n\t}\n\tfor(register int i=1;i<n;++i)\n\t\tG[i]=1.0/i/i;\n\tfor(m=n,n=1;n<m;n<<=1);\n\tn<<=1;\n\tfor(register int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tFAQ(G,1);\n\tFAQ(F1,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF1[i]=F1[i]*G[i];\n\tFAQ(F1,-1);\n\tFAQ(F2,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF2[i]=F2[i]*G[i];\n\tFAQ(F2,-1);\n\tfor(register int i=0;i<m;++i)\n\t\tprintf(\"%lf\\n\",(F1[i].r-F2[m-i-1].r)/n);\n\treturn 0;\n}\n```\n\n# Number-Theoretic Transformation\n\nFFT`double`FFT\n\n\n\n$a$$p$$a^{k}\\equiv 1\\pmod{p}$$k$$a$$p$$\\delta_{p}(a)$\n\n$\\delta_{p}(a)=\\varphi(p)$$a$$p$\n\n$p=an+1$$a$$n$$2$$g$$\\omega_{n}=g^{a}$\n\n$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$\n\n$g^{0},g^{1},\\cdots,g^{n-1}$$p$$a$\n\n$\\omega_{2n}^{2k}=\\omega_{n}^{k}$\n\n$\\omega_{2n}=g^{\\frac{a}{2}}$$p$$\\cfrac{a}{2}\\cdot2n+1$\n\n$$\\omega_{2n}^{2k}=g^{\\frac{a}{2}\\cdot{2}k}=g^{ak}=\\omega_{n}^{k}$$\n\n\n\n$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\\omega_{n}^{\\frac{n}{2}}=-1$\n\n$p=an+1$\n\n$$\\omega_{n}^{n}\\equiv g^{an}\\equiv g^{p-1}\\equiv 1\\pmod{p}$$\n\n$\\omega_{n}^{\\frac{n}{2}}\\equiv\\pm 1\\pmod{p}$$\\omega_{n}^{0}=1$$\\omega_{n}^{\\frac{n}{2}}\\not\\equiv\\omega_{n}^{0}\\pmod{p}$$\\omega_{n}^{\\frac{n}{2}}\\equiv -1\\pmod{p}$\n\n$k\\neq 0$$\\sum_{i=0}^{n-1}(\\omega_{n}^{k})^{i}=0$\n\n$p=998244353=7\\times 17\\times 2^{23}+1$$3$\n\n$\\omega_{n}=g^{a}=g^{\\frac{p-1}{n}}$$998244353$$\\omega_{2},\\omega_{4},\\cdots,\\omega_{2^{23}}$\n\n$$\\omega_{2^{23}}=3^{7\\times 17}=3^{119}$$\n\n$$\\omega_{2^{k}}=\\omega_{2^{k+1}}^{2}$$\n\n$\\omega_{2^{23}}$\n\n$\\omega_{n}^{-k}$$\\omega_{n}^{k}$$998244353$$3$$998244353$$332748118$\n\nFFT\n\n\n\n```cpp\n#include<cstdio>\n#define re register\n#define maxn 2097152\n#define mod 998244353\n#define swap(a,b) a^=b,b^=a,a^=b\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m;\nint unit[2][24],rev[maxn+1],F[maxn+1],G[maxn+1];\n\ninline int cltpow(re int x,re int y){\n\tre int res=1;\n\tfor(;y;){\n\t\tif(y&1)\n\t\t\tres=1LL*res*x%mod;\n\t\tx=1LL*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\ninline void NTT(int* F,re int tp){\n\tfor(re int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(re int k=1,p=1;p<n;++k,p<<=1)\n\t\tfor(re int i=0;i<n;i+=p<<1)\n\t\t\tfor(re int j=i,tmp=1;j<i+p;++j,tmp=1LL*tmp*unit[tp][k]%mod){\n\t\t\t\tre int x=F[j],y=1LL*F[j+p]*tmp%mod;\n\t\t\t\tF[j]=(x+y)%mod;\n\t\t\t\tF[j+p]=(x-y+mod)%mod;\n\t\t\t}\n}\n\nint main(){\n\tunit[0][23]=cltpow(3,119);\n\tunit[1][23]=cltpow(332748118,119);\n\tfor(re int i=0;i<2;++i)\n\t\tfor(re int j=22;j>=0;--j)\n\t\t\tunit[i][j]=1LL*unit[i][j+1]*unit[i][j+1]%mod;\n\tcltstream::read(n);\n\tcltstream::read(m);\n\t++n;\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::read(F[i]);\n\t++m;\n\tfor(re int i=0;i<m;++i)\n\t\tcltstream::read(G[i]);\n\tfor(m+=n-1,n=1;n<m;n<<=1);\n\tfor(re int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tNTT(F,0);\n\tNTT(G,0);\n\tfor(re int i=0;i<n;++i)\n\t\tF[i]=1LL*F[i]*G[i]%mod;\n\tNTT(F,1);\n\tn=cltpow(n,mod-2);\n\tfor(re int i=0;i<m;++i)\n\t\tcltstream::write(1LL*F[i]*n%mod,i<m-1?32:-1);\n\tclop();\n\treturn 0;\n}\n```\n\n","source":"_posts/2018-12-19-polynomial-learning-notes-pt1.md","raw":"---\nmathjax: true\ndate: 2018-12-19 20:23:01\ntitle: Part I\ntags:\n  - FFT\n  - NTT\ncategories:\n  - \n---\nblog\n\n<!-- more -->\n\n$n-1$$F(x)$$m-1$$G(x)$$(F\\times G)(x)$$n,m\\leqslant 10^{6}$\n\n$F(x)$$i$$F[i]$\n\n$$F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}$$\n\n$$G(x)=\\sum\\limits_{i=0}^{m-1}G[i]x^{i}$$\n\n$$(F\\times G)(x)=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}F[i]G[j]x^{i+j}$$\n\n$$(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]$$\n\n$O(n^{2})$\n\n\n\n# \n\n$n$$(x_{0},y_{0}),(x_{1},y_{1}),\\cdots,(x_{n-1},y_{n-1})$$x_{i}$$n-1$\n\n\n\n$$(0,2),(1,7),(2,4)$$\n\n~~~~\n\n\n\n$$\\begin{cases}\n&\\text{C}=2\\\\\n&\\text{A}+\\text{B}+\\text{C}=7\\\\\n&4\\text{A}+2\\text{B}+\\text{C}=4\n\\end{cases}$$\n\n\n\n$$\\begin{cases}\n&\\text{A}=-4\\\\\n&\\text{B}=9\\\\\n&\\text{C}=2\n\\end{cases}$$\n\n$(F\\times G)(x)=F(x)G(x)$~~~~$F(x)$$G(x)$$O(n)$$(F\\times G)(x)$$(F\\times G)(x)$$n+m-2$$n+m-1$\n\n$O(n^{2})$\n\n\n\n# \n\n\n\n## \n\n\n\n$$x^{2}+1=0$$\n\n$\\Delta=b^{2}-4ac=-4\\lt 0$\n\n$i$$i^{2}=-1$$x+yi$$\\sqrt{x^{2}+y^{2}}$$x$$\\operatorname{tan}^{-1}\\cfrac{y}{x}$\n\n$i$$x$$y$$x+yi$$(x,y)$\n\n![](https://i.loli.net/2018/12/19/5c1a46b4d785b.png)\n\n$4+i$$3+4i$\n\n\n\n$$(x_{1}+y_{1}i)+(x_{2}+y_{2}i)=(x_{1}+x_{2})+(y_{1}+y_{2})i$$\n\n$$(x_{1}+y_{1}i)-(x_{2}+y_{2}i)=(x_{1}-x_{2})+(y_{1}-y_{2})i$$\n\n$$(x_{1}+y_{1}i)(x_{2}+y_{2}i)=(x_{1}x_{2}-y_{1}y_{2})+(x_{1}y_{2}+x_{2}y_{1})i$$\n\n$$\\begin{aligned}\n\\cfrac{x_{1}+y_{1}i}{x_{2}+y_{2}i}&=\\cfrac{(x_{1}+y_{1}i)(x_{2}-y_{2}i)}{(x_{2}+y_{2}i)(x_{2}-y_{2}i)}\\\\\n&=\\cfrac{(x_{1}x_{2}+y_{1}y_{2})+(x_{2}y_{1}-x_{1}y_{2})i}{x_{2}^{2}+y_{2}^{2}}\\\\\n&=\\cfrac{x_{1}x_{2}+y_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}+\\cfrac{x_{2}y_{1}-x_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}i\n\\end{aligned}$$\n\n\n\n$c_{1}$$c_{2}$$r_{1}$$r_{2}$$\\alpha_{1}$$\\alpha_{2}$\n\n$$c_{1}=r_{1}(\\operatorname{cos}\\alpha_{1}+i\\operatorname{sin}\\alpha_{1})$$\n\n$$c_{2}=r_{2}(\\operatorname{cos}\\alpha_{2}+i\\operatorname{sin}\\alpha_{2})$$\n\n$$\\begin{aligned}\nc_{1}c_{2}&=r_{1}r_{2}(\\cos\\alpha_{1}+i\\sin\\alpha_{1})(\\cos\\alpha_{2}+i\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}(\\cos\\alpha_{1}\\cos\\alpha_{2}+i\\cos\\alpha_{1}\\sin\\alpha_{2}+i\\sin\\alpha_{1}\\cos\\alpha_{2}-\\sin\\alpha_{1}\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}[\\cos(\\alpha_{1}+\\alpha_{2})+i\\sin(\\alpha_{1}+\\alpha_{2})]\n\\end{aligned}$$\n\n\n\n## \n\n$1$\n\n![](https://i.loli.net/2018/12/20/5c1b06e5602fa.png)\n\n\n\n$$x^{n}=1$$\n\n\n\n$n$$1$$1$$a$\n\n$$2\\pi\\mid na$$\n\n$$\\cfrac{2\\pi}{n}\\mid a$$\n\n$n$$\\cfrac{2k\\pi}{n}(k\\in[0,n)\\cap\\mathbb{Z})$$\\cfrac{2\\pi}{n}$$\\cos\\cfrac{2\\pi}{n}+i\\sin\\cfrac{2\\pi}{n}$$n$$\\omega_{n}$$n$$\\omega_{n}^{k}(k\\in[0,n)\\cap\\mathbb{Z})$\n\n\n\n$$\\omega_{2n}^{2k}=\\omega_{n}^{k}$$\n\n$1$\n\n\n\n$$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\n\n$\\omega_{n}^{\\frac{n}{2}}$$\\cfrac{2\\times\\frac{n}{2}\\pi}{n}=\\pi$$-1$\n\n# Fast Fourier Transformation\n\n## \n\n\n\nJean Baptiste Joseph Fourier$n$\n\n$0$$+1$$2$\n\n\n\n$$\\begin{aligned}\nF_{1}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i]x^{i}\\\\\n&=F[0]x^{0}+F[2]x^{1}+\\cdots+F[n-2]x^{\\frac{n}{2}-1}\n\\end{aligned}$$\n\n$$\\begin{aligned}\nF_{2}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i+1]x^{i}\\\\\n&=F[1]x^{0}+F[3]x^{1}+\\cdots+F[n-1]x^{\\frac{n}{2}-1}\n\\end{aligned}$$\n\n\n\n$$F(x)=F_{1}(x^{2})+xF_{2}(x^{2})$$\n\n$0\\leqslant k<\\cfrac{n}{2}$$x=\\omega_{n}^{k}$$x=\\omega_{n}^{k+\\frac{n}{2}}$\n\n$$\\begin{aligned}\nF(\\omega_{n}^{k})&=F_{1}(\\omega_{n}^{2k})+\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}$$\n\n$$\\begin{aligned}\nF(\\omega_{n}^{k+\\frac{n}{2}})&=F_{1}(\\omega_{n}^{2k+n})+\\omega_{n}^{k+\\frac{n}{2}}F_{2}(\\omega_{n}^{2k+n})\\\\\n&=F_{1}(\\omega_{n}^{2k})-\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}$$\n\n$F_{1}(x)$$F_{2}(x)$$O(n)$$F(x)$$n=1$\n\n\n\n```cpp\nvoid work(complex* F,int n){\n\tif(n==1)\n\t\treturn;\n\tcomplex F1[n>>1],F2[n>>1];\n    for(int i=0;i<n;i+=2){\n    \tF1[i]=F[2*i];\n        F2[i]=F[2*i+1];\n\t}\n    work(F1,n>>1);\n    work(F2,n>>1);\n    complex unit(cos(2*Pi/n),sin(2*Pi/n)),tmp=1;\n    for(int i=0;i<(n>>1);++i,tmp=tmp*unit){\n    \tcomplex w=F2[i+(n>>1)]*tmp;\n        F[i]=F1[i]+w;\n        F[i+(n>>1)]=F1[i]-w;\n\t}\n}\n```\n\n~~~~\n\n`F`\n\n```plaintext\n0 1 2 3 4 5 6 7\n0 2 4 6|1 3 5 7\n0 4|2 6|1 5|3 7\n0|4|2|6|1|5|3|7\n```\n\n\n\n|  |  |  |  |\n| :-: | :-: | :-: | :-: |\n| $0$ | $000$ | $0$ | $000$ |\n| $1$ | $001$ | $4$ | $100$ |\n| $2$ | $010$ | $2$ | $010$ |\n| $3$ | $011$ | $6$ | $110$ |\n| $4$ | $100$ | $1$ | $001$ |\n| $5$ | $101$ | $5$ | $101$ |\n| $6$ | $110$ | $3$ | $011$ |\n| $7$ | $111$ | $7$ | $111$ |\n\n$\\operatorname{log}n$\n\n$O(n)$\n\n```cpp\nfor(int i=0;i<n;++i)\n\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n```\n\n$i$$i$$1$$1$\n\n\n\n```cpp\nvoid work(complex* F,int n){\n\tfor(int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tcomplex unit(cos(Pi/p),sin(Pi/p));\n\t\tfor(int i=0;i<n;i+=len){\n\t\t\tcomplex cur(1,0);\n\t\t\tfor(int j=i;j<i+p;++j){\n\t\t\t\tcomplex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n$F(\\omega_{n}^{0}),F(\\omega_{n}^{1}),\\cdots,F(\\omega_{n}^{n-1})$$y_{0},y_{1},\\cdots,y_{n-1}$\n\n$$\\begin{bmatrix}\n&(\\omega_{n}^{0})^{0}&(\\omega_{n}^{0})^{1}&\\cdots&(\\omega_{n}^{0})^{n-1}&\\\\\n&(\\omega_{n}^{1})^{0}&(\\omega_{n}^{1})^{1}&\\cdots&(\\omega_{n}^{1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&(\\omega_{n}^{n-1})^{0}&(\\omega_{n}^{n-1})^{1}&\\cdots&(\\omega_{n}^{n-1})^{n-1}\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\n&F[0]&\\\\\n&F[1]\\\\\n&\\vdots\\\\\n&F[n-1]\n\\end{bmatrix}\n=\\begin{bmatrix}\n&y_{0}&\\\\\n&y_{1}\\\\\n&\\vdots\\\\\n&y_{n-1}\n\\end{bmatrix}$$\n\n\n\n$$\\begin{bmatrix}\n&\\frac{1}{n}(\\omega_{n}^{0})^{0}&\\frac{1}{n}(\\omega_{n}^{0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{0})^{n-1}&\\\\\n&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\n\\end{bmatrix}$$\n\n$A$$B$$A\\times B=C$$A[i][j]=\\omega_{n}^{ij}$$B[i][j]=\\cfrac{1}{n}\\omega_{n}^{-ij}$\n\n$$\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}A[i][k]B[k][j]\\\\\n&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{ik-kj}\n\\end{aligned}$$\n\n$i=j$$C[i][j]=1$\n\n$i\\neq j$$i-j=l$\n\n$$\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{lk}\\\\\n&=\\cfrac{\\omega_{n}^{ln}-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=\\cfrac{1-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=0\n\\end{aligned}$$\n\n$C$$B$$A$\n\n\n\n$$\\begin{bmatrix}&\\frac{1}{n}(\\omega_{n}^{-0})^{0}&\\frac{1}{n}(\\omega_{n}^{-0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-0})^{n-1}&\\\\&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\&\\vdots&\\vdots&\\ddots&\\vdots\\\\&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\\end{bmatrix}\\begin{bmatrix}&y_{0}&\\\\&y_{1}\\\\&\\vdots\\\\&y_{n-1}\\end{bmatrix}=\\begin{bmatrix}&F[0]&\\\\&F[1]\\\\&\\vdots\\\\&F[n-1]\\end{bmatrix}$$\n\n$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$$\\omega_{n}^{0},\\omega_{n}^{-1},\\cdots,\\omega_{n}^{-n+1}$FFT$n$\n\n\n\n```cpp\ncomplex unit(cos(Pi/p),sin(Pi/p));\n```\n\n\n\n```cpp\ncomplex unit(cos(Pi/p),tp*sin(Pi/p));\n```\n\n`tp``tp=1``tp=-1`\n\n\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#define maxn 2097152\n\nconst double Pi=acos(-1.0);\n\nint n,m;\nint rev[maxn+1];\nstruct complex{\n\tdouble r,c;\n\t\n\tcomplex(double _r=0,double _c=0){\n\t\tr=_r;\n\t\tc=_c;\n\t}\n};\ncomplex F[maxn+1],G[maxn+1];\n\ninline complex operator+(complex& a,complex& b){\n\treturn complex(a.r+b.r,a.c+b.c);\n}\n\ninline complex operator-(complex& a,complex& b){\n\treturn complex(a.r-b.r,a.c-b.c);\n}\n\ninline complex operator*(complex& a,complex& b){\n\treturn complex(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);\n}\n\ntemplate<typename _tp>\ninline void swap(_tp& x,_tp& y){\n\t_tp tmp=x;\n\tx=y;\n\ty=tmp;\n}\n\ninline void FAQ(complex F[],int tp){\n\tfor(register int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(register int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));\n\t\tfor(register int i=0;i<n;i+=len){\n\t\t\tregister complex cur(1,0);\n\t\t\tfor(register int j=i;j<i+p;++j){\n\t\t\t\tregister complex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\t++n;\n\tfor(register int i=0;i<n;++i)\n\t\tscanf(\"%d\",&F[i].r);\n\t++m;\n\tfor(register int i=0;i<m;++i)\n\t\tscanf(\"%d\",&G[i].r);\n\tfor(m+=n-1,n=1;n<m;n<<=1);\n\tfor(register int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tFAQ(F,1);\n\tFAQ(G,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF[i]=F[i]*G[i];\n\tFAQ(F,-1);\n\tfor(register int i=0;i<m;++i)\n\t\tprintf(\"%0.0lf \",F[i].r/n);\n\treturn 0;\n}\n```\n\n~~`cltstream`~~\n\n[](https://www.luogu.org/problemnew/show/P3803)\n\n\n\n\n\n\n\n## \n\n### [ZJOI2014](https://www.luogu.org/problemnew/show/P3338)\n\n\n\n$n$$F$$G$$H$\n\n$$H[i]=\\sum\\limits_{j=0}^{i}F[j]G[i-j]=\\sum\\limits_{0\\leqslant j<n,0\\leqslant k<n,j+k=i}F[j]G[k]$$\n\n\n\n$$(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]$$\n\n\n\n\n\n$$F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}$$\n\n$$G(x)=\\sum\\limits_{i=0}^{n-1}G[i]x^{i}$$\n\nFFT$n$\n\n$j\\lt i$$j\\gt i$\n\n$j\\lt i$$F[i]=q_{i}$$G[i]=\\begin{cases}&\\cfrac{1}{i^{2}}\\;\\;&(i\\gt 0)\\\\&0&(i=0)\\end{cases}$\n\n$$\\begin{aligned}\nE_{i}&=\\sum_{j=0}^{i-1}F[j]G[i-j]\\\\\n&=\\sum_{j=0}^{i}F[j]G[i-j]\n\\end{aligned}$$\n\n\n\n$j>i$$F$\n\n\n\n```cpp\n#include\\lt cstdio>\n#include<cmath>\n#define maxn 2097152\n\nconst double Pi=acos(-1.0);\n\nint n,m;\nint rev[maxn+1];\nstruct complex{\n\tdouble r,c;\n\t\n\tcomplex(double _r=0,double _c=0){\n\t\tr=_r;\n\t\tc=_c;\n\t}\n};\ncomplex F1[maxn+1],F2[maxn+1],G[maxn+1];\n\ninline complex operator+(complex& a,complex& b){\n\treturn complex(a.r+b.r,a.c+b.c);\n}\n\ninline complex operator-(complex& a,complex& b){\n\treturn complex(a.r-b.r,a.c-b.c);\n}\n\ninline complex operator*(complex& a,complex& b){\n\treturn complex(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);\n}\n\ntemplate<typename _tp>\ninline void swap(_tp& x,_tp& y){\n\t_tp tmp=x;\n\tx=y;\n\ty=tmp;\n}\n\ninline void FAQ(complex F[],int tp){\n\tfor(register int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(register int len=2,p=1;len<=n;len<<=1,p<<=1){\n\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));\n\t\tfor(register int i=0;i<n;i+=len){\n\t\t\tregister complex cur(1,0);\n\t\t\tfor(register int j=i;j<i+p;++j){\n\t\t\t\tregister complex tmp=F[j+p]*cur;\n\t\t\t\tF[j+p]=F[j]-tmp;\n\t\t\t\tF[j]=F[j]+tmp;\n\t\t\t\tcur=cur*unit;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(register int i=0;i<n;++i){\n\t\tscanf(\"%lf\",&F1[i].r);\n\t\tF2[n-i-1].r=F1[i].r;\n\t}\n\tfor(register int i=1;i<n;++i)\n\t\tG[i]=1.0/i/i;\n\tfor(m=n,n=1;n<m;n<<=1);\n\tn<<=1;\n\tfor(register int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tFAQ(G,1);\n\tFAQ(F1,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF1[i]=F1[i]*G[i];\n\tFAQ(F1,-1);\n\tFAQ(F2,1);\n\tfor(register int i=0;i<n;++i)\n\t\tF2[i]=F2[i]*G[i];\n\tFAQ(F2,-1);\n\tfor(register int i=0;i<m;++i)\n\t\tprintf(\"%lf\\n\",(F1[i].r-F2[m-i-1].r)/n);\n\treturn 0;\n}\n```\n\n# Number-Theoretic Transformation\n\nFFT`double`FFT\n\n\n\n$a$$p$$a^{k}\\equiv 1\\pmod{p}$$k$$a$$p$$\\delta_{p}(a)$\n\n$\\delta_{p}(a)=\\varphi(p)$$a$$p$\n\n$p=an+1$$a$$n$$2$$g$$\\omega_{n}=g^{a}$\n\n$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$\n\n$g^{0},g^{1},\\cdots,g^{n-1}$$p$$a$\n\n$\\omega_{2n}^{2k}=\\omega_{n}^{k}$\n\n$\\omega_{2n}=g^{\\frac{a}{2}}$$p$$\\cfrac{a}{2}\\cdot2n+1$\n\n$$\\omega_{2n}^{2k}=g^{\\frac{a}{2}\\cdot{2}k}=g^{ak}=\\omega_{n}^{k}$$\n\n\n\n$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\\omega_{n}^{\\frac{n}{2}}=-1$\n\n$p=an+1$\n\n$$\\omega_{n}^{n}\\equiv g^{an}\\equiv g^{p-1}\\equiv 1\\pmod{p}$$\n\n$\\omega_{n}^{\\frac{n}{2}}\\equiv\\pm 1\\pmod{p}$$\\omega_{n}^{0}=1$$\\omega_{n}^{\\frac{n}{2}}\\not\\equiv\\omega_{n}^{0}\\pmod{p}$$\\omega_{n}^{\\frac{n}{2}}\\equiv -1\\pmod{p}$\n\n$k\\neq 0$$\\sum_{i=0}^{n-1}(\\omega_{n}^{k})^{i}=0$\n\n$p=998244353=7\\times 17\\times 2^{23}+1$$3$\n\n$\\omega_{n}=g^{a}=g^{\\frac{p-1}{n}}$$998244353$$\\omega_{2},\\omega_{4},\\cdots,\\omega_{2^{23}}$\n\n$$\\omega_{2^{23}}=3^{7\\times 17}=3^{119}$$\n\n$$\\omega_{2^{k}}=\\omega_{2^{k+1}}^{2}$$\n\n$\\omega_{2^{23}}$\n\n$\\omega_{n}^{-k}$$\\omega_{n}^{k}$$998244353$$3$$998244353$$332748118$\n\nFFT\n\n\n\n```cpp\n#include<cstdio>\n#define re register\n#define maxn 2097152\n#define mod 998244353\n#define swap(a,b) a^=b,b^=a,a^=b\n\nnamespace cltstream{\n\t#define size 1048576\n\tchar cltin[size+1],*ih=cltin,*it=cltin;\n\tinline char gc(){\n\t\t#ifdef ONLINE_JUDGE\n\t\t\tif(ih==it){\n\t\t\t\tit=(ih=cltin)+fread(cltin,1,size,stdin);\n\t\t\t\tif(ih==it)\n\t\t\t\t\treturn EOF;\n\t\t\t}\n\t\t\treturn *ih++;\n\t\t#else\n\t\t\treturn getchar();\n\t\t#endif\n\t}\n\n\tchar cltout[size+1],*oh=cltout,*ot=cltout+size;\n\tinline void pc(char c){\n\t\tif(oh==ot){\n\t\t\tfwrite(cltout,1,size,stdout);\n\t\t\toh=cltout;\n\t\t}\n\t\t*oh++=c;\n\t}\n\t#define clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)\n\t#undef size\n\n\ttemplate <typename _tp>\n\tinline void read(_tp& x){\n\t\tint sn=1;\n\t\tchar c=gc();\n\t\tfor(;c!=45&&(c<48||c>57)&&c!=EOF;c=gc());\n\t\tif(c==45&&c!=EOF)\n\t\t\tsn=-1,c=gc();\n\t\tfor(x=0;c>=48&&c<=57&&c!=EOF;x=(x<<3)+(x<<1)+(c^48),c=gc());\n\t\tx*=sn;\n\t}\n\n\ttemplate <typename _tp>\n\tinline void write(_tp x,char text=-1){\n\t\tif(x<0)\n\t\t\tpc(45),x=-x;\n\t\tif(!x)\n\t\t\tpc(48);\n\t\telse{\n\t\t\tint digit[22];\n\t\t\tfor(digit[0]=0;x;digit[++digit[0]]=x%10,x/=10);\n\t\t\tfor(;digit[0];pc(digit[digit[0]--]^48));\n\t\t}\n\t\tif(text>=0)\n\t\t\tpc(text);\n\t}\n}\n\nint n,m;\nint unit[2][24],rev[maxn+1],F[maxn+1],G[maxn+1];\n\ninline int cltpow(re int x,re int y){\n\tre int res=1;\n\tfor(;y;){\n\t\tif(y&1)\n\t\t\tres=1LL*res*x%mod;\n\t\tx=1LL*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\ninline void NTT(int* F,re int tp){\n\tfor(re int i=0;i<n;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(F[i],F[rev[i]]);\n\tfor(re int k=1,p=1;p<n;++k,p<<=1)\n\t\tfor(re int i=0;i<n;i+=p<<1)\n\t\t\tfor(re int j=i,tmp=1;j<i+p;++j,tmp=1LL*tmp*unit[tp][k]%mod){\n\t\t\t\tre int x=F[j],y=1LL*F[j+p]*tmp%mod;\n\t\t\t\tF[j]=(x+y)%mod;\n\t\t\t\tF[j+p]=(x-y+mod)%mod;\n\t\t\t}\n}\n\nint main(){\n\tunit[0][23]=cltpow(3,119);\n\tunit[1][23]=cltpow(332748118,119);\n\tfor(re int i=0;i<2;++i)\n\t\tfor(re int j=22;j>=0;--j)\n\t\t\tunit[i][j]=1LL*unit[i][j+1]*unit[i][j+1]%mod;\n\tcltstream::read(n);\n\tcltstream::read(m);\n\t++n;\n\tfor(re int i=0;i<n;++i)\n\t\tcltstream::read(F[i]);\n\t++m;\n\tfor(re int i=0;i<m;++i)\n\t\tcltstream::read(G[i]);\n\tfor(m+=n-1,n=1;n<m;n<<=1);\n\tfor(re int i=0;i<n;++i)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)?(n>>1):0);\n\tNTT(F,0);\n\tNTT(G,0);\n\tfor(re int i=0;i<n;++i)\n\t\tF[i]=1LL*F[i]*G[i]%mod;\n\tNTT(F,1);\n\tn=cltpow(n,mod-2);\n\tfor(re int i=0;i<m;++i)\n\t\tcltstream::write(1LL*F[i]*n%mod,i<m-1?32:-1);\n\tclop();\n\treturn 0;\n}\n```\n\n","slug":"polynomial-learning-notes-pt1","published":1,"updated":"2018-12-25T00:58:11.054Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w500030gwguhf99x4ek","content":"<p>blog</p>\n<a id=\"more\"></a>\n<p>$n-1$$F(x)$$m-1$$G(x)$$(F\\times G)(x)$$n,m\\leqslant 10^{6}$</p>\n<p>$F(x)$$i$$F[i]$</p>\n<script type=\"math/tex; mode=display\">F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}</script><script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{m-1}G[i]x^{i}</script><script type=\"math/tex; mode=display\">(F\\times G)(x)=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}F[i]G[j]x^{i+j}</script><script type=\"math/tex; mode=display\">(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]</script><p>$O(n^{2})$</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>$n$$(x_{0},y_{0}),(x_{1},y_{1}),\\cdots,(x_{n-1},y_{n-1})$$x_{i}$$n-1$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(0,2),(1,7),(2,4)</script><p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{cases}\n&\\text{C}=2\\\\\n&\\text{A}+\\text{B}+\\text{C}=7\\\\\n&4\\text{A}+2\\text{B}+\\text{C}=4\n\\end{cases}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{cases}\n&\\text{A}=-4\\\\\n&\\text{B}=9\\\\\n&\\text{C}=2\n\\end{cases}</script><p>$(F\\times G)(x)=F(x)G(x)$<del></del>$F(x)$$G(x)$$O(n)$$(F\\times G)(x)$$(F\\times G)(x)$$n+m-2$$n+m-1$</p>\n<p>$O(n^{2})$</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<script type=\"math/tex; mode=display\">x^{2}+1=0</script><p>$\\Delta=b^{2}-4ac=-4\\lt 0$</p>\n<p>$i$$i^{2}=-1$$x+yi$$\\sqrt{x^{2}+y^{2}}$$x$$\\operatorname{tan}^{-1}\\cfrac{y}{x}$</p>\n<p>$i$$x$$y$$x+yi$$(x,y)$</p>\n<p><img src=\"https://i.loli.net/2018/12/19/5c1a46b4d785b.png\" alt=\"\"></p>\n<p>$4+i$$3+4i$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)+(x_{2}+y_{2}i)=(x_{1}+x_{2})+(y_{1}+y_{2})i</script><script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)-(x_{2}+y_{2}i)=(x_{1}-x_{2})+(y_{1}-y_{2})i</script><script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)(x_{2}+y_{2}i)=(x_{1}x_{2}-y_{1}y_{2})+(x_{1}y_{2}+x_{2}y_{1})i</script><script type=\"math/tex; mode=display\">\\begin{aligned}\n\\cfrac{x_{1}+y_{1}i}{x_{2}+y_{2}i}&=\\cfrac{(x_{1}+y_{1}i)(x_{2}-y_{2}i)}{(x_{2}+y_{2}i)(x_{2}-y_{2}i)}\\\\\n&=\\cfrac{(x_{1}x_{2}+y_{1}y_{2})+(x_{2}y_{1}-x_{1}y_{2})i}{x_{2}^{2}+y_{2}^{2}}\\\\\n&=\\cfrac{x_{1}x_{2}+y_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}+\\cfrac{x_{2}y_{1}-x_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}i\n\\end{aligned}</script><p></p>\n<p>$c_{1}$$c_{2}$$r_{1}$$r_{2}$$\\alpha_{1}$$\\alpha_{2}$</p>\n<script type=\"math/tex; mode=display\">c_{1}=r_{1}(\\operatorname{cos}\\alpha_{1}+i\\operatorname{sin}\\alpha_{1})</script><script type=\"math/tex; mode=display\">c_{2}=r_{2}(\\operatorname{cos}\\alpha_{2}+i\\operatorname{sin}\\alpha_{2})</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nc_{1}c_{2}&=r_{1}r_{2}(\\cos\\alpha_{1}+i\\sin\\alpha_{1})(\\cos\\alpha_{2}+i\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}(\\cos\\alpha_{1}\\cos\\alpha_{2}+i\\cos\\alpha_{1}\\sin\\alpha_{2}+i\\sin\\alpha_{1}\\cos\\alpha_{2}-\\sin\\alpha_{1}\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}[\\cos(\\alpha_{1}+\\alpha_{2})+i\\sin(\\alpha_{1}+\\alpha_{2})]\n\\end{aligned}</script><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$1$</p>\n<p><img src=\"https://i.loli.net/2018/12/20/5c1b06e5602fa.png\" alt=\"\"></p>\n<p></p>\n<script type=\"math/tex; mode=display\">x^{n}=1</script><p></p>\n<p>$n$$1$$1$$a$</p>\n<script type=\"math/tex; mode=display\">2\\pi\\mid na</script><script type=\"math/tex; mode=display\">\\cfrac{2\\pi}{n}\\mid a</script><p>$n$$\\cfrac{2k\\pi}{n}(k\\in[0,n)\\cap\\mathbb{Z})$$\\cfrac{2\\pi}{n}$$\\cos\\cfrac{2\\pi}{n}+i\\sin\\cfrac{2\\pi}{n}$$n$$\\omega_{n}$$n$$\\omega_{n}^{k}(k\\in[0,n)\\cap\\mathbb{Z})$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\omega_{2n}^{2k}=\\omega_{n}^{k}</script><p>$1$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}</script><p>$\\omega_{n}^{\\frac{n}{2}}$$\\cfrac{2\\times\\frac{n}{2}\\pi}{n}=\\pi$$-1$</p>\n<h1 id=\"Fast-Fourier-Transformation\"><a href=\"#Fast-Fourier-Transformation\" class=\"headerlink\" title=\"Fast Fourier Transformation\"></a>Fast Fourier Transformation</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>Jean Baptiste Joseph Fourier$n$</p>\n<p>$0$$+1$$2$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF_{1}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i]x^{i}\\\\\n&=F[0]x^{0}+F[2]x^{1}+\\cdots+F[n-2]x^{\\frac{n}{2}-1}\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nF_{2}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i+1]x^{i}\\\\\n&=F[1]x^{0}+F[3]x^{1}+\\cdots+F[n-1]x^{\\frac{n}{2}-1}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">F(x)=F_{1}(x^{2})+xF_{2}(x^{2})</script><p>$0\\leqslant k&lt;\\cfrac{n}{2}$$x=\\omega_{n}^{k}$$x=\\omega_{n}^{k+\\frac{n}{2}}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(\\omega_{n}^{k})&=F_{1}(\\omega_{n}^{2k})+\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nF(\\omega_{n}^{k+\\frac{n}{2}})&=F_{1}(\\omega_{n}^{2k+n})+\\omega_{n}^{k+\\frac{n}{2}}F_{2}(\\omega_{n}^{2k+n})\\\\\n&=F_{1}(\\omega_{n}^{2k})-\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}</script><p>$F_{1}(x)$$F_{2}(x)$$O(n)$$F(x)$$n=1$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">(<span class=\"keyword\">complex</span>* F,<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span> F1[n&gt;&gt;<span class=\"number\">1</span>],F2[n&gt;&gt;<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">    \tF1[i]=F[<span class=\"number\">2</span>*i];</span><br><span class=\"line\">        F2[i]=F[<span class=\"number\">2</span>*i+<span class=\"number\">1</span>];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    work(F1,n&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\">    work(F2,n&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\">    complex unit(cos(2*Pi/n),sin(2*Pi/n)),tmp=1;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(n&gt;&gt;<span class=\"number\">1</span>);++i,tmp=tmp*unit)&#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">complex</span> w=F2[i+(n&gt;&gt;<span class=\"number\">1</span>)]*tmp;</span><br><span class=\"line\">        F[i]=F1[i]+w;</span><br><span class=\"line\">        F[i+(n&gt;&gt;<span class=\"number\">1</span>)]=F1[i]-w;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><del></del></p>\n<p><code>F</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0 1 2 3 4 5 6 7</span><br><span class=\"line\">0 2 4 6|1 3 5 7</span><br><span class=\"line\">0 4|2 6|1 5|3 7</span><br><span class=\"line\">0|4|2|6|1|5|3|7</span><br></pre></td></tr></table></figure>\n<p></p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">$0$</td>\n<td style=\"text-align:center\">$000$</td>\n<td style=\"text-align:center\">$0$</td>\n<td style=\"text-align:center\">$000$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$1$</td>\n<td style=\"text-align:center\">$001$</td>\n<td style=\"text-align:center\">$4$</td>\n<td style=\"text-align:center\">$100$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$2$</td>\n<td style=\"text-align:center\">$010$</td>\n<td style=\"text-align:center\">$2$</td>\n<td style=\"text-align:center\">$010$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$3$</td>\n<td style=\"text-align:center\">$011$</td>\n<td style=\"text-align:center\">$6$</td>\n<td style=\"text-align:center\">$110$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$4$</td>\n<td style=\"text-align:center\">$100$</td>\n<td style=\"text-align:center\">$1$</td>\n<td style=\"text-align:center\">$001$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$5$</td>\n<td style=\"text-align:center\">$101$</td>\n<td style=\"text-align:center\">$5$</td>\n<td style=\"text-align:center\">$101$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$6$</td>\n<td style=\"text-align:center\">$110$</td>\n<td style=\"text-align:center\">$3$</td>\n<td style=\"text-align:center\">$011$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$7$</td>\n<td style=\"text-align:center\">$111$</td>\n<td style=\"text-align:center\">$7$</td>\n<td style=\"text-align:center\">$111$</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>$\\operatorname{log}n$</p>\n<p>$O(n)$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<p>$i$$i$$1$$1$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">(<span class=\"keyword\">complex</span>* F,<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tcomplex unit(cos(Pi/p),sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$F(\\omega_{n}^{0}),F(\\omega_{n}^{1}),\\cdots,F(\\omega_{n}^{n-1})$$y_{0},y_{1},\\cdots,y_{n-1}$</p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}\n&(\\omega_{n}^{0})^{0}&(\\omega_{n}^{0})^{1}&\\cdots&(\\omega_{n}^{0})^{n-1}&\\\\\n&(\\omega_{n}^{1})^{0}&(\\omega_{n}^{1})^{1}&\\cdots&(\\omega_{n}^{1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&(\\omega_{n}^{n-1})^{0}&(\\omega_{n}^{n-1})^{1}&\\cdots&(\\omega_{n}^{n-1})^{n-1}\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\n&F[0]&\\\\\n&F[1]\\\\\n&\\vdots\\\\\n&F[n-1]\n\\end{bmatrix}\n=\\begin{bmatrix}\n&y_{0}&\\\\\n&y_{1}\\\\\n&\\vdots\\\\\n&y_{n-1}\n\\end{bmatrix}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}\n&\\frac{1}{n}(\\omega_{n}^{0})^{0}&\\frac{1}{n}(\\omega_{n}^{0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{0})^{n-1}&\\\\\n&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\n\\end{bmatrix}</script><p>$A$$B$$A\\times B=C$$A[i][j]=\\omega_{n}^{ij}$$B[i][j]=\\cfrac{1}{n}\\omega_{n}^{-ij}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}A[i][k]B[k][j]\\\\\n&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{ik-kj}\n\\end{aligned}</script><p>$i=j$$C[i][j]=1$</p>\n<p>$i\\neq j$$i-j=l$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{lk}\\\\\n&=\\cfrac{\\omega_{n}^{ln}-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=\\cfrac{1-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=0\n\\end{aligned}</script><p>$C$$B$$A$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}&\\frac{1}{n}(\\omega_{n}^{-0})^{0}&\\frac{1}{n}(\\omega_{n}^{-0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-0})^{n-1}&\\\\&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\&\\vdots&\\vdots&\\ddots&\\vdots\\\\&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\\end{bmatrix}\\begin{bmatrix}&y_{0}&\\\\&y_{1}\\\\&\\vdots\\\\&y_{n-1}\\end{bmatrix}=\\begin{bmatrix}&F[0]&\\\\&F[1]\\\\&\\vdots\\\\&F[n-1]\\end{bmatrix}</script><p>$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$$\\omega_{n}^{0},\\omega_{n}^{-1},\\cdots,\\omega_{n}^{-n+1}$FFT$n$</p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">complex unit(cos(Pi/p),sin(Pi/p));</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br></pre></td></tr></table></figure>\n<p><code>tp</code><code>tp=1</code><code>tp=-1</code></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Pi=<span class=\"built_in\">acos</span>(<span class=\"number\">-1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> rev[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">complex</span>&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">double</span> r,c;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span>(<span class=\"keyword\">double</span> _r=<span class=\"number\">0</span>,<span class=\"keyword\">double</span> _c=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\tr=_r;</span><br><span class=\"line\">\t\tc=_c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">complex</span> F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>+(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r+b.r,a.c+b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>-(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r-b.r,a.c-b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>*(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(_tp&amp; x,_tp&amp; y)</span></span>&#123;</span><br><span class=\"line\">\t_tp tmp=x;</span><br><span class=\"line\">\tx=y;</span><br><span class=\"line\">\ty=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">FAQ</span><span class=\"params\">(<span class=\"keyword\">complex</span> F[],<span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>,&amp;n,&amp;m);</span><br><span class=\"line\">\t++n;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;F[i].r);</span><br><span class=\"line\">\t++m;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;G[i].r);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m+=n<span class=\"number\">-1</span>,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tFAQ(F,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tFAQ(G,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=F[i]*G[i];</span><br><span class=\"line\">\tFAQ(F,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%0.0lf \"</span>,F[i].r/n);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><del><code>cltstream</code></del></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P3803\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"ZJOI2014\"><a href=\"#ZJOI2014\" class=\"headerlink\" title=\"ZJOI2014\"></a><a href=\"https://www.luogu.org/problemnew/show/P3338\" target=\"_blank\" rel=\"noopener\">ZJOI2014</a></h3><p></p>\n<p>$n$$F$$G$$H$</p>\n<script type=\"math/tex; mode=display\">H[i]=\\sum\\limits_{j=0}^{i}F[j]G[i-j]=\\sum\\limits_{0\\leqslant j<n,0\\leqslant k<n,j+k=i}F[j]G[k]</script><p></p>\n<script type=\"math/tex; mode=display\">(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]</script><p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}</script><script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{n-1}G[i]x^{i}</script><p>FFT$n$</p>\n<p>$j\\lt i$$j\\gt i$</p>\n<p>$j\\lt i$$F[i]=q_{i}$$G[i]=\\begin{cases}&amp;\\cfrac{1}{i^{2}}\\;\\;&amp;(i\\gt 0)\\\\&amp;0&amp;(i=0)\\end{cases}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nE_{i}&=\\sum_{j=0}^{i-1}F[j]G[i-j]\\\\\n&=\\sum_{j=0}^{i}F[j]G[i-j]\n\\end{aligned}</script><p></p>\n<p>$j&gt;i$$F$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span>\\lt cstdio&gt;</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Pi=<span class=\"built_in\">acos</span>(<span class=\"number\">-1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> rev[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">complex</span>&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">double</span> r,c;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span>(<span class=\"keyword\">double</span> _r=<span class=\"number\">0</span>,<span class=\"keyword\">double</span> _c=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\tr=_r;</span><br><span class=\"line\">\t\tc=_c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">complex</span> F1[maxn+<span class=\"number\">1</span>],F2[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>+(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r+b.r,a.c+b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>-(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r-b.r,a.c-b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>*(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(_tp&amp; x,_tp&amp; y)</span></span>&#123;</span><br><span class=\"line\">\t_tp tmp=x;</span><br><span class=\"line\">\tx=y;</span><br><span class=\"line\">\ty=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">FAQ</span><span class=\"params\">(<span class=\"keyword\">complex</span> F[],<span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%lf\"</span>,&amp;F1[i].r);</span><br><span class=\"line\">\t\tF2[n-i<span class=\"number\">-1</span>].r=F1[i].r;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1.0</span>/i/i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m=n,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\tn&lt;&lt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tFAQ(G,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tFAQ(F1,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF1[i]=F1[i]*G[i];</span><br><span class=\"line\">\tFAQ(F1,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tFAQ(F2,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF2[i]=F2[i]*G[i];</span><br><span class=\"line\">\tFAQ(F2,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%lf\\n\"</span>,(F1[i].r-F2[m-i<span class=\"number\">-1</span>].r)/n);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"Number-Theoretic-Transformation\"><a href=\"#Number-Theoretic-Transformation\" class=\"headerlink\" title=\"Number-Theoretic Transformation\"></a>Number-Theoretic Transformation</h1><p>FFT<code>double</code>FFT</p>\n<p></p>\n<p>$a$$p$$a^{k}\\equiv 1\\pmod{p}$$k$$a$$p$$\\delta_{p}(a)$</p>\n<p>$\\delta_{p}(a)=\\varphi(p)$$a$$p$</p>\n<p>$p=an+1$$a$$n$$2$$g$$\\omega_{n}=g^{a}$</p>\n<p>$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$</p>\n<p>$g^{0},g^{1},\\cdots,g^{n-1}$$p$$a$</p>\n<p>$\\omega_{2n}^{2k}=\\omega_{n}^{k}$</p>\n<p>$\\omega_{2n}=g^{\\frac{a}{2}}$$p$$\\cfrac{a}{2}\\cdot2n+1$</p>\n<script type=\"math/tex; mode=display\">\\omega_{2n}^{2k}=g^{\\frac{a}{2}\\cdot{2}k}=g^{ak}=\\omega_{n}^{k}</script><p></p>\n<p>$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\\omega_{n}^{\\frac{n}{2}}=-1$</p>\n<p>$p=an+1$</p>\n<script type=\"math/tex; mode=display\">\\omega_{n}^{n}\\equiv g^{an}\\equiv g^{p-1}\\equiv 1\\pmod{p}</script><p>$\\omega_{n}^{\\frac{n}{2}}\\equiv\\pm 1\\pmod{p}$$\\omega_{n}^{0}=1$$\\omega_{n}^{\\frac{n}{2}}\\not\\equiv\\omega_{n}^{0}\\pmod{p}$$\\omega_{n}^{\\frac{n}{2}}\\equiv -1\\pmod{p}$</p>\n<p>$k\\neq 0$$\\sum_{i=0}^{n-1}(\\omega_{n}^{k})^{i}=0$</p>\n<p>$p=998244353=7\\times 17\\times 2^{23}+1$$3$</p>\n<p>$\\omega_{n}=g^{a}=g^{\\frac{p-1}{n}}$$998244353$$\\omega_{2},\\omega_{4},\\cdots,\\omega_{2^{23}}$</p>\n<script type=\"math/tex; mode=display\">\\omega_{2^{23}}=3^{7\\times 17}=3^{119}</script><script type=\"math/tex; mode=display\">\\omega_{2^{k}}=\\omega_{2^{k+1}}^{2}</script><p>$\\omega_{2^{23}}$</p>\n<p>$\\omega_{n}^{-k}$$\\omega_{n}^{k}$$998244353$$3$$998244353$$332748118$</p>\n<p>FFT</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> swap(a,b) a^=b,b^=a,a^=b</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> unit[<span class=\"number\">2</span>][<span class=\"number\">24</span>],rev[maxn+<span class=\"number\">1</span>],F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(re <span class=\"keyword\">int</span> x,re <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> res=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;y;)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tres=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">\t\tx=<span class=\"number\">1L</span>L*x*x%mod;</span><br><span class=\"line\">\t\ty&gt;&gt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(<span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">1</span>,p=<span class=\"number\">1</span>;p&lt;n;++k,p&lt;&lt;=<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=p&lt;&lt;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=i,tmp=<span class=\"number\">1</span>;j&lt;i+p;++j,tmp=<span class=\"number\">1L</span>L*tmp*unit[tp][k]%mod)&#123;</span><br><span class=\"line\">\t\t\t\tre <span class=\"keyword\">int</span> x=F[j],y=<span class=\"number\">1L</span>L*F[j+p]*tmp%mod;</span><br><span class=\"line\">\t\t\t\tF[j]=(x+y)%mod;</span><br><span class=\"line\">\t\t\t\tF[j+p]=(x-y+mod)%mod;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tunit[<span class=\"number\">0</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">3</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\tunit[<span class=\"number\">1</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">332748118</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">2</span>;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">22</span>;j&gt;=<span class=\"number\">0</span>;--j)</span><br><span class=\"line\">\t\t\tunit[i][j]=<span class=\"number\">1L</span>L*unit[i][j+<span class=\"number\">1</span>]*unit[i][j+<span class=\"number\">1</span>]%mod;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\t++n;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::read(F[i]);</span><br><span class=\"line\">\t++m;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\tcltstream::read(G[i]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m+=n<span class=\"number\">-1</span>,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(F,<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(G,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=<span class=\"number\">1L</span>L*F[i]*G[i]%mod;</span><br><span class=\"line\">\tNTT(F,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tn=cltpow(n,mod<span class=\"number\">-2</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\tcltstream::write(<span class=\"number\">1L</span>L*F[i]*n%mod,i&lt;m<span class=\"number\">-1</span>?<span class=\"number\">32</span>:<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n","site":{"data":{}},"excerpt":"<p>blog</p>","more":"<p>$n-1$$F(x)$$m-1$$G(x)$$(F\\times G)(x)$$n,m\\leqslant 10^{6}$</p>\n<p>$F(x)$$i$$F[i]$</p>\n<script type=\"math/tex; mode=display\">F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}</script><script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{m-1}G[i]x^{i}</script><script type=\"math/tex; mode=display\">(F\\times G)(x)=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}F[i]G[j]x^{i+j}</script><script type=\"math/tex; mode=display\">(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]</script><p>$O(n^{2})$</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>$n$$(x_{0},y_{0}),(x_{1},y_{1}),\\cdots,(x_{n-1},y_{n-1})$$x_{i}$$n-1$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(0,2),(1,7),(2,4)</script><p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{cases}\n&\\text{C}=2\\\\\n&\\text{A}+\\text{B}+\\text{C}=7\\\\\n&4\\text{A}+2\\text{B}+\\text{C}=4\n\\end{cases}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{cases}\n&\\text{A}=-4\\\\\n&\\text{B}=9\\\\\n&\\text{C}=2\n\\end{cases}</script><p>$(F\\times G)(x)=F(x)G(x)$<del></del>$F(x)$$G(x)$$O(n)$$(F\\times G)(x)$$(F\\times G)(x)$$n+m-2$$n+m-1$</p>\n<p>$O(n^{2})$</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<script type=\"math/tex; mode=display\">x^{2}+1=0</script><p>$\\Delta=b^{2}-4ac=-4\\lt 0$</p>\n<p>$i$$i^{2}=-1$$x+yi$$\\sqrt{x^{2}+y^{2}}$$x$$\\operatorname{tan}^{-1}\\cfrac{y}{x}$</p>\n<p>$i$$x$$y$$x+yi$$(x,y)$</p>\n<p><img src=\"https://i.loli.net/2018/12/19/5c1a46b4d785b.png\" alt=\"\"></p>\n<p>$4+i$$3+4i$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)+(x_{2}+y_{2}i)=(x_{1}+x_{2})+(y_{1}+y_{2})i</script><script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)-(x_{2}+y_{2}i)=(x_{1}-x_{2})+(y_{1}-y_{2})i</script><script type=\"math/tex; mode=display\">(x_{1}+y_{1}i)(x_{2}+y_{2}i)=(x_{1}x_{2}-y_{1}y_{2})+(x_{1}y_{2}+x_{2}y_{1})i</script><script type=\"math/tex; mode=display\">\\begin{aligned}\n\\cfrac{x_{1}+y_{1}i}{x_{2}+y_{2}i}&=\\cfrac{(x_{1}+y_{1}i)(x_{2}-y_{2}i)}{(x_{2}+y_{2}i)(x_{2}-y_{2}i)}\\\\\n&=\\cfrac{(x_{1}x_{2}+y_{1}y_{2})+(x_{2}y_{1}-x_{1}y_{2})i}{x_{2}^{2}+y_{2}^{2}}\\\\\n&=\\cfrac{x_{1}x_{2}+y_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}+\\cfrac{x_{2}y_{1}-x_{1}y_{2}}{x_{2}^{2}+y_{2}^{2}}i\n\\end{aligned}</script><p></p>\n<p>$c_{1}$$c_{2}$$r_{1}$$r_{2}$$\\alpha_{1}$$\\alpha_{2}$</p>\n<script type=\"math/tex; mode=display\">c_{1}=r_{1}(\\operatorname{cos}\\alpha_{1}+i\\operatorname{sin}\\alpha_{1})</script><script type=\"math/tex; mode=display\">c_{2}=r_{2}(\\operatorname{cos}\\alpha_{2}+i\\operatorname{sin}\\alpha_{2})</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nc_{1}c_{2}&=r_{1}r_{2}(\\cos\\alpha_{1}+i\\sin\\alpha_{1})(\\cos\\alpha_{2}+i\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}(\\cos\\alpha_{1}\\cos\\alpha_{2}+i\\cos\\alpha_{1}\\sin\\alpha_{2}+i\\sin\\alpha_{1}\\cos\\alpha_{2}-\\sin\\alpha_{1}\\sin\\alpha_{2})\\\\\n&=r_{1}r_{2}[\\cos(\\alpha_{1}+\\alpha_{2})+i\\sin(\\alpha_{1}+\\alpha_{2})]\n\\end{aligned}</script><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$1$</p>\n<p><img src=\"https://i.loli.net/2018/12/20/5c1b06e5602fa.png\" alt=\"\"></p>\n<p></p>\n<script type=\"math/tex; mode=display\">x^{n}=1</script><p></p>\n<p>$n$$1$$1$$a$</p>\n<script type=\"math/tex; mode=display\">2\\pi\\mid na</script><script type=\"math/tex; mode=display\">\\cfrac{2\\pi}{n}\\mid a</script><p>$n$$\\cfrac{2k\\pi}{n}(k\\in[0,n)\\cap\\mathbb{Z})$$\\cfrac{2\\pi}{n}$$\\cos\\cfrac{2\\pi}{n}+i\\sin\\cfrac{2\\pi}{n}$$n$$\\omega_{n}$$n$$\\omega_{n}^{k}(k\\in[0,n)\\cap\\mathbb{Z})$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\omega_{2n}^{2k}=\\omega_{n}^{k}</script><p>$1$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}</script><p>$\\omega_{n}^{\\frac{n}{2}}$$\\cfrac{2\\times\\frac{n}{2}\\pi}{n}=\\pi$$-1$</p>\n<h1 id=\"Fast-Fourier-Transformation\"><a href=\"#Fast-Fourier-Transformation\" class=\"headerlink\" title=\"Fast Fourier Transformation\"></a>Fast Fourier Transformation</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>Jean Baptiste Joseph Fourier$n$</p>\n<p>$0$$+1$$2$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF_{1}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i]x^{i}\\\\\n&=F[0]x^{0}+F[2]x^{1}+\\cdots+F[n-2]x^{\\frac{n}{2}-1}\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nF_{2}(x)&=\\sum\\limits_{i=0}^{\\frac{n}{2}-1}F[2i+1]x^{i}\\\\\n&=F[1]x^{0}+F[3]x^{1}+\\cdots+F[n-1]x^{\\frac{n}{2}-1}\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">F(x)=F_{1}(x^{2})+xF_{2}(x^{2})</script><p>$0\\leqslant k&lt;\\cfrac{n}{2}$$x=\\omega_{n}^{k}$$x=\\omega_{n}^{k+\\frac{n}{2}}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF(\\omega_{n}^{k})&=F_{1}(\\omega_{n}^{2k})+\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})+\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nF(\\omega_{n}^{k+\\frac{n}{2}})&=F_{1}(\\omega_{n}^{2k+n})+\\omega_{n}^{k+\\frac{n}{2}}F_{2}(\\omega_{n}^{2k+n})\\\\\n&=F_{1}(\\omega_{n}^{2k})-\\omega_{n}^{k}F_{2}(\\omega_{n}^{2k})\\\\\n&=F_{1}(\\omega_{\\frac{n}{2}}^{k})-\\omega_{n}^{k}F_{2}(\\omega_{\\frac{n}{2}}^{k})\n\\end{aligned}</script><p>$F_{1}(x)$$F_{2}(x)$$O(n)$$F(x)$$n=1$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">(<span class=\"keyword\">complex</span>* F,<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span> F1[n&gt;&gt;<span class=\"number\">1</span>],F2[n&gt;&gt;<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">    \tF1[i]=F[<span class=\"number\">2</span>*i];</span><br><span class=\"line\">        F2[i]=F[<span class=\"number\">2</span>*i+<span class=\"number\">1</span>];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    work(F1,n&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\">    work(F2,n&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\">    complex unit(cos(2*Pi/n),sin(2*Pi/n)),tmp=1;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;(n&gt;&gt;<span class=\"number\">1</span>);++i,tmp=tmp*unit)&#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">complex</span> w=F2[i+(n&gt;&gt;<span class=\"number\">1</span>)]*tmp;</span><br><span class=\"line\">        F[i]=F1[i]+w;</span><br><span class=\"line\">        F[i+(n&gt;&gt;<span class=\"number\">1</span>)]=F1[i]-w;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><del></del></p>\n<p><code>F</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0 1 2 3 4 5 6 7</span><br><span class=\"line\">0 2 4 6|1 3 5 7</span><br><span class=\"line\">0 4|2 6|1 5|3 7</span><br><span class=\"line\">0|4|2|6|1|5|3|7</span><br></pre></td></tr></table></figure>\n<p></p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">$0$</td>\n<td style=\"text-align:center\">$000$</td>\n<td style=\"text-align:center\">$0$</td>\n<td style=\"text-align:center\">$000$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$1$</td>\n<td style=\"text-align:center\">$001$</td>\n<td style=\"text-align:center\">$4$</td>\n<td style=\"text-align:center\">$100$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$2$</td>\n<td style=\"text-align:center\">$010$</td>\n<td style=\"text-align:center\">$2$</td>\n<td style=\"text-align:center\">$010$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$3$</td>\n<td style=\"text-align:center\">$011$</td>\n<td style=\"text-align:center\">$6$</td>\n<td style=\"text-align:center\">$110$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$4$</td>\n<td style=\"text-align:center\">$100$</td>\n<td style=\"text-align:center\">$1$</td>\n<td style=\"text-align:center\">$001$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$5$</td>\n<td style=\"text-align:center\">$101$</td>\n<td style=\"text-align:center\">$5$</td>\n<td style=\"text-align:center\">$101$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$6$</td>\n<td style=\"text-align:center\">$110$</td>\n<td style=\"text-align:center\">$3$</td>\n<td style=\"text-align:center\">$011$</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$7$</td>\n<td style=\"text-align:center\">$111$</td>\n<td style=\"text-align:center\">$7$</td>\n<td style=\"text-align:center\">$111$</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>$\\operatorname{log}n$</p>\n<p>$O(n)$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<p>$i$$i$$1$$1$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">(<span class=\"keyword\">complex</span>* F,<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tcomplex unit(cos(Pi/p),sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$F(\\omega_{n}^{0}),F(\\omega_{n}^{1}),\\cdots,F(\\omega_{n}^{n-1})$$y_{0},y_{1},\\cdots,y_{n-1}$</p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}\n&(\\omega_{n}^{0})^{0}&(\\omega_{n}^{0})^{1}&\\cdots&(\\omega_{n}^{0})^{n-1}&\\\\\n&(\\omega_{n}^{1})^{0}&(\\omega_{n}^{1})^{1}&\\cdots&(\\omega_{n}^{1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&(\\omega_{n}^{n-1})^{0}&(\\omega_{n}^{n-1})^{1}&\\cdots&(\\omega_{n}^{n-1})^{n-1}\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\n&F[0]&\\\\\n&F[1]\\\\\n&\\vdots\\\\\n&F[n-1]\n\\end{bmatrix}\n=\\begin{bmatrix}\n&y_{0}&\\\\\n&y_{1}\\\\\n&\\vdots\\\\\n&y_{n-1}\n\\end{bmatrix}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}\n&\\frac{1}{n}(\\omega_{n}^{0})^{0}&\\frac{1}{n}(\\omega_{n}^{0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{0})^{n-1}&\\\\\n&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\\n&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\n\\end{bmatrix}</script><p>$A$$B$$A\\times B=C$$A[i][j]=\\omega_{n}^{ij}$$B[i][j]=\\cfrac{1}{n}\\omega_{n}^{-ij}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}A[i][k]B[k][j]\\\\\n&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{ik-kj}\n\\end{aligned}</script><p>$i=j$$C[i][j]=1$</p>\n<p>$i\\neq j$$i-j=l$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nC[i][j]&=\\sum\\limits_{k=0}^{n-1}\\cfrac{1}{n}\\omega_{n}^{lk}\\\\\n&=\\cfrac{\\omega_{n}^{ln}-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=\\cfrac{1-1}{n(\\omega_{n}^{l}-1)}\\\\\n&=0\n\\end{aligned}</script><p>$C$$B$$A$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\begin{bmatrix}&\\frac{1}{n}(\\omega_{n}^{-0})^{0}&\\frac{1}{n}(\\omega_{n}^{-0})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-0})^{n-1}&\\\\&\\frac{1}{n}(\\omega_{n}^{-1})^{0}&\\frac{1}{n}(\\omega_{n}^{-1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-1})^{n-1}\\\\&\\vdots&\\vdots&\\ddots&\\vdots\\\\&\\frac{1}{n}(\\omega_{n}^{-n+1})^{0}&\\frac{1}{n}(\\omega_{n}^{-n+1})^{1}&\\cdots&\\frac{1}{n}(\\omega_{n}^{-n+1})^{n-1}\\\\\\end{bmatrix}\\begin{bmatrix}&y_{0}&\\\\&y_{1}\\\\&\\vdots\\\\&y_{n-1}\\end{bmatrix}=\\begin{bmatrix}&F[0]&\\\\&F[1]\\\\&\\vdots\\\\&F[n-1]\\end{bmatrix}</script><p>$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$$\\omega_{n}^{0},\\omega_{n}^{-1},\\cdots,\\omega_{n}^{-n+1}$FFT$n$</p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">complex unit(cos(Pi/p),sin(Pi/p));</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br></pre></td></tr></table></figure>\n<p><code>tp</code><code>tp=1</code><code>tp=-1</code></p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Pi=<span class=\"built_in\">acos</span>(<span class=\"number\">-1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> rev[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">complex</span>&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">double</span> r,c;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span>(<span class=\"keyword\">double</span> _r=<span class=\"number\">0</span>,<span class=\"keyword\">double</span> _c=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\tr=_r;</span><br><span class=\"line\">\t\tc=_c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">complex</span> F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>+(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r+b.r,a.c+b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>-(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r-b.r,a.c-b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>*(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(_tp&amp; x,_tp&amp; y)</span></span>&#123;</span><br><span class=\"line\">\t_tp tmp=x;</span><br><span class=\"line\">\tx=y;</span><br><span class=\"line\">\ty=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">FAQ</span><span class=\"params\">(<span class=\"keyword\">complex</span> F[],<span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>,&amp;n,&amp;m);</span><br><span class=\"line\">\t++n;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;F[i].r);</span><br><span class=\"line\">\t++m;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;G[i].r);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m+=n<span class=\"number\">-1</span>,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tFAQ(F,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tFAQ(G,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=F[i]*G[i];</span><br><span class=\"line\">\tFAQ(F,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%0.0lf \"</span>,F[i].r/n);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><del><code>cltstream</code></del></p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P3803\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"ZJOI2014\"><a href=\"#ZJOI2014\" class=\"headerlink\" title=\"ZJOI2014\"></a><a href=\"https://www.luogu.org/problemnew/show/P3338\" target=\"_blank\" rel=\"noopener\">ZJOI2014</a></h3><p></p>\n<p>$n$$F$$G$$H$</p>\n<script type=\"math/tex; mode=display\">H[i]=\\sum\\limits_{j=0}^{i}F[j]G[i-j]=\\sum\\limits_{0\\leqslant j<n,0\\leqslant k<n,j+k=i}F[j]G[k]</script><p></p>\n<script type=\"math/tex; mode=display\">(F\\times G)[k]=\\sum\\limits_{0\\leqslant i<n,0\\leqslant j<m,i+j=k}F[i]G[j]</script><p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">F(x)=\\sum\\limits_{i=0}^{n-1}F[i]x^{i}</script><script type=\"math/tex; mode=display\">G(x)=\\sum\\limits_{i=0}^{n-1}G[i]x^{i}</script><p>FFT$n$</p>\n<p>$j\\lt i$$j\\gt i$</p>\n<p>$j\\lt i$$F[i]=q_{i}$$G[i]=\\begin{cases}&amp;\\cfrac{1}{i^{2}}\\;\\;&amp;(i\\gt 0)\\\\&amp;0&amp;(i=0)\\end{cases}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nE_{i}&=\\sum_{j=0}^{i-1}F[j]G[i-j]\\\\\n&=\\sum_{j=0}^{i}F[j]G[i-j]\n\\end{aligned}</script><p></p>\n<p>$j&gt;i$$F$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span>\\lt cstdio&gt;</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Pi=<span class=\"built_in\">acos</span>(<span class=\"number\">-1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> rev[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">complex</span>&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">double</span> r,c;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">complex</span>(<span class=\"keyword\">double</span> _r=<span class=\"number\">0</span>,<span class=\"keyword\">double</span> _c=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\tr=_r;</span><br><span class=\"line\">\t\tc=_c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">complex</span> F1[maxn+<span class=\"number\">1</span>],F2[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>+(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r+b.r,a.c+b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>-(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r-b.r,a.c-b.c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"keyword\">complex</span> <span class=\"keyword\">operator</span>*(<span class=\"keyword\">complex</span>&amp; a,<span class=\"keyword\">complex</span>&amp; b)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">complex</span>(a.r*b.r-a.c*b.c,a.r*b.c+a.c*b.r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(_tp&amp; x,_tp&amp; y)</span></span>&#123;</span><br><span class=\"line\">\t_tp tmp=x;</span><br><span class=\"line\">\tx=y;</span><br><span class=\"line\">\ty=tmp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">FAQ</span><span class=\"params\">(<span class=\"keyword\">complex</span> F[],<span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> len=<span class=\"number\">2</span>,p=<span class=\"number\">1</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>,p&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\tregister complex unit(cos(Pi/p),tp*sin(Pi/p));</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> j=i;j&lt;i+p;++j)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">register</span> <span class=\"keyword\">complex</span> tmp=F[j+p]*cur;</span><br><span class=\"line\">\t\t\t\tF[j+p]=F[j]-tmp;</span><br><span class=\"line\">\t\t\t\tF[j]=F[j]+tmp;</span><br><span class=\"line\">\t\t\t\tcur=cur*unit;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%lf\"</span>,&amp;F1[i].r);</span><br><span class=\"line\">\t\tF2[n-i<span class=\"number\">-1</span>].r=F1[i].r;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tG[i]=<span class=\"number\">1.0</span>/i/i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m=n,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\tn&lt;&lt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tFAQ(G,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tFAQ(F1,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF1[i]=F1[i]*G[i];</span><br><span class=\"line\">\tFAQ(F1,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tFAQ(F2,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF2[i]=F2[i]*G[i];</span><br><span class=\"line\">\tFAQ(F2,<span class=\"number\">-1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">register</span> <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%lf\\n\"</span>,(F1[i].r-F2[m-i<span class=\"number\">-1</span>].r)/n);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"Number-Theoretic-Transformation\"><a href=\"#Number-Theoretic-Transformation\" class=\"headerlink\" title=\"Number-Theoretic Transformation\"></a>Number-Theoretic Transformation</h1><p>FFT<code>double</code>FFT</p>\n<p></p>\n<p>$a$$p$$a^{k}\\equiv 1\\pmod{p}$$k$$a$$p$$\\delta_{p}(a)$</p>\n<p>$\\delta_{p}(a)=\\varphi(p)$$a$$p$</p>\n<p>$p=an+1$$a$$n$$2$$g$$\\omega_{n}=g^{a}$</p>\n<p>$\\omega_{n}^{0},\\omega_{n}^{1},\\cdots,\\omega_{n}^{n-1}$</p>\n<p>$g^{0},g^{1},\\cdots,g^{n-1}$$p$$a$</p>\n<p>$\\omega_{2n}^{2k}=\\omega_{n}^{k}$</p>\n<p>$\\omega_{2n}=g^{\\frac{a}{2}}$$p$$\\cfrac{a}{2}\\cdot2n+1$</p>\n<script type=\"math/tex; mode=display\">\\omega_{2n}^{2k}=g^{\\frac{a}{2}\\cdot{2}k}=g^{ak}=\\omega_{n}^{k}</script><p></p>\n<p>$\\omega_{n}^{k+\\frac{n}{2}}=-\\omega_{n}^{k}$$\\omega_{n}^{\\frac{n}{2}}=-1$</p>\n<p>$p=an+1$</p>\n<script type=\"math/tex; mode=display\">\\omega_{n}^{n}\\equiv g^{an}\\equiv g^{p-1}\\equiv 1\\pmod{p}</script><p>$\\omega_{n}^{\\frac{n}{2}}\\equiv\\pm 1\\pmod{p}$$\\omega_{n}^{0}=1$$\\omega_{n}^{\\frac{n}{2}}\\not\\equiv\\omega_{n}^{0}\\pmod{p}$$\\omega_{n}^{\\frac{n}{2}}\\equiv -1\\pmod{p}$</p>\n<p>$k\\neq 0$$\\sum_{i=0}^{n-1}(\\omega_{n}^{k})^{i}=0$</p>\n<p>$p=998244353=7\\times 17\\times 2^{23}+1$$3$</p>\n<p>$\\omega_{n}=g^{a}=g^{\\frac{p-1}{n}}$$998244353$$\\omega_{2},\\omega_{4},\\cdots,\\omega_{2^{23}}$</p>\n<script type=\"math/tex; mode=display\">\\omega_{2^{23}}=3^{7\\times 17}=3^{119}</script><script type=\"math/tex; mode=display\">\\omega_{2^{k}}=\\omega_{2^{k+1}}^{2}</script><p>$\\omega_{2^{23}}$</p>\n<p>$\\omega_{n}^{-k}$$\\omega_{n}^{k}$$998244353$$3$$998244353$$332748118$</p>\n<p>FFT</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> re register</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> maxn 2097152</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mod 998244353</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> swap(a,b) a^=b,b^=a,a^=b</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> cltstream&#123;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> size 1048576</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltin[size+<span class=\"number\">1</span>],*ih=cltin,*it=cltin;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">char</span> <span class=\"title\">gc</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> ONLINE_JUDGE</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(ih==it)&#123;</span><br><span class=\"line\">\t\t\t\tit=(ih=cltin)+fread(cltin,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(ih==it)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> EOF;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> *ih++;</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> getchar();</span><br><span class=\"line\">\t\t<span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> cltout[size+<span class=\"number\">1</span>],*oh=cltout,*ot=cltout+size;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">pc</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(oh==ot)&#123;</span><br><span class=\"line\">\t\t\tfwrite(cltout,<span class=\"number\">1</span>,size,<span class=\"built_in\">stdout</span>);</span><br><span class=\"line\">\t\t\toh=cltout;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t*oh++=c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">define</span> clop() fwrite(cltstream::cltout,1,cltstream::oh-cltstream::cltout,stdout)</span></span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"meta-keyword\">undef</span> size</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">(_tp&amp; x)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> sn=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">char</span> c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(;c!=<span class=\"number\">45</span>&amp;&amp;(c&lt;<span class=\"number\">48</span>||c&gt;<span class=\"number\">57</span>)&amp;&amp;c!=EOF;c=gc());</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(c==<span class=\"number\">45</span>&amp;&amp;c!=EOF)</span><br><span class=\"line\">\t\t\tsn=<span class=\"number\">-1</span>,c=gc();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(x=<span class=\"number\">0</span>;c&gt;=<span class=\"number\">48</span>&amp;&amp;c&lt;=<span class=\"number\">57</span>&amp;&amp;c!=EOF;x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+(c^<span class=\"number\">48</span>),c=gc());</span><br><span class=\"line\">\t\tx*=sn;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">template</span> &lt;<span class=\"keyword\">typename</span> _tp&gt;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">write</span><span class=\"params\">(_tp x,<span class=\"keyword\">char</span> text=<span class=\"number\">-1</span>)</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">45</span>),x=-x;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!x)</span><br><span class=\"line\">\t\t\tpc(<span class=\"number\">48</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> digit[<span class=\"number\">22</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(digit[<span class=\"number\">0</span>]=<span class=\"number\">0</span>;x;digit[++digit[<span class=\"number\">0</span>]]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(;digit[<span class=\"number\">0</span>];pc(digit[digit[<span class=\"number\">0</span>]--]^<span class=\"number\">48</span>));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(text&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\tpc(text);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m;</span><br><span class=\"line\"><span class=\"keyword\">int</span> unit[<span class=\"number\">2</span>][<span class=\"number\">24</span>],rev[maxn+<span class=\"number\">1</span>],F[maxn+<span class=\"number\">1</span>],G[maxn+<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">cltpow</span><span class=\"params\">(re <span class=\"keyword\">int</span> x,re <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">\tre <span class=\"keyword\">int</span> res=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;y;)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(y&amp;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tres=<span class=\"number\">1L</span>L*res*x%mod;</span><br><span class=\"line\">\t\tx=<span class=\"number\">1L</span>L*x*x%mod;</span><br><span class=\"line\">\t\ty&gt;&gt;=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(<span class=\"keyword\">int</span>* F,re <span class=\"keyword\">int</span> tp)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(i&lt;rev[i])</span><br><span class=\"line\">\t\t\tswap(F[i],F[rev[i]]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> k=<span class=\"number\">1</span>,p=<span class=\"number\">1</span>;p&lt;n;++k,p&lt;&lt;=<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=p&lt;&lt;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=i,tmp=<span class=\"number\">1</span>;j&lt;i+p;++j,tmp=<span class=\"number\">1L</span>L*tmp*unit[tp][k]%mod)&#123;</span><br><span class=\"line\">\t\t\t\tre <span class=\"keyword\">int</span> x=F[j],y=<span class=\"number\">1L</span>L*F[j+p]*tmp%mod;</span><br><span class=\"line\">\t\t\t\tF[j]=(x+y)%mod;</span><br><span class=\"line\">\t\t\t\tF[j+p]=(x-y+mod)%mod;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tunit[<span class=\"number\">0</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">3</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\tunit[<span class=\"number\">1</span>][<span class=\"number\">23</span>]=cltpow(<span class=\"number\">332748118</span>,<span class=\"number\">119</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">2</span>;++i)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> j=<span class=\"number\">22</span>;j&gt;=<span class=\"number\">0</span>;--j)</span><br><span class=\"line\">\t\t\tunit[i][j]=<span class=\"number\">1L</span>L*unit[i][j+<span class=\"number\">1</span>]*unit[i][j+<span class=\"number\">1</span>]%mod;</span><br><span class=\"line\">\tcltstream::read(n);</span><br><span class=\"line\">\tcltstream::read(m);</span><br><span class=\"line\">\t++n;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tcltstream::read(F[i]);</span><br><span class=\"line\">\t++m;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\tcltstream::read(G[i]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(m+=n<span class=\"number\">-1</span>,n=<span class=\"number\">1</span>;n&lt;m;n&lt;&lt;=<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\trev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)?(n&gt;&gt;<span class=\"number\">1</span>):<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(F,<span class=\"number\">0</span>);</span><br><span class=\"line\">\tNTT(G,<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;++i)</span><br><span class=\"line\">\t\tF[i]=<span class=\"number\">1L</span>L*F[i]*G[i]%mod;</span><br><span class=\"line\">\tNTT(F,<span class=\"number\">1</span>);</span><br><span class=\"line\">\tn=cltpow(n,mod<span class=\"number\">-2</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;m;++i)</span><br><span class=\"line\">\t\tcltstream::write(<span class=\"number\">1L</span>L*F[i]*n%mod,i&lt;m<span class=\"number\">-1</span>?<span class=\"number\">32</span>:<span class=\"number\">-1</span>);</span><br><span class=\"line\">\tclop();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>"},{"title":"","date":"2018-11-29T06:41:17.000Z","mathjax":true,"_content":"\n\n~~~~\n\n- [](https://lx-2003.blog.luogu.org/mobius-inversion)\n- [](https://www.luogu.org/blog/54745/dls-tql)\n- [](https://lx-2003.blog.luogu.org/dujiao-sieve)\n\n<!-- more -->\n\n# \n\n## \n\n$\\mathbb{N}^{+}$\n\n\n\n$$(f+g)(n)=f(n)+g(n)$$\n\n\n\n$$(\\alpha f)(n)=\\alpha f(n)$$\n\n\n\n$$(f\\cdot g)(n)=f(n)g(n)$$\n\n~~~~\n\n\n\n$$(f\\times g)(n)=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})$$\n\n\n\n$$(f\\times g)(n)=\\sum\\limits_{ij=n}f(i)g(j)$$\n\n\n\n$f\\times g=g\\times f$\n\n\n\n$(f\\times g)\\times h=f\\times(g\\times h)$\n\n$$\\begin{aligned}\n((f\\times g)\\times h)(n)&=\\sum\\limits_{ij=n}(\\sum\\limits_{kl=i}f(k)g(l))h(j)\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}$$\n\n$$\\begin{aligned}\n(f\\times(g\\times h))(n)&=\\sum\\limits_{ij=n}f(i)(\\sum\\limits_{kl=j}g(k)h(l))\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}$$\n\n$(f+g)\\times h=f\\times h+g\\times h$\n\n$$\\begin{aligned}\n((f+g)\\times h)(n)&=\\sum\\limits_{ij=n}(f+g)(i)h(j)\\\\\n&=\\sum\\limits_{ij=n}f(i)h(j)+g(i)h(j)\\\\\n&=(f\\times h)(n)+(g\\times h)(n)\n\\end{aligned}$$\n\n$\\epsilon(n)=[n=1]$$f\\times\\epsilon =f$\n\n\n\n$f(1)\\neq 0$$f$$g$$f\\times g=\\epsilon$$g$$f$\n\n\n\n$$g(n)=\\cfrac{\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})}{f(1)}$$\n\n\n\n$$\\begin{aligned}\n(f\\times g)(n)&=\\sum_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=f(1)g(n)+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)\n\\end{aligned}$$\n\n## \n\n$f$\n\n$$\\forall x,y\\in\\mathbb{N}^{+}\\wedge x\\perp y\\;\\;f(xy)=f(x)f(y)$$\n\n$f$\n\n$x\\perp y$$f$\n\n$f$$f(1)=1$$f(1\\times n)=f(1)\\times f(n)=f(n)$\n\n$\\epsilon,id^{k}$$\\epsilon$$id^{k}(n)=n^k$\n\n$\\varphi,d,\\sigma$$\\varphi(n)$$n$$n$$d(n)$$\\sigma(n)$$n$\n\n$\\varphi$\n\n$d$$n$$n$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n$p_{i}$$r_{i}$$p_{i}$$(r_{i}+1)$\n\n$$d(n)=\\prod\\limits_{i=1}^{N}(r_{i}+1)$$\n\n$m$\n\n$$m=\\prod\\limits_{i=1}^{M}q_{i}^{s_{i}}$$\n\n$n\\perp m$\n\n$$\\forall i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z}\\;\\;p_{i}\\neq q_{j}$$\n\n\n\n$$nm=(\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}})(\\prod\\limits_{j=1}^{M}q_{j}^{s_{j}})$$\n\n$$\\begin{aligned}\nd(nm)&=(\\prod\\limits_{i=1}^{N}(r_{i}+1))(\\prod\\limits_{j=1}^{M}(s_{j}+1))\\\\\n&=d(n)d(m)\n\\end{aligned}$$\n\n$n\\not\\perp m$$(i,j)(i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z})$$p_{i}=q_{j}$$d(n)d(m)$$(r_{i}+1)(s_{j}+1)=r_{i}s_{j}+r_{i}+s_{j}+1$$d(nm)$$r_{i}+s_{j}+1$$d(nm)\\neq d(n)d(m)$\n\n$\\sigma$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n$p_{i}$$r_{i}$$d$$p_{i}$$n$$p_{i}$$p_{i}^x(x\\in [0,r_{i}]\\cap\\mathbb{Z})$$N$$i$$r_{i}+1$$j$$p_{i}^{j-1}$\n\n$$\\prod\\limits_{i=1}^{N}\\sum\\limits_{j=0}^{r_{i}}p_{i}^{j}$$\n\n$\\sigma(n)$\n\n$d$\n\n~~~~\n\n$$\\begin{aligned}\n(f\\times g)(n)(f\\times g)(m)&=(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(i)g(\\cfrac{n}{i})f(j)g(\\cfrac{m}{j})\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(ij)g(\\cfrac{nm}{ij})\\\\\n&=\\sum\\limits_{k\\mid nm}f(k)g(\\cfrac{nm}{k})\\\\\n&=(f\\times g)(nm)\n\\end{aligned}$$\n\n$n\\perp m$$i$$j$$ij$$d(nm)=d(n)d(m)$\n\n\n\n$f$$g$\n\n$nm=1$$g(1)=1$\n\n$nm>1$$n^{\\prime}m^{\\prime}<nm$$g(n^{\\prime}m^{\\prime})=g(n^{\\prime})g(m^{\\prime})$\n\n$$\\begin{aligned}\ng(nm)&=-\\sum\\limits_{k\\mid nm,k\\neq 1}f(k)g(\\cfrac{nm}{k})\\\\\n&=-\\sum\\limits_{i\\mid n,j\\mid m,ij\\neq 1}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-\\sum\\limits_{i\\mid n,j\\mid m}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=g(n)g(m)-\\epsilon(n)\\epsilon(m)\\\\\n&=g(n)g(m)\n\\end{aligned}$$\n\n~~~~\n\n# \n\n## \n\n$\\mu$$1$$\\mu\\times 1=\\epsilon$\n\n\n\n> $\\mu(1)=1$$n>1$$n$$k$$\\mu(n)=(-1)^{k}$$\\mu(n)=0$\n\n\n\n$\\mu$$n>1$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n\n\n$$\\mu(n)=\\prod\\limits_{i=1}^{N}\\mu(p_{i}^{r_{i}})$$\n\n\n\n$p$\n\n$$\\mu(p)=-\\mu(1)=-1$$\n\n$$\\mu(p^{2})=-\\mu(1)-\\mu(p)=-1+1=0$$\n\n$$\\mu(p^{3})=-\\mu(1)-\\mu(p)-\\mu(p^{2})=-1+1+0=0$$\n\n$$\\vdots$$\n\n\n\n\n\n\n\n$$F(n)=\\sum\\limits_{i\\mid n}f(i)$$\n\n$F=f\\times 1$\n\n$$\\begin{aligned}\nF&=f\\times 1\\\\\nF\\times\\mu&=f\\times 1\\times\\mu\\\\\nF\\times\\mu&=f\n\\end{aligned}$$\n\n$F$$f$$f$\n\n$$f(n)=\\sum\\limits_{i\\mid n}F(i)\\mu(\\cfrac{n}{i})$$\n\n## \n\n\n\n$$F(n)=\\sum\\limits_{n\\mid d}f(d)f(n)=\\sum\\limits_{n\\mid d}F(d)\\mu(\\cfrac{d}{n})$$\n\n\n\n$$(f\\otimes g)(n)=\\sum\\limits_{n\\mid d}f(d)g(\\cfrac{d}{n})$$\n\n\n\n$$F=f\\otimes 1F\\otimes\\mu=f$$\n\n\n\n> Updated on 2018-12-03\n> \n> \n> \n> \n\n# \n\n## \n\n\n\n$n$$n\\leqslant 10^{10}$\n\n\n\n$$S(n)=\\sum\\limits_{i=1}^{n}f(i)$$\n\n$g$$f$\n\n$$\\begin{aligned}\n\\sum_{i=1}^{n}(f\\times g)(i)&=\\sum_{i=1}^{n}\\sum_{j\\mid i}f(j)g(\\cfrac{i}{j})\\\\\n&=\\sum_{i=1}^{n}g(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(j)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}$$\n\n\n\n$g$$g(1)=1$\n\n$$\\begin{aligned}\nS(n)&=g(1)S(n)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\\\\\n&=\\sum_{i=1}^{n}(f\\times g)(i)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}$$\n\n\n\n$g$$f\\times g$$g$$f$\n\n$g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)$$O(n)$\n\n$\\lfloor\\cfrac{n}{i}\\rfloor$$1\\leqslant i\\leqslant\\sqrt{n}$$i$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$\\sqrt{n}$$\\sqrt{n}<i\\leqslant n$$1\\leqslant\\lfloor\\cfrac{n}{i}\\rfloor<\\sqrt{n}$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$i$$O(\\sqrt{n})$\n\n\n\n```cpp\nfor(re int l=1,r;l<=n;l=r+1){\n\tr=n/(n/l);\n\t//......\n}\n```\n\n$r$\n\n$S(n)$$\\lfloor\\cfrac{n}{x}\\rfloor$$\\lfloor\\cfrac{n}{1}\\rfloor,\\lfloor\\cfrac{n}{2}\\rfloor,\\cdots,\\lfloor\\cfrac{n}{\\sqrt{n}}\\rfloor,\\sqrt{n},\\sqrt{n}-1,\\cdots,1$$S(n)$$O(\\sqrt{n})$\n\n$$\\begin{aligned}\nO(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{i}+\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})&=O(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{x}\\rfloor}dx)\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\cfrac{n}{x}}dx)\\\\\n&=O(2n^{\\frac{1}{2}}(n^{\\frac{1}{4}}-1))\\\\\n&=O(n^{\\frac{3}{4}})\n\\end{aligned}$$\n\n$\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor}$$\\sqrt{i}$\n\n$m$$O(m+\\cfrac{n}{\\sqrt{m}})$$m=n^{\\frac{2}{3}}$$O(n^{\\frac{2}{3}})$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\varphi(i)$$\n\n$f=\\varphi,g=1$$\\varphi$$f\\times g=id$$g$$f\\times g$$O(1)$\n\n```cpp\nlong long getSum(int n){\n\tif(n<=maxn)\n\t\treturn phi[n];\n\t//phi\n\tif(ans.count(n))\n\t\treturn ans[n];\n\t//ansunordered_map\n\tre long long res=1LL*n*(n+1)>>1;\n\t//f*g\n\tfor(re int l=2,r;l<=n;l=r+1){\n\t//2\n\t\tr=n/(n/l);\n\t\tres-=(r-l+1)*getSum(n/l);\n\t\t//r-l+1g\n\t\t//+f\n\t}\n\treturn ans[n]=res;\n\t//\n\t//\n}\n```\n\n$\\lfloor\\cfrac{n}{x}\\rfloor$$n^{\\frac{2}{3}}$$x<n^{\\frac{1}{3}}$`ans[x]`$S(\\lfloor\\cfrac{n}{x}\\rfloor)$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\mu(i)$$\n\n$f=\\mu,g=1,f\\times g=\\epsilon$\n\n[](https://www.luogu.org/problemnew/show/P4213)\n\n## \n\n### [Luogu-P3768](https://www.luogu.org/problemnew/show/P3768)\n\n\n\n$$\\begin{aligned}\n\\sum\\limits_{i=1}^{n}i\\sum\\limits_{j=1}^{n}j\\text{gcd}(i,j)&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}x^{2}\\mu(x)\\text{Sum}^{2}(\\lfloor\\cfrac{n}{dx}\\rfloor)\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\sum\\limits_{j\\mid i}j\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\varphi(i)\n\\end{aligned}$$\n\n\n\n$$\\text{Sum}(n)=\\sum\\limits_{i=1}^{n}i$$\n\n\n\n$$\\begin{aligned}\nid\\times\\mu&=\\varphi\\times 1\\times\\mu\\\\\n&=\\varphi\\times\\epsilon\\\\\n&=\\varphi\n\\end{aligned}$$\n\n\n\n$f(n)=n^{2}\\varphi(n)$$g$\n\n~~~~\n\n$g(n)=n^{2}$\n\n$$\\begin{aligned}\n(f\\times g)(n)&=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=\\sum\\limits_{i\\mid n}i^{2}\\varphi(i)\\cfrac{n^{2}}{i^{2}}\\\\\n&=n^{2}\\sum\\limits_{i\\mid n}\\varphi(i)\\\\\n&=n^{3}\n\\end{aligned}$$\n\n~~~~\n\n\n\n### [Luogu-U18201](https://www.luogu.org/problemnew/show/U18201)\n\n\n\n$\\text{T}1$~~~~\n\n$$\\begin{aligned}\n\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{n}\\varphi(\\text{gcd}^{2}(i,j))&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(x)\\lfloor\\cfrac{n}{dx}\\rfloor^{2}\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}\\varphi(j^{2})\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}j\\varphi(j)\\mu(\\cfrac{i}{j})\n\\end{aligned}$$\n\n$f_1(n)=n\\varphi(n),f_2(n)=\\mu(n)$$f=f_1\\times f_2$$g$$O(1)$$g$$f\\times g$$g=1$$f\\times g=(id\\cdot\\varphi)\\times\\mu\\times 1=id\\cdot\\varphi$$f_1(n)=n\\varphi(n)$\n\n\n\n\n\n\n\n$n$`int`~~WA~~\n\n$17\\text{KB}$blog","source":"_posts/2018-11-29-number-theory-learning-notes.md","raw":"---\ntitle: \ndate: 2018-11-29 14:41:17\ntags:\n  - \n  - \ncategories:\n  - \nmathjax: true\n---\n\n\n~~~~\n\n- [](https://lx-2003.blog.luogu.org/mobius-inversion)\n- [](https://www.luogu.org/blog/54745/dls-tql)\n- [](https://lx-2003.blog.luogu.org/dujiao-sieve)\n\n<!-- more -->\n\n# \n\n## \n\n$\\mathbb{N}^{+}$\n\n\n\n$$(f+g)(n)=f(n)+g(n)$$\n\n\n\n$$(\\alpha f)(n)=\\alpha f(n)$$\n\n\n\n$$(f\\cdot g)(n)=f(n)g(n)$$\n\n~~~~\n\n\n\n$$(f\\times g)(n)=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})$$\n\n\n\n$$(f\\times g)(n)=\\sum\\limits_{ij=n}f(i)g(j)$$\n\n\n\n$f\\times g=g\\times f$\n\n\n\n$(f\\times g)\\times h=f\\times(g\\times h)$\n\n$$\\begin{aligned}\n((f\\times g)\\times h)(n)&=\\sum\\limits_{ij=n}(\\sum\\limits_{kl=i}f(k)g(l))h(j)\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}$$\n\n$$\\begin{aligned}\n(f\\times(g\\times h))(n)&=\\sum\\limits_{ij=n}f(i)(\\sum\\limits_{kl=j}g(k)h(l))\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}$$\n\n$(f+g)\\times h=f\\times h+g\\times h$\n\n$$\\begin{aligned}\n((f+g)\\times h)(n)&=\\sum\\limits_{ij=n}(f+g)(i)h(j)\\\\\n&=\\sum\\limits_{ij=n}f(i)h(j)+g(i)h(j)\\\\\n&=(f\\times h)(n)+(g\\times h)(n)\n\\end{aligned}$$\n\n$\\epsilon(n)=[n=1]$$f\\times\\epsilon =f$\n\n\n\n$f(1)\\neq 0$$f$$g$$f\\times g=\\epsilon$$g$$f$\n\n\n\n$$g(n)=\\cfrac{\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})}{f(1)}$$\n\n\n\n$$\\begin{aligned}\n(f\\times g)(n)&=\\sum_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=f(1)g(n)+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)\n\\end{aligned}$$\n\n## \n\n$f$\n\n$$\\forall x,y\\in\\mathbb{N}^{+}\\wedge x\\perp y\\;\\;f(xy)=f(x)f(y)$$\n\n$f$\n\n$x\\perp y$$f$\n\n$f$$f(1)=1$$f(1\\times n)=f(1)\\times f(n)=f(n)$\n\n$\\epsilon,id^{k}$$\\epsilon$$id^{k}(n)=n^k$\n\n$\\varphi,d,\\sigma$$\\varphi(n)$$n$$n$$d(n)$$\\sigma(n)$$n$\n\n$\\varphi$\n\n$d$$n$$n$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n$p_{i}$$r_{i}$$p_{i}$$(r_{i}+1)$\n\n$$d(n)=\\prod\\limits_{i=1}^{N}(r_{i}+1)$$\n\n$m$\n\n$$m=\\prod\\limits_{i=1}^{M}q_{i}^{s_{i}}$$\n\n$n\\perp m$\n\n$$\\forall i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z}\\;\\;p_{i}\\neq q_{j}$$\n\n\n\n$$nm=(\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}})(\\prod\\limits_{j=1}^{M}q_{j}^{s_{j}})$$\n\n$$\\begin{aligned}\nd(nm)&=(\\prod\\limits_{i=1}^{N}(r_{i}+1))(\\prod\\limits_{j=1}^{M}(s_{j}+1))\\\\\n&=d(n)d(m)\n\\end{aligned}$$\n\n$n\\not\\perp m$$(i,j)(i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z})$$p_{i}=q_{j}$$d(n)d(m)$$(r_{i}+1)(s_{j}+1)=r_{i}s_{j}+r_{i}+s_{j}+1$$d(nm)$$r_{i}+s_{j}+1$$d(nm)\\neq d(n)d(m)$\n\n$\\sigma$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n$p_{i}$$r_{i}$$d$$p_{i}$$n$$p_{i}$$p_{i}^x(x\\in [0,r_{i}]\\cap\\mathbb{Z})$$N$$i$$r_{i}+1$$j$$p_{i}^{j-1}$\n\n$$\\prod\\limits_{i=1}^{N}\\sum\\limits_{j=0}^{r_{i}}p_{i}^{j}$$\n\n$\\sigma(n)$\n\n$d$\n\n~~~~\n\n$$\\begin{aligned}\n(f\\times g)(n)(f\\times g)(m)&=(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(i)g(\\cfrac{n}{i})f(j)g(\\cfrac{m}{j})\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(ij)g(\\cfrac{nm}{ij})\\\\\n&=\\sum\\limits_{k\\mid nm}f(k)g(\\cfrac{nm}{k})\\\\\n&=(f\\times g)(nm)\n\\end{aligned}$$\n\n$n\\perp m$$i$$j$$ij$$d(nm)=d(n)d(m)$\n\n\n\n$f$$g$\n\n$nm=1$$g(1)=1$\n\n$nm>1$$n^{\\prime}m^{\\prime}<nm$$g(n^{\\prime}m^{\\prime})=g(n^{\\prime})g(m^{\\prime})$\n\n$$\\begin{aligned}\ng(nm)&=-\\sum\\limits_{k\\mid nm,k\\neq 1}f(k)g(\\cfrac{nm}{k})\\\\\n&=-\\sum\\limits_{i\\mid n,j\\mid m,ij\\neq 1}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-\\sum\\limits_{i\\mid n,j\\mid m}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=g(n)g(m)-\\epsilon(n)\\epsilon(m)\\\\\n&=g(n)g(m)\n\\end{aligned}$$\n\n~~~~\n\n# \n\n## \n\n$\\mu$$1$$\\mu\\times 1=\\epsilon$\n\n\n\n> $\\mu(1)=1$$n>1$$n$$k$$\\mu(n)=(-1)^{k}$$\\mu(n)=0$\n\n\n\n$\\mu$$n>1$\n\n$$n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}$$\n\n\n\n$$\\mu(n)=\\prod\\limits_{i=1}^{N}\\mu(p_{i}^{r_{i}})$$\n\n\n\n$p$\n\n$$\\mu(p)=-\\mu(1)=-1$$\n\n$$\\mu(p^{2})=-\\mu(1)-\\mu(p)=-1+1=0$$\n\n$$\\mu(p^{3})=-\\mu(1)-\\mu(p)-\\mu(p^{2})=-1+1+0=0$$\n\n$$\\vdots$$\n\n\n\n\n\n\n\n$$F(n)=\\sum\\limits_{i\\mid n}f(i)$$\n\n$F=f\\times 1$\n\n$$\\begin{aligned}\nF&=f\\times 1\\\\\nF\\times\\mu&=f\\times 1\\times\\mu\\\\\nF\\times\\mu&=f\n\\end{aligned}$$\n\n$F$$f$$f$\n\n$$f(n)=\\sum\\limits_{i\\mid n}F(i)\\mu(\\cfrac{n}{i})$$\n\n## \n\n\n\n$$F(n)=\\sum\\limits_{n\\mid d}f(d)f(n)=\\sum\\limits_{n\\mid d}F(d)\\mu(\\cfrac{d}{n})$$\n\n\n\n$$(f\\otimes g)(n)=\\sum\\limits_{n\\mid d}f(d)g(\\cfrac{d}{n})$$\n\n\n\n$$F=f\\otimes 1F\\otimes\\mu=f$$\n\n\n\n> Updated on 2018-12-03\n> \n> \n> \n> \n\n# \n\n## \n\n\n\n$n$$n\\leqslant 10^{10}$\n\n\n\n$$S(n)=\\sum\\limits_{i=1}^{n}f(i)$$\n\n$g$$f$\n\n$$\\begin{aligned}\n\\sum_{i=1}^{n}(f\\times g)(i)&=\\sum_{i=1}^{n}\\sum_{j\\mid i}f(j)g(\\cfrac{i}{j})\\\\\n&=\\sum_{i=1}^{n}g(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(j)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}$$\n\n\n\n$g$$g(1)=1$\n\n$$\\begin{aligned}\nS(n)&=g(1)S(n)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\\\\\n&=\\sum_{i=1}^{n}(f\\times g)(i)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}$$\n\n\n\n$g$$f\\times g$$g$$f$\n\n$g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)$$O(n)$\n\n$\\lfloor\\cfrac{n}{i}\\rfloor$$1\\leqslant i\\leqslant\\sqrt{n}$$i$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$\\sqrt{n}$$\\sqrt{n}<i\\leqslant n$$1\\leqslant\\lfloor\\cfrac{n}{i}\\rfloor<\\sqrt{n}$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$i$$O(\\sqrt{n})$\n\n\n\n```cpp\nfor(re int l=1,r;l<=n;l=r+1){\n\tr=n/(n/l);\n\t//......\n}\n```\n\n$r$\n\n$S(n)$$\\lfloor\\cfrac{n}{x}\\rfloor$$\\lfloor\\cfrac{n}{1}\\rfloor,\\lfloor\\cfrac{n}{2}\\rfloor,\\cdots,\\lfloor\\cfrac{n}{\\sqrt{n}}\\rfloor,\\sqrt{n},\\sqrt{n}-1,\\cdots,1$$S(n)$$O(\\sqrt{n})$\n\n$$\\begin{aligned}\nO(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{i}+\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})&=O(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{x}\\rfloor}dx)\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\cfrac{n}{x}}dx)\\\\\n&=O(2n^{\\frac{1}{2}}(n^{\\frac{1}{4}}-1))\\\\\n&=O(n^{\\frac{3}{4}})\n\\end{aligned}$$\n\n$\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor}$$\\sqrt{i}$\n\n$m$$O(m+\\cfrac{n}{\\sqrt{m}})$$m=n^{\\frac{2}{3}}$$O(n^{\\frac{2}{3}})$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\varphi(i)$$\n\n$f=\\varphi,g=1$$\\varphi$$f\\times g=id$$g$$f\\times g$$O(1)$\n\n```cpp\nlong long getSum(int n){\n\tif(n<=maxn)\n\t\treturn phi[n];\n\t//phi\n\tif(ans.count(n))\n\t\treturn ans[n];\n\t//ansunordered_map\n\tre long long res=1LL*n*(n+1)>>1;\n\t//f*g\n\tfor(re int l=2,r;l<=n;l=r+1){\n\t//2\n\t\tr=n/(n/l);\n\t\tres-=(r-l+1)*getSum(n/l);\n\t\t//r-l+1g\n\t\t//+f\n\t}\n\treturn ans[n]=res;\n\t//\n\t//\n}\n```\n\n$\\lfloor\\cfrac{n}{x}\\rfloor$$n^{\\frac{2}{3}}$$x<n^{\\frac{1}{3}}$`ans[x]`$S(\\lfloor\\cfrac{n}{x}\\rfloor)$\n\n\n\n$$\\sum\\limits_{i=1}^{n}\\mu(i)$$\n\n$f=\\mu,g=1,f\\times g=\\epsilon$\n\n[](https://www.luogu.org/problemnew/show/P4213)\n\n## \n\n### [Luogu-P3768](https://www.luogu.org/problemnew/show/P3768)\n\n\n\n$$\\begin{aligned}\n\\sum\\limits_{i=1}^{n}i\\sum\\limits_{j=1}^{n}j\\text{gcd}(i,j)&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}x^{2}\\mu(x)\\text{Sum}^{2}(\\lfloor\\cfrac{n}{dx}\\rfloor)\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\sum\\limits_{j\\mid i}j\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\varphi(i)\n\\end{aligned}$$\n\n\n\n$$\\text{Sum}(n)=\\sum\\limits_{i=1}^{n}i$$\n\n\n\n$$\\begin{aligned}\nid\\times\\mu&=\\varphi\\times 1\\times\\mu\\\\\n&=\\varphi\\times\\epsilon\\\\\n&=\\varphi\n\\end{aligned}$$\n\n\n\n$f(n)=n^{2}\\varphi(n)$$g$\n\n~~~~\n\n$g(n)=n^{2}$\n\n$$\\begin{aligned}\n(f\\times g)(n)&=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=\\sum\\limits_{i\\mid n}i^{2}\\varphi(i)\\cfrac{n^{2}}{i^{2}}\\\\\n&=n^{2}\\sum\\limits_{i\\mid n}\\varphi(i)\\\\\n&=n^{3}\n\\end{aligned}$$\n\n~~~~\n\n\n\n### [Luogu-U18201](https://www.luogu.org/problemnew/show/U18201)\n\n\n\n$\\text{T}1$~~~~\n\n$$\\begin{aligned}\n\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{n}\\varphi(\\text{gcd}^{2}(i,j))&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(x)\\lfloor\\cfrac{n}{dx}\\rfloor^{2}\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}\\varphi(j^{2})\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}j\\varphi(j)\\mu(\\cfrac{i}{j})\n\\end{aligned}$$\n\n$f_1(n)=n\\varphi(n),f_2(n)=\\mu(n)$$f=f_1\\times f_2$$g$$O(1)$$g$$f\\times g$$g=1$$f\\times g=(id\\cdot\\varphi)\\times\\mu\\times 1=id\\cdot\\varphi$$f_1(n)=n\\varphi(n)$\n\n\n\n\n\n\n\n$n$`int`~~WA~~\n\n$17\\text{KB}$blog","slug":"number-theory-learning-notes","published":1,"updated":"2018-12-19T12:13:00.250Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjq921w510031gwgu6rqdsk6u","content":"<p></p>\n<p><del></del></p>\n<ul>\n<li><a href=\"https://lx-2003.blog.luogu.org/mobius-inversion\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><a href=\"https://www.luogu.org/blog/54745/dls-tql\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><a href=\"https://lx-2003.blog.luogu.org/dujiao-sieve\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$\\mathbb{N}^{+}$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(f+g)(n)=f(n)+g(n)</script><p></p>\n<script type=\"math/tex; mode=display\">(\\alpha f)(n)=\\alpha f(n)</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\cdot g)(n)=f(n)g(n)</script><p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">(f\\times g)(n)=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\times g)(n)=\\sum\\limits_{ij=n}f(i)g(j)</script><p></p>\n<p>$f\\times g=g\\times f$</p>\n<p></p>\n<p>$(f\\times g)\\times h=f\\times(g\\times h)$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n((f\\times g)\\times h)(n)&=\\sum\\limits_{ij=n}(\\sum\\limits_{kl=i}f(k)g(l))h(j)\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times(g\\times h))(n)&=\\sum\\limits_{ij=n}f(i)(\\sum\\limits_{kl=j}g(k)h(l))\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}</script><p>$(f+g)\\times h=f\\times h+g\\times h$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n((f+g)\\times h)(n)&=\\sum\\limits_{ij=n}(f+g)(i)h(j)\\\\\n&=\\sum\\limits_{ij=n}f(i)h(j)+g(i)h(j)\\\\\n&=(f\\times h)(n)+(g\\times h)(n)\n\\end{aligned}</script><p>$\\epsilon(n)=[n=1]$$f\\times\\epsilon =f$</p>\n<p></p>\n<p>$f(1)\\neq 0$$f$$g$$f\\times g=\\epsilon$$g$$f$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">g(n)=\\cfrac{\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})}{f(1)}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)&=\\sum_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=f(1)g(n)+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)\n\\end{aligned}</script><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$f$</p>\n<script type=\"math/tex; mode=display\">\\forall x,y\\in\\mathbb{N}^{+}\\wedge x\\perp y\\;\\;f(xy)=f(x)f(y)</script><p>$f$</p>\n<p>$x\\perp y$$f$</p>\n<p>$f$$f(1)=1$$f(1\\times n)=f(1)\\times f(n)=f(n)$</p>\n<p>$\\epsilon,id^{k}$$\\epsilon$$id^{k}(n)=n^k$</p>\n<p>$\\varphi,d,\\sigma$$\\varphi(n)$$n$$n$$d(n)$$\\sigma(n)$$n$</p>\n<p>$\\varphi$</p>\n<p>$d$$n$$n$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p>$p_{i}$$r_{i}$$p_{i}$$(r_{i}+1)$</p>\n<script type=\"math/tex; mode=display\">d(n)=\\prod\\limits_{i=1}^{N}(r_{i}+1)</script><p>$m$</p>\n<script type=\"math/tex; mode=display\">m=\\prod\\limits_{i=1}^{M}q_{i}^{s_{i}}</script><p>$n\\perp m$</p>\n<script type=\"math/tex; mode=display\">\\forall i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z}\\;\\;p_{i}\\neq q_{j}</script><p></p>\n<script type=\"math/tex; mode=display\">nm=(\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}})(\\prod\\limits_{j=1}^{M}q_{j}^{s_{j}})</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nd(nm)&=(\\prod\\limits_{i=1}^{N}(r_{i}+1))(\\prod\\limits_{j=1}^{M}(s_{j}+1))\\\\\n&=d(n)d(m)\n\\end{aligned}</script><p>$n\\not\\perp m$$(i,j)(i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z})$$p_{i}=q_{j}$$d(n)d(m)$$(r_{i}+1)(s_{j}+1)=r_{i}s_{j}+r_{i}+s_{j}+1$$d(nm)$$r_{i}+s_{j}+1$$d(nm)\\neq d(n)d(m)$</p>\n<p>$\\sigma$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p>$p_{i}$$r_{i}$$d$$p_{i}$$n$$p_{i}$$p_{i}^x(x\\in [0,r_{i}]\\cap\\mathbb{Z})$$N$$i$$r_{i}+1$$j$$p_{i}^{j-1}$</p>\n<script type=\"math/tex; mode=display\">\\prod\\limits_{i=1}^{N}\\sum\\limits_{j=0}^{r_{i}}p_{i}^{j}</script><p>$\\sigma(n)$</p>\n<p>$d$</p>\n<p><del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)(f\\times g)(m)&=(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(i)g(\\cfrac{n}{i})f(j)g(\\cfrac{m}{j})\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(ij)g(\\cfrac{nm}{ij})\\\\\n&=\\sum\\limits_{k\\mid nm}f(k)g(\\cfrac{nm}{k})\\\\\n&=(f\\times g)(nm)\n\\end{aligned}</script><p>$n\\perp m$$i$$j$$ij$$d(nm)=d(n)d(m)$</p>\n<p></p>\n<p>$f$$g$</p>\n<p>$nm=1$$g(1)=1$</p>\n<p>$nm&gt;1$$n^{\\prime}m^{\\prime}&lt;nm$$g(n^{\\prime}m^{\\prime})=g(n^{\\prime})g(m^{\\prime})$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\ng(nm)&=-\\sum\\limits_{k\\mid nm,k\\neq 1}f(k)g(\\cfrac{nm}{k})\\\\\n&=-\\sum\\limits_{i\\mid n,j\\mid m,ij\\neq 1}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-\\sum\\limits_{i\\mid n,j\\mid m}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=g(n)g(m)-\\epsilon(n)\\epsilon(m)\\\\\n&=g(n)g(m)\n\\end{aligned}</script><p><del></del></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$\\mu$$1$$\\mu\\times 1=\\epsilon$</p>\n<p></p>\n<blockquote>\n<p>$\\mu(1)=1$$n&gt;1$$n$$k$$\\mu(n)=(-1)^{k}$$\\mu(n)=0$</p>\n</blockquote>\n<p></p>\n<p>$\\mu$$n&gt;1$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\mu(n)=\\prod\\limits_{i=1}^{N}\\mu(p_{i}^{r_{i}})</script><p></p>\n<p>$p$</p>\n<script type=\"math/tex; mode=display\">\\mu(p)=-\\mu(1)=-1</script><script type=\"math/tex; mode=display\">\\mu(p^{2})=-\\mu(1)-\\mu(p)=-1+1=0</script><script type=\"math/tex; mode=display\">\\mu(p^{3})=-\\mu(1)-\\mu(p)-\\mu(p^{2})=-1+1+0=0</script><script type=\"math/tex; mode=display\">\\vdots</script><p></p>\n<p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">F(n)=\\sum\\limits_{i\\mid n}f(i)</script><p>$F=f\\times 1$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF&=f\\times 1\\\\\nF\\times\\mu&=f\\times 1\\times\\mu\\\\\nF\\times\\mu&=f\n\\end{aligned}</script><p>$F$$f$$f$</p>\n<script type=\"math/tex; mode=display\">f(n)=\\sum\\limits_{i\\mid n}F(i)\\mu(\\cfrac{n}{i})</script><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<script type=\"math/tex; mode=display\">F(n)=\\sum\\limits_{n\\mid d}f(d)f(n)=\\sum\\limits_{n\\mid d}F(d)\\mu(\\cfrac{d}{n})</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\otimes g)(n)=\\sum\\limits_{n\\mid d}f(d)g(\\cfrac{d}{n})</script><p></p>\n<script type=\"math/tex; mode=display\">F=f\\otimes 1F\\otimes\\mu=f</script><p></p>\n<blockquote>\n<p>Updated on 2018-12-03</p>\n<p></p>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>$n$$n\\leqslant 10^{10}$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">S(n)=\\sum\\limits_{i=1}^{n}f(i)</script><p>$g$$f$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum_{i=1}^{n}(f\\times g)(i)&=\\sum_{i=1}^{n}\\sum_{j\\mid i}f(j)g(\\cfrac{i}{j})\\\\\n&=\\sum_{i=1}^{n}g(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(j)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}</script><p></p>\n<p>$g$$g(1)=1$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nS(n)&=g(1)S(n)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\\\\\n&=\\sum_{i=1}^{n}(f\\times g)(i)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}</script><p></p>\n<p>$g$$f\\times g$$g$$f$</p>\n<p>$g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)$$O(n)$</p>\n<p>$\\lfloor\\cfrac{n}{i}\\rfloor$$1\\leqslant i\\leqslant\\sqrt{n}$$i$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$\\sqrt{n}$$\\sqrt{n}&lt;i\\leqslant n$$1\\leqslant\\lfloor\\cfrac{n}{i}\\rfloor&lt;\\sqrt{n}$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$i$$O(\\sqrt{n})$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">1</span>,r;l&lt;=n;l=r+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\tr=n/(n/l);</span><br><span class=\"line\">\t<span class=\"comment\">//......</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$r$</p>\n<p>$S(n)$$\\lfloor\\cfrac{n}{x}\\rfloor$$\\lfloor\\cfrac{n}{1}\\rfloor,\\lfloor\\cfrac{n}{2}\\rfloor,\\cdots,\\lfloor\\cfrac{n}{\\sqrt{n}}\\rfloor,\\sqrt{n},\\sqrt{n}-1,\\cdots,1$$S(n)$$O(\\sqrt{n})$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nO(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{i}+\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})&=O(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{x}\\rfloor}dx)\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\cfrac{n}{x}}dx)\\\\\n&=O(2n^{\\frac{1}{2}}(n^{\\frac{1}{4}}-1))\\\\\n&=O(n^{\\frac{3}{4}})\n\\end{aligned}</script><p>$\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor}$$\\sqrt{i}$</p>\n<p>$m$$O(m+\\cfrac{n}{\\sqrt{m}})$$m=n^{\\frac{2}{3}}$$O(n^{\\frac{2}{3}})$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\varphi(i)</script><p>$f=\\varphi,g=1$$\\varphi$$f\\times g=id$$g$$f\\times g$$O(1)$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">getSum</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(n&lt;=maxn)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> phi[n];</span><br><span class=\"line\">\t<span class=\"comment\">//phi</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(ans.count(n))</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ans[n];</span><br><span class=\"line\">\t<span class=\"comment\">//ansunordered_map</span></span><br><span class=\"line\">\tre <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> res=<span class=\"number\">1L</span>L*n*(n+<span class=\"number\">1</span>)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//f*g</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">2</span>,r;l&lt;=n;l=r+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//2</span></span><br><span class=\"line\">\t\tr=n/(n/l);</span><br><span class=\"line\">\t\tres-=(r-l+<span class=\"number\">1</span>)*getSum(n/l);</span><br><span class=\"line\">\t\t<span class=\"comment\">//r-l+1g</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//+f</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ans[n]=res;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$\\lfloor\\cfrac{n}{x}\\rfloor$$n^{\\frac{2}{3}}$$x&lt;n^{\\frac{1}{3}}$<code>ans[x]</code>$S(\\lfloor\\cfrac{n}{x}\\rfloor)$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\mu(i)</script><p>$f=\\mu,g=1,f\\times g=\\epsilon$</p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P4213\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Luogu-P3768\"><a href=\"#Luogu-P3768\" class=\"headerlink\" title=\"Luogu-P3768\"></a><a href=\"https://www.luogu.org/problemnew/show/P3768\" target=\"_blank\" rel=\"noopener\">Luogu-P3768</a></h3><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum\\limits_{i=1}^{n}i\\sum\\limits_{j=1}^{n}j\\text{gcd}(i,j)&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}x^{2}\\mu(x)\\text{Sum}^{2}(\\lfloor\\cfrac{n}{dx}\\rfloor)\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\sum\\limits_{j\\mid i}j\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\varphi(i)\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\text{Sum}(n)=\\sum\\limits_{i=1}^{n}i</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nid\\times\\mu&=\\varphi\\times 1\\times\\mu\\\\\n&=\\varphi\\times\\epsilon\\\\\n&=\\varphi\n\\end{aligned}</script><p></p>\n<p>$f(n)=n^{2}\\varphi(n)$$g$</p>\n<p><del></del></p>\n<p>$g(n)=n^{2}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)&=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=\\sum\\limits_{i\\mid n}i^{2}\\varphi(i)\\cfrac{n^{2}}{i^{2}}\\\\\n&=n^{2}\\sum\\limits_{i\\mid n}\\varphi(i)\\\\\n&=n^{3}\n\\end{aligned}</script><p><del></del></p>\n<p></p>\n<h3 id=\"Luogu-U18201\"><a href=\"#Luogu-U18201\" class=\"headerlink\" title=\"Luogu-U18201\"></a><a href=\"https://www.luogu.org/problemnew/show/U18201\" target=\"_blank\" rel=\"noopener\">Luogu-U18201</a></h3><p></p>\n<p>$\\text{T}1$<del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{n}\\varphi(\\text{gcd}^{2}(i,j))&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(x)\\lfloor\\cfrac{n}{dx}\\rfloor^{2}\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}\\varphi(j^{2})\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}j\\varphi(j)\\mu(\\cfrac{i}{j})\n\\end{aligned}</script><p>$f_1(n)=n\\varphi(n),f_2(n)=\\mu(n)$$f=f_1\\times f_2$$g$$O(1)$$g$$f\\times g$$g=1$$f\\times g=(id\\cdot\\varphi)\\times\\mu\\times 1=id\\cdot\\varphi$$f_1(n)=n\\varphi(n)$</p>\n<p></p>\n<p></p>\n<p></p>\n<p>$n$<code>int</code><del>WA</del></p>\n<p>$17\\text{KB}$blog</p>\n","site":{"data":{}},"excerpt":"<p></p>\n<p><del></del></p>\n<ul>\n<li><a href=\"https://lx-2003.blog.luogu.org/mobius-inversion\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><a href=\"https://www.luogu.org/blog/54745/dls-tql\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><a href=\"https://lx-2003.blog.luogu.org/dujiao-sieve\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$\\mathbb{N}^{+}$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">(f+g)(n)=f(n)+g(n)</script><p></p>\n<script type=\"math/tex; mode=display\">(\\alpha f)(n)=\\alpha f(n)</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\cdot g)(n)=f(n)g(n)</script><p><del></del></p>\n<p></p>\n<script type=\"math/tex; mode=display\">(f\\times g)(n)=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\times g)(n)=\\sum\\limits_{ij=n}f(i)g(j)</script><p></p>\n<p>$f\\times g=g\\times f$</p>\n<p></p>\n<p>$(f\\times g)\\times h=f\\times(g\\times h)$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n((f\\times g)\\times h)(n)&=\\sum\\limits_{ij=n}(\\sum\\limits_{kl=i}f(k)g(l))h(j)\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}</script><script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times(g\\times h))(n)&=\\sum\\limits_{ij=n}f(i)(\\sum\\limits_{kl=j}g(k)h(l))\\\\\n&=\\sum\\limits_{ijk=n}f(i)g(j)h(k)\n\\end{aligned}</script><p>$(f+g)\\times h=f\\times h+g\\times h$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n((f+g)\\times h)(n)&=\\sum\\limits_{ij=n}(f+g)(i)h(j)\\\\\n&=\\sum\\limits_{ij=n}f(i)h(j)+g(i)h(j)\\\\\n&=(f\\times h)(n)+(g\\times h)(n)\n\\end{aligned}</script><p>$\\epsilon(n)=[n=1]$$f\\times\\epsilon =f$</p>\n<p></p>\n<p>$f(1)\\neq 0$$f$$g$$f\\times g=\\epsilon$$g$$f$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">g(n)=\\cfrac{\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})}{f(1)}</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)&=\\sum_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=f(1)g(n)+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)-\\sum\\limits_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})+\\sum_{i\\mid n,i\\neq 1}f(i)g(\\cfrac{n}{i})\\\\\n&=\\epsilon(n)\n\\end{aligned}</script><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$f$</p>\n<script type=\"math/tex; mode=display\">\\forall x,y\\in\\mathbb{N}^{+}\\wedge x\\perp y\\;\\;f(xy)=f(x)f(y)</script><p>$f$</p>\n<p>$x\\perp y$$f$</p>\n<p>$f$$f(1)=1$$f(1\\times n)=f(1)\\times f(n)=f(n)$</p>\n<p>$\\epsilon,id^{k}$$\\epsilon$$id^{k}(n)=n^k$</p>\n<p>$\\varphi,d,\\sigma$$\\varphi(n)$$n$$n$$d(n)$$\\sigma(n)$$n$</p>\n<p>$\\varphi$</p>\n<p>$d$$n$$n$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p>$p_{i}$$r_{i}$$p_{i}$$(r_{i}+1)$</p>\n<script type=\"math/tex; mode=display\">d(n)=\\prod\\limits_{i=1}^{N}(r_{i}+1)</script><p>$m$</p>\n<script type=\"math/tex; mode=display\">m=\\prod\\limits_{i=1}^{M}q_{i}^{s_{i}}</script><p>$n\\perp m$</p>\n<script type=\"math/tex; mode=display\">\\forall i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z}\\;\\;p_{i}\\neq q_{j}</script><p></p>\n<script type=\"math/tex; mode=display\">nm=(\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}})(\\prod\\limits_{j=1}^{M}q_{j}^{s_{j}})</script><script type=\"math/tex; mode=display\">\\begin{aligned}\nd(nm)&=(\\prod\\limits_{i=1}^{N}(r_{i}+1))(\\prod\\limits_{j=1}^{M}(s_{j}+1))\\\\\n&=d(n)d(m)\n\\end{aligned}</script><p>$n\\not\\perp m$$(i,j)(i\\in [1,N]\\cap\\mathbb{Z},j\\in [1,M]\\cap\\mathbb{Z})$$p_{i}=q_{j}$$d(n)d(m)$$(r_{i}+1)(s_{j}+1)=r_{i}s_{j}+r_{i}+s_{j}+1$$d(nm)$$r_{i}+s_{j}+1$$d(nm)\\neq d(n)d(m)$</p>\n<p>$\\sigma$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p>$p_{i}$$r_{i}$$d$$p_{i}$$n$$p_{i}$$p_{i}^x(x\\in [0,r_{i}]\\cap\\mathbb{Z})$$N$$i$$r_{i}+1$$j$$p_{i}^{j-1}$</p>\n<script type=\"math/tex; mode=display\">\\prod\\limits_{i=1}^{N}\\sum\\limits_{j=0}^{r_{i}}p_{i}^{j}</script><p>$\\sigma(n)$</p>\n<p>$d$</p>\n<p><del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)(f\\times g)(m)&=(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(i)g(\\cfrac{n}{i})f(j)g(\\cfrac{m}{j})\\\\\n&=\\sum\\limits_{i\\mid n}\\sum\\limits_{j\\mid m}f(ij)g(\\cfrac{nm}{ij})\\\\\n&=\\sum\\limits_{k\\mid nm}f(k)g(\\cfrac{nm}{k})\\\\\n&=(f\\times g)(nm)\n\\end{aligned}</script><p>$n\\perp m$$i$$j$$ij$$d(nm)=d(n)d(m)$</p>\n<p></p>\n<p>$f$$g$</p>\n<p>$nm=1$$g(1)=1$</p>\n<p>$nm&gt;1$$n^{\\prime}m^{\\prime}&lt;nm$$g(n^{\\prime}m^{\\prime})=g(n^{\\prime})g(m^{\\prime})$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\ng(nm)&=-\\sum\\limits_{k\\mid nm,k\\neq 1}f(k)g(\\cfrac{nm}{k})\\\\\n&=-\\sum\\limits_{i\\mid n,j\\mid m,ij\\neq 1}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-\\sum\\limits_{i\\mid n,j\\mid m}f(i)f(j)g(\\cfrac{n}{i})g(\\cfrac{m}{j})\\\\\n&=g(n)g(m)-(\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i}))(\\sum\\limits_{j\\mid m}f(j)g(\\cfrac{m}{j}))\\\\\n&=g(n)g(m)-\\epsilon(n)\\epsilon(m)\\\\\n&=g(n)g(m)\n\\end{aligned}</script><p><del></del></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>$\\mu$$1$$\\mu\\times 1=\\epsilon$</p>\n<p></p>\n<blockquote>\n<p>$\\mu(1)=1$$n&gt;1$$n$$k$$\\mu(n)=(-1)^{k}$$\\mu(n)=0$</p>\n</blockquote>\n<p></p>\n<p>$\\mu$$n&gt;1$</p>\n<script type=\"math/tex; mode=display\">n=\\prod\\limits_{i=1}^{N}p_{i}^{r_{i}}</script><p></p>\n<script type=\"math/tex; mode=display\">\\mu(n)=\\prod\\limits_{i=1}^{N}\\mu(p_{i}^{r_{i}})</script><p></p>\n<p>$p$</p>\n<script type=\"math/tex; mode=display\">\\mu(p)=-\\mu(1)=-1</script><script type=\"math/tex; mode=display\">\\mu(p^{2})=-\\mu(1)-\\mu(p)=-1+1=0</script><script type=\"math/tex; mode=display\">\\mu(p^{3})=-\\mu(1)-\\mu(p)-\\mu(p^{2})=-1+1+0=0</script><script type=\"math/tex; mode=display\">\\vdots</script><p></p>\n<p></p>\n<p></p>\n<script type=\"math/tex; mode=display\">F(n)=\\sum\\limits_{i\\mid n}f(i)</script><p>$F=f\\times 1$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nF&=f\\times 1\\\\\nF\\times\\mu&=f\\times 1\\times\\mu\\\\\nF\\times\\mu&=f\n\\end{aligned}</script><p>$F$$f$$f$</p>\n<script type=\"math/tex; mode=display\">f(n)=\\sum\\limits_{i\\mid n}F(i)\\mu(\\cfrac{n}{i})</script><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<script type=\"math/tex; mode=display\">F(n)=\\sum\\limits_{n\\mid d}f(d)f(n)=\\sum\\limits_{n\\mid d}F(d)\\mu(\\cfrac{d}{n})</script><p></p>\n<script type=\"math/tex; mode=display\">(f\\otimes g)(n)=\\sum\\limits_{n\\mid d}f(d)g(\\cfrac{d}{n})</script><p></p>\n<script type=\"math/tex; mode=display\">F=f\\otimes 1F\\otimes\\mu=f</script><p></p>\n<blockquote>\n<p>Updated on 2018-12-03</p>\n<p></p>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>$n$$n\\leqslant 10^{10}$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">S(n)=\\sum\\limits_{i=1}^{n}f(i)</script><p>$g$$f$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum_{i=1}^{n}(f\\times g)(i)&=\\sum_{i=1}^{n}\\sum_{j\\mid i}f(j)g(\\cfrac{i}{j})\\\\\n&=\\sum_{i=1}^{n}g(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}f(j)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}</script><p></p>\n<p>$g$$g(1)=1$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nS(n)&=g(1)S(n)\\\\\n&=\\sum_{i=1}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\\\\\n&=\\sum_{i=1}^{n}(f\\times g)(i)-\\sum_{i=2}^{n}g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)\n\\end{aligned}</script><p></p>\n<p>$g$$f\\times g$$g$$f$</p>\n<p>$g(i)S(\\lfloor\\cfrac{n}{i}\\rfloor)$$O(n)$</p>\n<p>$\\lfloor\\cfrac{n}{i}\\rfloor$$1\\leqslant i\\leqslant\\sqrt{n}$$i$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$\\sqrt{n}$$\\sqrt{n}&lt;i\\leqslant n$$1\\leqslant\\lfloor\\cfrac{n}{i}\\rfloor&lt;\\sqrt{n}$$\\sqrt{n}$$\\lfloor\\cfrac{n}{i}\\rfloor$$i$$O(\\sqrt{n})$</p>\n<p></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">1</span>,r;l&lt;=n;l=r+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\tr=n/(n/l);</span><br><span class=\"line\">\t<span class=\"comment\">//......</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$r$</p>\n<p>$S(n)$$\\lfloor\\cfrac{n}{x}\\rfloor$$\\lfloor\\cfrac{n}{1}\\rfloor,\\lfloor\\cfrac{n}{2}\\rfloor,\\cdots,\\lfloor\\cfrac{n}{\\sqrt{n}}\\rfloor,\\sqrt{n},\\sqrt{n}-1,\\cdots,1$$S(n)$$O(\\sqrt{n})$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nO(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{i}+\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})&=O(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor})\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\lfloor\\cfrac{n}{x}\\rfloor}dx)\\\\\n&=O(\\int\\limits_{1}^{\\sqrt{n}}\\sqrt{\\cfrac{n}{x}}dx)\\\\\n&=O(2n^{\\frac{1}{2}}(n^{\\frac{1}{4}}-1))\\\\\n&=O(n^{\\frac{3}{4}})\n\\end{aligned}</script><p>$\\sqrt{\\lfloor\\cfrac{n}{i}\\rfloor}$$\\sqrt{i}$</p>\n<p>$m$$O(m+\\cfrac{n}{\\sqrt{m}})$$m=n^{\\frac{2}{3}}$$O(n^{\\frac{2}{3}})$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\varphi(i)</script><p>$f=\\varphi,g=1$$\\varphi$$f\\times g=id$$g$$f\\times g$$O(1)$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> <span class=\"title\">getSum</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(n&lt;=maxn)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> phi[n];</span><br><span class=\"line\">\t<span class=\"comment\">//phi</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(ans.count(n))</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ans[n];</span><br><span class=\"line\">\t<span class=\"comment\">//ansunordered_map</span></span><br><span class=\"line\">\tre <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> res=<span class=\"number\">1L</span>L*n*(n+<span class=\"number\">1</span>)&gt;&gt;<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//f*g</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(re <span class=\"keyword\">int</span> l=<span class=\"number\">2</span>,r;l&lt;=n;l=r+<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//2</span></span><br><span class=\"line\">\t\tr=n/(n/l);</span><br><span class=\"line\">\t\tres-=(r-l+<span class=\"number\">1</span>)*getSum(n/l);</span><br><span class=\"line\">\t\t<span class=\"comment\">//r-l+1g</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//+f</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ans[n]=res;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>$\\lfloor\\cfrac{n}{x}\\rfloor$$n^{\\frac{2}{3}}$$x&lt;n^{\\frac{1}{3}}$<code>ans[x]</code>$S(\\lfloor\\cfrac{n}{x}\\rfloor)$</p>\n<p></p>\n<script type=\"math/tex; mode=display\">\\sum\\limits_{i=1}^{n}\\mu(i)</script><p>$f=\\mu,g=1,f\\times g=\\epsilon$</p>\n<p><a href=\"https://www.luogu.org/problemnew/show/P4213\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Luogu-P3768\"><a href=\"#Luogu-P3768\" class=\"headerlink\" title=\"Luogu-P3768\"></a><a href=\"https://www.luogu.org/problemnew/show/P3768\" target=\"_blank\" rel=\"noopener\">Luogu-P3768</a></h3><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum\\limits_{i=1}^{n}i\\sum\\limits_{j=1}^{n}j\\text{gcd}(i,j)&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}d^{3}\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}x^{2}\\mu(x)\\text{Sum}^{2}(\\lfloor\\cfrac{n}{dx}\\rfloor)\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\sum\\limits_{j\\mid i}j\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\text{Sum}^{2}(\\lfloor\\cfrac{n}{i}\\rfloor)i^{2}\\varphi(i)\n\\end{aligned}</script><p></p>\n<script type=\"math/tex; mode=display\">\\text{Sum}(n)=\\sum\\limits_{i=1}^{n}i</script><p></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\nid\\times\\mu&=\\varphi\\times 1\\times\\mu\\\\\n&=\\varphi\\times\\epsilon\\\\\n&=\\varphi\n\\end{aligned}</script><p></p>\n<p>$f(n)=n^{2}\\varphi(n)$$g$</p>\n<p><del></del></p>\n<p>$g(n)=n^{2}$</p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n(f\\times g)(n)&=\\sum\\limits_{i\\mid n}f(i)g(\\cfrac{n}{i})\\\\\n&=\\sum\\limits_{i\\mid n}i^{2}\\varphi(i)\\cfrac{n^{2}}{i^{2}}\\\\\n&=n^{2}\\sum\\limits_{i\\mid n}\\varphi(i)\\\\\n&=n^{3}\n\\end{aligned}</script><p><del></del></p>\n<p></p>\n<h3 id=\"Luogu-U18201\"><a href=\"#Luogu-U18201\" class=\"headerlink\" title=\"Luogu-U18201\"></a><a href=\"https://www.luogu.org/problemnew/show/U18201\" target=\"_blank\" rel=\"noopener\">Luogu-U18201</a></h3><p></p>\n<p>$\\text{T}1$<del></del></p>\n<script type=\"math/tex; mode=display\">\\begin{aligned}\n\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{n}\\varphi(\\text{gcd}^{2}(i,j))&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}[i\\perp j]\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{x\\mid i,x\\mid j}\\mu(x)\\\\\n&=\\sum\\limits_{d=1}^{n}\\varphi(d^{2})\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(x)\\lfloor\\cfrac{n}{dx}\\rfloor^{2}\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}\\varphi(j^{2})\\mu(\\cfrac{i}{j})\\\\\n&=\\sum\\limits_{i=1}^{n}\\lfloor\\cfrac{n}{i}\\rfloor^{2}\\sum\\limits_{j\\mid i}j\\varphi(j)\\mu(\\cfrac{i}{j})\n\\end{aligned}</script><p>$f_1(n)=n\\varphi(n),f_2(n)=\\mu(n)$$f=f_1\\times f_2$$g$$O(1)$$g$$f\\times g$$g=1$$f\\times g=(id\\cdot\\varphi)\\times\\mu\\times 1=id\\cdot\\varphi$$f_1(n)=n\\varphi(n)$</p>\n<p></p>\n<p></p>\n<p></p>\n<p>$n$<code>int</code><del>WA</del></p>\n<p>$17\\text{KB}$blog</p>"}],"PostAsset":[],"PostCategory":[{"post_id":"cjq921vz90001gwgumwo5zs1h","category_id":"cjq921vzj0005gwgu8jb7vn3j","_id":"cjq921vzv000igwgur6l4yv6z"},{"post_id":"cjq921vzg0003gwgu1m1t5lra","category_id":"cjq921vzj0005gwgu8jb7vn3j","_id":"cjq921vzx000ngwguisxthwmj"},{"post_id":"cjq921vzw000lgwguzdybljqc","category_id":"cjq921vzj0005gwgu8jb7vn3j","_id":"cjq921w00000sgwguk8c3qqla"},{"post_id":"cjq921vzk0007gwgucs61zclf","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w01000vgwgukpzg0gfm"},{"post_id":"cjq921vzm0009gwgur9peacbf","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w02000xgwgu40t30xp8"},{"post_id":"cjq921vzo000bgwgu7z6logkw","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w030011gwgudfl9seeh"},{"post_id":"cjq921vzr000fgwgurbbjeq31","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w040015gwgu4c04jq02"},{"post_id":"cjq921vzu000ggwgum42cxicx","category_id":"cjq921w030010gwguf1n37tnh","_id":"cjq921w050019gwguwhgxscmh"},{"post_id":"cjq921vzx000mgwgunzpuh5x5","category_id":"cjq921w040016gwgufymhytcw","_id":"cjq921w06001dgwgu6gtw7plk"},{"post_id":"cjq921vzy000qgwguf3oc2uec","category_id":"cjq921w05001agwguofnu3w2o","_id":"cjq921w07001ggwgu3ft1s5d0"},{"post_id":"cjq921vzz000rgwguw929txh6","category_id":"cjq921w05001agwguofnu3w2o","_id":"cjq921w07001igwguuxisxehw"},{"post_id":"cjq921w3a0029gwguxpqzfbxb","category_id":"cjq921w030010gwguf1n37tnh","_id":"cjq921w3g002fgwgu5gwh5dtx"},{"post_id":"cjq921w3e002cgwgurcdoc2dd","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w3i002jgwguk8bo3503"},{"post_id":"cjq921w3f002egwgugusfxwy5","category_id":"cjq921w030010gwguf1n37tnh","_id":"cjq921w3i002kgwgun9ktntlb"},{"post_id":"cjq921w3g002ggwgunik4o5wp","category_id":"cjq921vzv000hgwgufwwx59zp","_id":"cjq921w3j002mgwgu82x5wp4i"},{"post_id":"cjq921w3b002agwgu5gazwykd","category_id":"cjq921w3f002dgwguwmhgk9jl","_id":"cjq921w3j002ogwgugi864zbt"},{"post_id":"cjq921w500030gwguhf99x4ek","category_id":"cjq921w030010gwguf1n37tnh","_id":"cjq921w530035gwgu5dljw8n8"},{"post_id":"cjq921w510031gwgu6rqdsk6u","category_id":"cjq921w030010gwguf1n37tnh","_id":"cjq921w530036gwgudx4dys30"}],"PostTag":[{"post_id":"cjq921vz90001gwgumwo5zs1h","tag_id":"cjq921vzk0006gwgu40w3jk88","_id":"cjq921vzr000egwgulyyfx3ub"},{"post_id":"cjq921vzg0003gwgu1m1t5lra","tag_id":"cjq921vzk0006gwgu40w3jk88","_id":"cjq921vzv000kgwguhz8cn6vv"},{"post_id":"cjq921vzk0007gwgucs61zclf","tag_id":"cjq921vzv000jgwgub4rqw0by","_id":"cjq921w02000zgwguw4k31bxv"},{"post_id":"cjq921vzk0007gwgucs61zclf","tag_id":"cjq921vzy000pgwguditc1d86","_id":"cjq921w030012gwgu08iltzoj"},{"post_id":"cjq921vzk0007gwgucs61zclf","tag_id":"cjq921w01000ugwgue0eqzh2e","_id":"cjq921w030014gwgurzzl6zzw"},{"post_id":"cjq921vzm0009gwgur9peacbf","tag_id":"cjq921w02000ygwguozobbk4u","_id":"cjq921w050018gwguxw85pds6"},{"post_id":"cjq921vzm0009gwgur9peacbf","tag_id":"cjq921vzv000jgwgub4rqw0by","_id":"cjq921w05001bgwguwu3x63t7"},{"post_id":"cjq921vzo000bgwgu7z6logkw","tag_id":"cjq921w040017gwguvm1m1zxd","_id":"cjq921w09001lgwguqziyss5y"},{"post_id":"cjq921vzo000bgwgu7z6logkw","tag_id":"cjq921w05001cgwguj6td542g","_id":"cjq921w09001mgwgubzotati4"},{"post_id":"cjq921vzo000bgwgu7z6logkw","tag_id":"cjq921w06001fgwgulsa09xkb","_id":"cjq921w09001ogwguuyvbn1w0"},{"post_id":"cjq921vzo000bgwgu7z6logkw","tag_id":"cjq921w07001hgwgu5v313941","_id":"cjq921w0a001pgwguspjwzkai"},{"post_id":"cjq921vzo000bgwgu7z6logkw","tag_id":"cjq921vzy000pgwguditc1d86","_id":"cjq921w0a001rgwgufpzfhl2c"},{"post_id":"cjq921vzr000fgwgurbbjeq31","tag_id":"cjq921w02000ygwguozobbk4u","_id":"cjq921w0a001sgwgue2ekuu8l"},{"post_id":"cjq921vzr000fgwgurbbjeq31","tag_id":"cjq921w09001ngwguuqwsdem8","_id":"cjq921w0b001ugwguvz49gcp3"},{"post_id":"cjq921vzu000ggwgum42cxicx","tag_id":"cjq921w0a001qgwgu5i8tzzmh","_id":"cjq921w0c001wgwgu1c1x8vvf"},{"post_id":"cjq921vzu000ggwgum42cxicx","tag_id":"cjq921w0b001tgwgu3znsbe0d","_id":"cjq921w0c001xgwguq8cne8y5"},{"post_id":"cjq921vzw000lgwguzdybljqc","tag_id":"cjq921w0b001vgwguj2ua31ef","_id":"cjq921w0c001zgwguobs18v86"},{"post_id":"cjq921vzx000mgwgunzpuh5x5","tag_id":"cjq921w0c001ygwgu9ofrofgb","_id":"cjq921w0e0022gwgulma7mqiu"},{"post_id":"cjq921vzx000mgwgunzpuh5x5","tag_id":"cjq921w0d0020gwguicsxfjcq","_id":"cjq921w0e0023gwgu7suvcl1n"},{"post_id":"cjq921vzy000qgwguf3oc2uec","tag_id":"cjq921w0d0021gwguenvelen8","_id":"cjq921w0e0025gwgu24emu3k8"},{"post_id":"cjq921vzz000rgwguw929txh6","tag_id":"cjq921w0d0021gwguenvelen8","_id":"cjq921w0g0027gwgufqzqypcq"},{"post_id":"cjq921vzz000rgwguw929txh6","tag_id":"cjq921w0f0026gwgupjw414gp","_id":"cjq921w0g0028gwgusc59x9e1"},{"post_id":"cjq921w3a0029gwguxpqzfbxb","tag_id":"cjq921w3d002bgwgur5odnw9h","_id":"cjq921w3h002igwgu31f54lqm"},{"post_id":"cjq921w3b002agwgu5gazwykd","tag_id":"cjq921w3h002hgwguwpptsbq2","_id":"cjq921w3j002ngwguvobggy37"},{"post_id":"cjq921w3b002agwgu5gazwykd","tag_id":"cjq921w0d0021gwguenvelen8","_id":"cjq921w3j002pgwgumlhngcbn"},{"post_id":"cjq921w3e002cgwgurcdoc2dd","tag_id":"cjq921w02000ygwguozobbk4u","_id":"cjq921w3k002rgwguwsac9bzu"},{"post_id":"cjq921w3e002cgwgurcdoc2dd","tag_id":"cjq921w3i002lgwguj81usoj7","_id":"cjq921w3k002sgwgunu75tii0"},{"post_id":"cjq921w3f002egwgugusfxwy5","tag_id":"cjq921w3j002qgwguyhl273sb","_id":"cjq921w3l002vgwguhswm19qa"},{"post_id":"cjq921w3f002egwgugusfxwy5","tag_id":"cjq921w3k002tgwgu3e12vz3o","_id":"cjq921w3l002wgwguz7cymd1q"},{"post_id":"cjq921w3g002ggwgunik4o5wp","tag_id":"cjq921w02000ygwguozobbk4u","_id":"cjq921w3l002xgwgusc7am5s8"},{"post_id":"cjq921w3g002ggwgunik4o5wp","tag_id":"cjq921w3k002ugwguwax7eoli","_id":"cjq921w3m002ygwgupsa9kzyi"},{"post_id":"cjq921w3g002ggwgunik4o5wp","tag_id":"cjq921w0b001vgwguj2ua31ef","_id":"cjq921w3m002zgwgu4wu8eb10"},{"post_id":"cjq921w500030gwguhf99x4ek","tag_id":"cjq921w3j002qgwguyhl273sb","_id":"cjq921w520032gwgu8r61lcxr"},{"post_id":"cjq921w500030gwguhf99x4ek","tag_id":"cjq921w3k002tgwgu3e12vz3o","_id":"cjq921w530034gwgut7ynvul6"},{"post_id":"cjq921w510031gwgu6rqdsk6u","tag_id":"cjq921vzv000jgwgub4rqw0by","_id":"cjq921w530037gwgu0n3ssd17"},{"post_id":"cjq921w510031gwgu6rqdsk6u","tag_id":"cjq921w530033gwguxggk8lbh","_id":"cjq921w540038gwgu96wt81pm"}],"Tag":[{"name":"","_id":"cjq921vzk0006gwgu40w3jk88"},{"name":"","_id":"cjq921vzv000jgwgub4rqw0by"},{"name":"","_id":"cjq921vzy000pgwguditc1d86"},{"name":"","_id":"cjq921w01000ugwgue0eqzh2e"},{"name":"","_id":"cjq921w02000ygwguozobbk4u"},{"name":"SDOI","_id":"cjq921w040017gwguvm1m1zxd"},{"name":"2009","_id":"cjq921w05001cgwguj6td542g"},{"name":"","_id":"cjq921w06001fgwgulsa09xkb"},{"name":"","_id":"cjq921w07001hgwgu5v313941"},{"name":"","_id":"cjq921w09001ngwguuqwsdem8"},{"name":"","_id":"cjq921w0a001qgwgu5i8tzzmh"},{"name":"","_id":"cjq921w0b001tgwgu3znsbe0d"},{"name":"","_id":"cjq921w0b001vgwguj2ua31ef"},{"name":"NOIp","_id":"cjq921w0c001ygwgu9ofrofgb"},{"name":"2018","_id":"cjq921w0d0020gwguicsxfjcq"},{"name":"","_id":"cjq921w0d0021gwguenvelen8"},{"name":"","_id":"cjq921w0f0026gwgupjw414gp"},{"name":"","_id":"cjq921w3d002bgwgur5odnw9h"},{"name":"","_id":"cjq921w3h002hgwguwpptsbq2"},{"name":"","_id":"cjq921w3i002lgwguj81usoj7"},{"name":"FFT","_id":"cjq921w3j002qgwguyhl273sb"},{"name":"NTT","_id":"cjq921w3k002tgwgu3e12vz3o"},{"name":"","_id":"cjq921w3k002ugwguwax7eoli"},{"name":"","_id":"cjq921w530033gwguxggk8lbh"}]}}